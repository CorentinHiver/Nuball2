<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nuball2: lib/Analyse/SpectraCo.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Nuball2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_spectra_co_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SpectraCo.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_spectra_co_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef SPECTRACO_HPP</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define SPECTRACO_HPP</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;../libRoot.hpp&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_recalibration_8hpp.html">Recalibration.hpp</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;../Classes/Calibration.hpp&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="class_my_error.html">   10</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_my_error.html">MyError</a></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{<span class="keyword">public</span>:</div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="class_my_error.html#a05198cf33bf051e16f6ec2647bf4b571">   12</a></span>&#160;  <a class="code" href="class_my_error.html#a05198cf33bf051e16f6ec2647bf4b571">MyError</a>(std::string <span class="keyword">const</span> &amp; message = <span class="stringliteral">&quot;&quot;</span>) {<a class="code" href="print_8hpp.html#a388f572c62279f839ee138a9afbdeeb5">print</a>((message==<span class="stringliteral">&quot;&quot;</span>) ? <span class="stringliteral">&quot;error&quot;</span> : message);}</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;};</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">   15</a></span>&#160;<span class="keyword">using</span> <a class="code" href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">SpectraPoint</a> = std::pair&lt;int, double&gt;;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">   16</a></span>&#160;<span class="keyword">using</span> <a class="code" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a> = std::vector&lt;SpectraPoint&gt;;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">class </span><a class="code" href="class_spectra_co.html">SpectraCo</a>; <span class="comment">// Forward declaration so the class can be used within itself</span></div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="class_spectra_co.html">   19</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_spectra_co.html">SpectraCo</a></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="class_spectra_co.html#acc6c691f3d2e5f0769d00b9d6e1ffe24">   23</a></span>&#160;  <a class="code" href="class_spectra_co.html#acc6c691f3d2e5f0769d00b9d6e1ffe24">SpectraCo</a>() noexcept = default;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a213631f494d8361bfa9f4115266e9af7">   26</a></span>&#160;  ~<a class="code" href="class_spectra_co.html">SpectraCo</a>() noexcept</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <span class="keyword">delete</span> <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// A coder !!!!!</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// for (auto &amp; spectra : root_spectra_pointers) if (spectra &amp;&amp; !bool_cast(spectra-&gt;GetDirectory())) delete spectra;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac7bfa00174710c92a077113a202ba2dd">   33</a></span>&#160;  <a class="code" href="class_spectra_co.html#ac7bfa00174710c92a077113a202ba2dd">SpectraCo</a>(std::nullptr_t) noexcept</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = <span class="stringliteral">&quot;empty&quot;</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>= <span class="stringliteral">&quot;empty&quot;</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a> = 0;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a> = 0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = 0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a7aa1ab216355e91774cbf364a7286043">   43</a></span>&#160;  <a class="code" href="class_spectra_co.html#a7aa1ab216355e91774cbf364a7286043">SpectraCo</a>(std::vector&lt;float&gt; <span class="keyword">const</span> &amp; spectra, <span class="keywordtype">float</span> <span class="keyword">const</span> &amp; min_value = 0, <span class="keywordtype">float</span> <span class="keyword">const</span> &amp; max_value = 0, std::string <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> = <span class="stringliteral">&quot;&quot;</span>, std::string <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> = <span class="stringliteral">&quot;&quot;</span>) : </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>      (<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>     (<a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>      (<a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(spectra.<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>())),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>  (<a class="code" href="vector__functions_8hpp.html#a2b29a4762dbbff2cabcb7e8a62cb0d39">sum</a>(spectra)),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> (min_value),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> (max_value)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.reserve(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp; value : spectra) <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.push_back(<a class="code" href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a>(value));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a7d0e3629ec73c41156b8c7ca71f3705e">   56</a></span>&#160;  <a class="code" href="class_spectra_co.html#a7d0e3629ec73c41156b8c7ca71f3705e">SpectraCo</a>(std::vector&lt;double&gt; <span class="keyword">const</span> &amp; spectra, <span class="keywordtype">float</span> <span class="keyword">const</span> &amp; min_value = 0, <span class="keywordtype">float</span> <span class="keyword">const</span> &amp; max_value = 0, std::string <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> = <span class="stringliteral">&quot;&quot;</span>, std::string <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> = <span class="stringliteral">&quot;&quot;</span>) : </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>  (spectra),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>     (<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>    (<a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>     (<a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(spectra.<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>())),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a> (<a class="code" href="vector__functions_8hpp.html#a2b29a4762dbbff2cabcb7e8a62cb0d39">sum</a>(spectra)),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>    (min_value),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>    (max_value)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac8127b3f1b1eaf9292400cf2efa7bbde">   68</a></span>&#160;  <a class="code" href="class_spectra_co.html#ac8127b3f1b1eaf9292400cf2efa7bbde">SpectraCo</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other, std::string <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> = <span class="stringliteral">&quot;&quot;</span>, std::string <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> = <span class="stringliteral">&quot;&quot;</span>) : </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>  (other.<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     (other.<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        (other.<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       (other.<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        (other.<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    (other.<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       (other.<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       (other.<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>  != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a> = <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ad896a521e57469c1c02c47a4e7d7349b">   83</a></span>&#160;  <a class="code" href="class_spectra_co.html#ad896a521e57469c1c02c47a4e7d7349b">SpectraCo</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a>* other, std::string <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> = <span class="stringliteral">&quot;&quot;</span>, std::string <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> = <span class="stringliteral">&quot;&quot;</span>) : </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> (other-&gt;<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     (other-&gt;<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        (other-&gt;<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       (other-&gt;<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        (other-&gt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    (other-&gt;<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       (other-&gt;<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       (other-&gt;<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a> = <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a3e4d1435fa3a80662a8c4442464988e1">   98</a></span>&#160;  <a class="code" href="class_spectra_co.html#a3e4d1435fa3a80662a8c4442464988e1">SpectraCo</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other, <a class="code" href="class_recalibration.html">Recalibration</a> <span class="keyword">const</span> &amp; recal) : </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> (other.<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     (other.<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        (other.<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>),</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       (other.<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        (other.<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    (other.<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       (other.<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       (other.<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">this</span> -&gt; <a class="code" href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">recalibrate</a>(recal);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac40ff3692cc98ac889886bbe16d0c337">  112</a></span>&#160;  <a class="code" href="class_spectra_co.html#ac40ff3692cc98ac889886bbe16d0c337">SpectraCo</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a>* other, <a class="code" href="class_recalibration.html">Recalibration</a> <span class="keyword">const</span> &amp; recal) : </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> (other-&gt;<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     (other-&gt;<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        (other-&gt;<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       (other-&gt;<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        (other-&gt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    (other-&gt;<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       (other-&gt;<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       (other-&gt;<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">this</span> -&gt; <a class="code" href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">recalibrate</a>(recal);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a488369423915a272c24b561553cea913">  126</a></span>&#160;  <a class="code" href="class_spectra_co.html#a488369423915a272c24b561553cea913">SpectraCo</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other, <a class="code" href="class_calibration.html">Calibration</a> <span class="keyword">const</span> &amp; cal, <a class="code" href="_hit_8hpp.html#ab5dd24876acad09ec52c250c1668466c">Label</a> <span class="keyword">const</span> &amp; label) : </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> (other.<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     (other.<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>),</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        (other.<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       (other.<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        (other.<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>),</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    (other.<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>),</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       (other.<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       (other.<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keyword">this</span> -&gt; <a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(cal, label);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a264644c4da160d7d7eed1cbaaae5a77c">  140</a></span>&#160;  <a class="code" href="class_spectra_co.html#a264644c4da160d7d7eed1cbaaae5a77c">SpectraCo</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a>* other, <a class="code" href="class_calibration.html">Calibration</a> <span class="keyword">const</span> &amp; cal, <a class="code" href="_hit_8hpp.html#ab5dd24876acad09ec52c250c1668466c">Label</a> <span class="keyword">const</span> &amp; label) : </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> (other-&gt;<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     (other-&gt;<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        (other-&gt;<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       (other-&gt;<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        (other-&gt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    (other-&gt;<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       (other-&gt;<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       (other-&gt;<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">this</span> -&gt; <a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(cal, label);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa2508fe72a91029cd85d9f6dbce5cd93">  153</a></span>&#160;  <a class="code" href="class_spectra_co.html#aa2508fe72a91029cd85d9f6dbce5cd93">SpectraCo</a>(std::vector&lt;double&gt; <span class="keyword">const</span> &amp; _data) :</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>(_data),</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>(_data.<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>()),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>(0),</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>(<a class="code" href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a>(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>))</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a46fdc41ee93d910d1e667c4715e8eb9e">  162</a></span>&#160;  <a class="code" href="class_spectra_co.html#a46fdc41ee93d910d1e667c4715e8eb9e">SpectraCo</a>(<span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>) : </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>(<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>(0),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>(<a class="code" href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a>(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>))</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.resize(<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a7cd88b33fa9b85c5bf2dcdd2e3d13dc2">  170</a></span>&#160;  <a class="code" href="class_spectra_co.html#a7cd88b33fa9b85c5bf2dcdd2e3d13dc2">SpectraCo</a>(TH1* root_spectra, std::string <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> = <span class="stringliteral">&quot;&quot;</span>, std::string <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> = <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">load</a>(root_spectra);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a> != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a> = <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aae276b412dd31fc06933db96b65298fd">  177</a></span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>&amp; <a class="code" href="class_spectra_co.html#aae276b412dd31fc06933db96b65298fd">operator=</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> = other.<a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>     = other.<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>        = other.<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>       = other.<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>        = other.<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>    = other.<a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>       = other.<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>       = other.<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ad094b13ab3d8e445b04edc68a5c12ec0">  191</a></span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>&amp; <a class="code" href="class_spectra_co.html#ad094b13ab3d8e445b04edc68a5c12ec0">operator=</a>(TH1* root_spectra)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">load</a>(root_spectra);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">load</a>(TH1* root_spectra);</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">  198</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>;}</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a85cee2f57fbae02a28329584da5df1b5">  199</a></span>&#160;  <span class="keyword">auto</span> &amp; <a class="code" href="class_spectra_co.html#a85cee2f57fbae02a28329584da5df1b5">data</a>() {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>;}</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Setters :</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a5347b79a6a914df04a1a99664fd5cc96">  202</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a5347b79a6a914df04a1a99664fd5cc96">setMinX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; _min_x) {<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = _min_x; <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();}</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aaee0e2be91f5b3e3958892b8389a5003">  203</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#aaee0e2be91f5b3e3958892b8389a5003">setMaxX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; _max_x) {<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = _max_x; <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();}</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac2141fbefadce3d8f82e5c7db09998ab">  204</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ac2141fbefadce3d8f82e5c7db09998ab">setRangeX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; _min_x, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; _max_x) {<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = _min_x; <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = _max_x; <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">  206</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>(std::string <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>) {<span class="keywordflow">return</span> (<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>);}</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">  207</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>(std::string <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>) {<span class="keywordflow">return</span> (<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a> = <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>);}</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// Getters :</span></div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">  210</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>()<span class="keyword">     const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>          ;}</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a79deb54e5d5e3d36f9294482fea3d08c">  211</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#a79deb54e5d5e3d36f9294482fea3d08c">name</a>()           {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>          ;}</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">  212</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">title</a>()<span class="keyword">    const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>         ;}</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aba424b38fe96dbeb3b7d69d3b10d1a21">  213</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#aba424b38fe96dbeb3b7d69d3b10d1a21">title</a>()          {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>         ;}</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">  214</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>()<span class="keyword">     const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>          ;}</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="class_spectra_co.html#abb70561652a097439bbaa71fbebd70c4">  215</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#abb70561652a097439bbaa71fbebd70c4">size</a>()           {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>          ;}</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aad2d7fb657b00304906a0c5e3c9a3aed">  216</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#aad2d7fb657b00304906a0c5e3c9a3aed">integral</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>      ;}</div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a4a6080fd25cec92c1a6295e4d8398a44">  217</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#a4a6080fd25cec92c1a6295e4d8398a44">integral</a>()       {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a>      ;}</div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aed822c874938eb1f5953c6e1a412cf33">  218</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#aed822c874938eb1f5953c6e1a412cf33">minX</a>()<span class="keyword">     const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>         ;}</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="class_spectra_co.html#abb97aec97436b5d4171015db6b47e6b4">  219</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#abb97aec97436b5d4171015db6b47e6b4">minX</a>()           {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>         ;}</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">  220</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">maxX</a>()<span class="keyword">     const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>         ;}</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aaeaea4ebc4fd51825acf90e66eb89ae4">  221</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#aaeaea4ebc4fd51825acf90e66eb89ae4">maxX</a>()           {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>         ;}</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">  222</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>()<span class="keyword">   const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a>        ;}</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a30feae642d436e24ff7397891030d859">  223</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#a30feae642d436e24ff7397891030d859">factor</a>()         {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a>        ;}</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a1b66482bf4e3ff7903bda481d6d67a8d">  224</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a1b66482bf4e3ff7903bda481d6d67a8d">lastBin</a>()<span class="keyword">  const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.back();}</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ad6c387515e792a22195054cd6c174db5">  225</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#ad6c387515e792a22195054cd6c174db5">lastBin</a>()        {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.back();}</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a626908f0a27928d07d980cfcec3b8454">  226</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a626908f0a27928d07d980cfcec3b8454">back</a>()<span class="keyword">     const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.back();}</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a4bb4afaf9dd3881b73e8c6e740712a30">  227</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#a4bb4afaf9dd3881b73e8c6e740712a30">back</a>()           {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.back();}</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9cbf03e7634f8a80d65aec65d3d9119c">  228</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a9cbf03e7634f8a80d65aec65d3d9119c">get</a>()<span class="keyword">      const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>       ;}</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a4d14e86e9dd8d42c0ce5a72a2f3b7dfc">  229</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#a4d14e86e9dd8d42c0ce5a72a2f3b7dfc">get</a>()            {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>       ;}</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac96882f321f72ffe8757493da9b5b2fa">  230</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#ac96882f321f72ffe8757493da9b5b2fa">peaks</a>()<span class="keyword">    const </span>{<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>         ;}</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a889fd42392232f574b687970fda7e311">  231</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#a889fd42392232f574b687970fda7e311">peaks</a>()          {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>         ;}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// Calculators :</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a7b935499bbdce4b84a0f640b6518765c">derivate</a>(<span class="keywordtype">int</span> smooth = 1) noexcept;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a9be3e04ddc73df4d11336ec806313094">derivate2</a>(<span class="keywordtype">int</span> smooth = 1) noexcept;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#adbdfafcc8b0a95d520e491b0062b2e0b">removeBackground</a>(<span class="keywordtype">int</span> const &amp; smooth, std::<span class="keywordtype">string</span> const &amp; fit_options = &quot;&quot;) noexcept;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#abf17675f290cad6e53ad51e59430a63c">integralInRangeBin</a>(<span class="keywordtype">int</span> const &amp; bin_min, <span class="keywordtype">int</span> const &amp; bin_max) noexcept;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a7986a8f7ea5491f7a69ad810e857894f">integralInRange</a>(<span class="keywordtype">double</span> const &amp; value_min, <span class="keywordtype">double</span> const &amp; value_max) noexcept;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a6c50f289318ed3a37218be1b2485a0aa">meanInRangeBin</a>(<span class="keywordtype">int</span> const &amp; bin_min, <span class="keywordtype">int</span> const &amp; bin_max) noexcept;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a4e9df1dfede067a7a241e1209a01f4bc">meanInRange</a>(<span class="keywordtype">double</span> const &amp; value_min, <span class="keywordtype">double</span> const &amp; value_max) noexcept;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// Getters :</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a5c0d013692342e790580839787143f36">  244</a></span>&#160;<span class="comment"></span>  std::vector&lt;<span class="keywordtype">double</span>&gt; const &amp; <a class="code" href="class_spectra_co.html#a5c0d013692342e790580839787143f36">derivativeData</a>() {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>();}</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a6106089e9e4295cc71f3d45f781ac2c8">  246</a></span>&#160;  std::vector&lt;double&gt; <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a6106089e9e4295cc71f3d45f781ac2c8">derivative2Data</a>() {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>-&gt;<a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>();}</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa9af077c307bb5e33e271bf8cbaa1741">  248</a></span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#aa9af077c307bb5e33e271bf8cbaa1741">derivative</a>() {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#aa9af077c307bb5e33e271bf8cbaa1741">derivative</a>(std::string <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a5db4e774152522eac0e1c58af984fc28">  251</a></span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a5db4e774152522eac0e1c58af984fc28">derivative2</a>() {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>;}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a5db4e774152522eac0e1c58af984fc28">derivative2</a>(std::string <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="class_spectra_co.html#acbe779815b224c8102ec62af4403a7d9">  258</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#acbe779815b224c8102ec62af4403a7d9">inverse</a>() {<span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; value : <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>) value = -value;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a66d66744d2d12b088005a826158e2946">  260</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="class_spectra_co.html#a66d66744d2d12b088005a826158e2946">lastBinWithValue</a>() const noexcept</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">int</span> bin_it = <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">while</span>(bin_it&gt;0) <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[--bin_it]!=0.0) <span class="keywordflow">return</span> bin_it;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a1a2f7e1b1c45f16cb77d531c90c5212b">  267</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="class_spectra_co.html#a1a2f7e1b1c45f16cb77d531c90c5212b">firstBinWithValue</a>() const noexcept</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">int</span> bin_it = 0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">while</span>(bin_it&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>) <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin_it++]!=0.0) <span class="keywordflow">return</span> bin_it;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Root interface methods :</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a223f3a9be7c661c1ef700d8bfda1106f">fill</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; X) noexcept;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a9f6fa49281669395c0e10f833f8e914e">draw</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* param = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a79c602e0c90555c37098d070863134f3">rebin</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>, <span class="keywordtype">bool</span> <span class="keyword">const</span> &amp; rebin_derivatives = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  TH1D* <a class="code" href="class_spectra_co.html#aa12a2fe0635e8b3e73eb47b09810f75e">createTH1D</a>(std::string newName = <span class="stringliteral">&quot;&quot;</span>, std::string newTitle = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  TH1F* <a class="code" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">createTH1F</a>(std::string newName = <span class="stringliteral">&quot;&quot;</span>, std::string newTitle = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  </div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a6dc41ae065225471fadc69382077ceb8">  282</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a6dc41ae065225471fadc69382077ceb8">write</a>() {this-&gt;<a class="code" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">createTH1F</a>(<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>())-&gt;Write();}</div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aecdb9a51ee8bab5e5fbe0563161664f9">  283</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#aecdb9a51ee8bab5e5fbe0563161664f9">write</a>(TDirectory* directory)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">auto</span> histo = this-&gt;<a class="code" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">createTH1F</a>(<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>()); </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    directory-&gt;cd(); </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    histo-&gt;Write(); </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    gROOT-&gt;cd();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a56313f7f5ce661a5952d251e51ca3246">  290</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a56313f7f5ce661a5952d251e51ca3246">writeTH1D</a>() {this-&gt;<a class="code" href="class_spectra_co.html#aa12a2fe0635e8b3e73eb47b09810f75e">createTH1D</a>(<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>())-&gt;Write();}</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a3a8fdeb82862a8500d53634b5bd9acbc">  291</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a3a8fdeb82862a8500d53634b5bd9acbc">writeTH1D</a>(TDirectory* directory) </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    directory-&gt;cd(); </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    this-&gt;<a class="code" href="class_spectra_co.html#aa12a2fe0635e8b3e73eb47b09810f75e">createTH1D</a>(<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>())-&gt;Write(); </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    gROOT-&gt;cd();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// To get the bin&#39;s content (TH1::getBinContent):</span></div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9e31bbca1885c3a48c66e7f8e2622f9a">  299</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a9e31bbca1885c3a48c66e7f8e2622f9a">get</a>        (<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin) <span class="keyword">const</span> noexcept {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin];}</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ae05d953f1aa96c7d7077ff6dda044afd">  300</a></span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#ae05d953f1aa96c7d7077ff6dda044afd">operator[] </a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin) <span class="keyword">const</span> noexcept {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin];}</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a484fc9226bbbee3ed3b654c3aeea165b">  301</a></span>&#160;  <span class="keyword">auto</span>       &amp; <a class="code" href="class_spectra_co.html#ae05d953f1aa96c7d7077ff6dda044afd">operator[] </a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin)       noexcept {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin];}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// Using interpolation if the given bin is a double (TH1F::Eval)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; bin) <span class="keyword">const</span> noexcept ;</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa32b538c1586e9f78af9ab28fed27efb">  305</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#ae05d953f1aa96c7d7077ff6dda044afd">operator[] </a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; bin)       noexcept {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(bin);}</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a00b22f96c7d319af473e16e9f07efbfd">  306</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#ae05d953f1aa96c7d7077ff6dda044afd">operator[] </a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; bin) <span class="keyword">const</span> noexcept {<span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(bin);}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// Get the X value : </span></div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a85342e1258a9d8877fb60fa2dca6275f">  309</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a85342e1258a9d8877fb60fa2dca6275f">getX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; bin) {<span class="keywordflow">return</span> bin * (<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>/<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);}</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// Get the bin corresponding for a given X value</span></div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac5f6afc77e5fddc79afe224dc0a1dfec">  311</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#ac5f6afc77e5fddc79afe224dc0a1dfec">getBin</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; x)<span class="keyword"> const</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> &amp; ret = <a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(std::trunc(x*<a class="code" href="class_spectra_co.html#a67a019827e1107bc1fc2f28eb6d854f7">m_slope</a> + <a class="code" href="class_spectra_co.html#a80e56f3b23d5a7092dd3152f47bf3c47">m_intercept</a>));</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> (ret&gt;-1) ? ret : 0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="class_spectra_co.html#afdfa3e10eda4e3513674dddcd32ae7e6">  318</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#afdfa3e10eda4e3513674dddcd32ae7e6">calibrateX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; intercept, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; slope = 1)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> * slope + intercept;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> * slope + intercept;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#afdfa3e10eda4e3513674dddcd32ae7e6">calibrateX</a>(intercept, slope);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// double difference(SpectraCo const &amp; other, int const &amp; bin)</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// {</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//   return m_spectra[bin] - other[other.getBin(spectra.getX(bin))];</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#aa7114661992e4ae88e87cb1ccb82d6ed">operator+</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#a992b73363532d45debd7fd7befd21765">operator-</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#a34ea7496185caf2178c8ba1c10876dd3">operator*</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#aa4225392a595ff8a0950ef67610096d0">operator/</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>&amp; <a class="code" href="class_spectra_co.html#a9c5ae4fa536ee968b112bdab670fa2d8">operator*=</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">recalibrate</a>(<a class="code" href="class_recalibration.html">Recalibration</a> <span class="keyword">const</span> &amp; recal);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(<a class="code" href="class_calibration.html">Calibration</a> <span class="keyword">const</span> &amp; calib, <a class="code" href="_hit_8hpp.html#ab5dd24876acad09ec52c250c1668466c">Label</a> <span class="keyword">const</span> &amp; label);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(std::vector&lt;double&gt; <span class="keyword">const</span> &amp; coeffs);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#af74c78334a7be1cc421779f9e4b30a0b">calibrateAndScale</a>(std::vector&lt;double&gt; <span class="keyword">const</span> &amp; coeffs);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ab733430ea1ac8bafd68b6709f19d1d0d">resizeBin</a>(<span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; new_size);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a0ba318153d548c02c9ab4b39465ea1b4">resizeX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">maxX</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a0ba318153d548c02c9ab4b39465ea1b4">resizeX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#aed822c874938eb1f5953c6e1a412cf33">minX</a>, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">maxX</a>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">findPeaks</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; nb_bins_below_threshold);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">findPeaks</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; nb_bins_below_threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; smooth);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// Manage resources :</span></div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a649cc895e9813d1a82c9057022228266">  349</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a649cc895e9813d1a82c9057022228266">deleteDerivative</a>() {<span class="keyword">delete</span> <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>;}</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// Other operations :</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aecb46bfbd2968e90d0ffd6d5848ca8b4">  354</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#aecb46bfbd2968e90d0ffd6d5848ca8b4">chi2</a> (<a class="code" href="class_spectra_co.html">SpectraCo</a> &amp; other)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">double</span> sum_errors_squared = 0.0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;other.<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>(); bin++) <span class="keywordflow">if</span> (other[bin]&gt;0)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// Calculate the error for this bin :</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> &amp; <a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a> = <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin]-other[bin];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">// Variance of the bin :</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; weight = 1/other[bin]; <span class="comment">// V = sigma² = 1/N</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">// Add the error to the total squared error of the spectra :</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      sum_errors_squared += <a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>*<a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>*weight;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> sum_errors_squared/other.<a class="code" href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">size</a>();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// Histogram manipulations :</span></div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a4edb2ef585474bb8c1f728d0dc7731e2">  374</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a4edb2ef585474bb8c1f728d0dc7731e2">setActualRange</a>() {<span class="keyword">this</span> -&gt; <a class="code" href="class_spectra_co.html#ab733430ea1ac8bafd68b6709f19d1d0d">resizeBin</a>(<span class="keyword">this</span> -&gt; <a class="code" href="class_spectra_co.html#a66d66744d2d12b088005a826158e2946">lastBinWithValue</a>());}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_histo_null.html">  376</a></span>&#160;  <span class="keyword">class </span><a class="code" href="class_spectra_co_1_1_histo_null.html">HistoNull</a></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_histo_null.html#a47f60c3e6fe497633fb72bed36224ea4">  379</a></span>&#160;    <a class="code" href="class_spectra_co_1_1_histo_null.html#a47f60c3e6fe497633fb72bed36224ea4">HistoNull</a>() {<a class="code" href="print_8hpp.html#afded2b178f1cba7246c86beaab6d4e6c">printC</a>(<a class="code" href="print_8hpp.html#adce122f566c88a1eceeb79a635afa964">GREY</a>, <span class="stringliteral">&quot;SpectraCo::HistoNull :&quot;</span>, <a class="code" href="print_8hpp.html#ab702106cf3b3e96750b6845ded4e0299">RESET</a>, <a class="code" href="print_8hpp.html#a8d23feea868a983c8c2b661e1e16972f">RED</a>, <span class="stringliteral">&quot; loaded histogram is nullptr&quot;</span>, <a class="code" href="print_8hpp.html#ab702106cf3b3e96750b6845ded4e0299">RESET</a>);}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  };</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_histo_zombie.html">  382</a></span>&#160;  <span class="keyword">class </span><a class="code" href="class_spectra_co_1_1_histo_zombie.html">HistoZombie</a></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_histo_zombie.html#a6bec654226930402a49bf10619b2cdd6">  385</a></span>&#160;    <a class="code" href="class_spectra_co_1_1_histo_zombie.html#a6bec654226930402a49bf10619b2cdd6">HistoZombie</a>() {<a class="code" href="print_8hpp.html#afded2b178f1cba7246c86beaab6d4e6c">printC</a>(<a class="code" href="print_8hpp.html#adce122f566c88a1eceeb79a635afa964">GREY</a>, <span class="stringliteral">&quot;SpectraCo::HistoZombie :&quot;</span>, <a class="code" href="print_8hpp.html#ab702106cf3b3e96750b6845ded4e0299">RESET</a>, <a class="code" href="print_8hpp.html#a8d23feea868a983c8c2b661e1e16972f">RED</a>, <span class="stringliteral">&quot; loaded histogram is zombie&quot;</span>, <a class="code" href="print_8hpp.html#ab702106cf3b3e96750b6845ded4e0299">RESET</a>);}</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  };</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_size_missmatch.html">  388</a></span>&#160;  <span class="keyword">class </span><a class="code" href="class_spectra_co_1_1_size_missmatch.html">SizeMissmatch</a></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_size_missmatch.html#a94aae14f6932f29e357f42fd0132827f">  391</a></span>&#160;    <a class="code" href="class_spectra_co_1_1_size_missmatch.html#a94aae14f6932f29e357f42fd0132827f">SizeMissmatch</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="class_spectra_co_1_1_size_missmatch.html#a42beba683555e28da7b2436ccfeb55e5">  392</a></span>&#160;    <a class="code" href="class_spectra_co_1_1_size_missmatch.html#a42beba683555e28da7b2436ccfeb55e5">SizeMissmatch</a>(std::string <span class="keyword">const</span> &amp; message){<a class="code" href="print_8hpp.html#ad9e2dd512a5915af4751a40fefbfbc94">warning</a>(message);}</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  };</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">  398</a></span>&#160;  TH1* <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">  399</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">  400</a></span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">  401</a></span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a> = <span class="keyword">nullptr</span>; <span class="comment">// Second derivative</span></div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">  402</a></span>&#160;  <a class="code" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a> <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">  404</a></span>&#160;  std::string <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = <span class="stringliteral">&quot;Unnamed&quot;</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">  405</a></span>&#160;  std::string <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a> = <span class="stringliteral">&quot;Untitled&quot;</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">  407</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a> = 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">  408</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a> = 0;</div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">  409</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = 0;</div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">  410</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = 0;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">  411</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a> = 1; <span class="comment">// If the spectra has been multiplied or divided</span></div>
<div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">  412</a></span>&#160;  std::vector&lt;TH1*&gt; <a class="code" href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">root_spectra_pointers</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a5219f7157190c99448c3b14ea37fbac2">  413</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="class_spectra_co.html#a5219f7157190c99448c3b14ea37fbac2">nb_histo_drawn</a> = 0;</div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9515b65f7b587af82030316811c1c0aa">  414</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a9515b65f7b587af82030316811c1c0aa">m_rebin</a> = 1;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// Relation bewteen X value and bin number : bin = m_slope*X + m_intercept</span></div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a67a019827e1107bc1fc2f28eb6d854f7">  417</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a67a019827e1107bc1fc2f28eb6d854f7">m_slope</a> = -1;</div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a80e56f3b23d5a7092dd3152f47bf3c47">  418</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a80e56f3b23d5a7092dd3152f47bf3c47">m_intercept</a> = 0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;};</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#aca2246688a20da3a38fe2a0f9cd74e90">  421</a></span>&#160;std::ostream&amp; <a class="code" href="_spectra_co_8hpp.html#aca2246688a20da3a38fe2a0f9cd74e90">operator&lt;&lt;</a>(std::ostream&amp; out, <a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; spectra)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;{</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  out &lt;&lt; spectra.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; spectra.<a class="code" href="class_spectra_co.html#aad2d7fb657b00304906a0c5e3c9a3aed">integral</a>() &lt;&lt; <span class="stringliteral">&quot; counts&quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span>(spectra.<a class="code" href="class_spectra_co.html#ac96882f321f72ffe8757493da9b5b2fa">peaks</a>().size()&gt;0) out &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; spectra.<a class="code" href="class_spectra_co.html#ac96882f321f72ffe8757493da9b5b2fa">peaks</a>().size() &lt;&lt; <span class="stringliteral">&quot; peaks found&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#ad3085c55da700fb2917875d8efe0b377">  429</a></span>&#160;std::string <a class="code" href="_spectra_co_8hpp.html#ad3085c55da700fb2917875d8efe0b377">type_of&lt;SpectraCo&gt;</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; spectra)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;SpectraCo_&quot;</span>+<a class="code" href="print_8hpp.html#a90460287027986fbf0c9a1ef8e5a1bce">type_of</a>(spectra.<a class="code" href="class_spectra_co.html#aed822c874938eb1f5953c6e1a412cf33">minX</a>());</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">// DEFINITIONS : //</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">  438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">SpectraCo::calculateCoeff</a>()</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// Coefficients to convert X value to bin </span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="class_spectra_co.html#a67a019827e1107bc1fc2f28eb6d854f7">m_slope</a> = <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>/(<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>-<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="class_spectra_co.html#a80e56f3b23d5a7092dd3152f47bf3c47">m_intercept</a> = - <a class="code" href="class_spectra_co.html#a67a019827e1107bc1fc2f28eb6d854f7">m_slope</a>*<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a223f3a9be7c661c1ef700d8bfda1106f">  447</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a223f3a9be7c661c1ef700d8bfda1106f">SpectraCo::fill</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; X) noexcept</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin = getBin(X);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> (bin&gt;-1 &amp;&amp; bin&lt;m_size) m_spectra[bin]++;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9f6fa49281669395c0e10f833f8e914e">  454</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a9f6fa49281669395c0e10f833f8e914e">SpectraCo::draw</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* param)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;{</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keyword">auto</span> <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a> = <a class="code" href="string__functions_8hpp.html#ae058d07fbc702d0b0f79e3650e7804a2">concatenate</a>(<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>, <span class="stringliteral">&quot;_drawing_&quot;</span>, <a class="code" href="class_spectra_co.html#a5219f7157190c99448c3b14ea37fbac2">nb_histo_drawn</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="class_spectra_co.html#a5219f7157190c99448c3b14ea37fbac2">nb_histo_drawn</a>++;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">root_spectra_pointers</a>.push_back(<a class="code" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">createTH1F</a>(<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>, <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>));</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">root_spectra_pointers</a>.back()-&gt;Draw(param);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a79c602e0c90555c37098d070863134f3">  466</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a79c602e0c90555c37098d070863134f3">SpectraCo::rebin</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; factor, <span class="keywordtype">bool</span> <span class="keyword">const</span> &amp; rebin_derivatives)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="class_spectra_co.html#a9515b65f7b587af82030316811c1c0aa">m_rebin</a>*=<a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>; <span class="comment">// Saves the rebin factor</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">auto</span> histo = <a class="code" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">createTH1F</a>(<a class="code" href="string__functions_8hpp.html#ae058d07fbc702d0b0f79e3650e7804a2">concatenate</a>(<a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>(), <span class="stringliteral">&quot; rebinning by &quot;</span>, <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>));</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  histo-&gt;Rebin(<a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  this-&gt;<a class="code" href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">load</a>(histo);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">if</span> (rebin_derivatives &amp;&amp; <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#a79c602e0c90555c37098d070863134f3">rebin</a>(<a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>, rebin_derivatives);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">  475</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">SpectraCo::load</a>(TH1* root_spectra)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span> (!root_spectra) <span class="keywordflow">throw</span> <a class="code" href="class_spectra_co_1_1_histo_null.html">HistoNull</a>();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (root_spectra-&gt;IsZombie()) <span class="keywordflow">throw</span> <a class="code" href="class_spectra_co_1_1_histo_zombie.html">HistoZombie</a>();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (root_spectra-&gt;IsA()-&gt;InheritsFrom(TH2::Class()) || root_spectra-&gt;IsA()-&gt;InheritsFrom(TH3::Class()))</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="lib_co_8hpp.html#a6df2dcd4b1f61c75dc292942bc5ca74d">throw_error</a>(<span class="stringliteral">&quot;In SpectraCo::load(TH1* root_spectra) : root_spectra is a TH2 or TH3 !!&quot;</span>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">m_loaded_TH1</a> = root_spectra;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a> = root_spectra-&gt;GetName();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a> = root_spectra-&gt;GetTitle();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a> = root_spectra-&gt;Integral();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a> = root_spectra -&gt; GetXaxis() -&gt; GetNbins();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = root_spectra -&gt; GetXaxis() -&gt; GetBinLowEdge(1);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = root_spectra -&gt; GetXaxis() -&gt; GetBinLowEdge(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>+1);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.resize(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 1; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin] = <a class="code" href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a>(root_spectra-&gt;GetBinContent(bin));</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa7114661992e4ae88e87cb1ccb82d6ed">  498</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#aa7114661992e4ae88e87cb1ccb82d6ed">SpectraCo::operator+</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other)<span class="keyword"> const</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a> != <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>) <span class="keywordflow">throw</span> <a class="code" href="class_spectra_co_1_1_size_missmatch.html">SizeMissmatch</a>(<span class="stringliteral">&quot;in operator+(SpectraCo const &amp; other) : other size is different from that of this spectra&quot;</span>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> spectra(*<span class="keyword">this</span>);<span class="comment">// Optimize here</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) spectra[bin] += other[bin];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  spectra.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>(spectra.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>()+<span class="stringliteral">&quot; + &quot;</span>+other.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>());</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  spectra.<a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>(spectra.<a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>()+<span class="stringliteral">&quot; + &quot;</span>+other.<a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>());</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">return</span> spectra;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a992b73363532d45debd7fd7befd21765">  508</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#a992b73363532d45debd7fd7befd21765">SpectraCo::operator-</a>(<a class="code" href="class_spectra_co.html">SpectraCo</a> <span class="keyword">const</span> &amp; other)<span class="keyword"> const</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (other.<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a> != <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>) <span class="keywordflow">throw</span> <a class="code" href="class_spectra_co_1_1_size_missmatch.html">SizeMissmatch</a>(<span class="stringliteral">&quot;in operator+(SpectraCo const &amp; other) : other size is different from that of this spectra&quot;</span>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> spectra(*<span class="keyword">this</span>);<span class="comment">// Optimize here</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) spectra[bin] -= other[other.<a class="code" href="class_spectra_co.html#ac5f6afc77e5fddc79afe224dc0a1dfec">getBin</a>(spectra.<a class="code" href="class_spectra_co.html#a85342e1258a9d8877fb60fa2dca6275f">getX</a>(bin))];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  spectra.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>(spectra.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>()+<span class="stringliteral">&quot; - &quot;</span>+other.<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>());</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  spectra.<a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>(spectra.<a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>()+<span class="stringliteral">&quot; - &quot;</span>+other.<a class="code" href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">title</a>());</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">return</span> spectra;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a34ea7496185caf2178c8ba1c10876dd3">  521</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#a34ea7496185caf2178c8ba1c10876dd3">SpectraCo::operator*</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; factor)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> spectra(*<span class="keyword">this</span>);<span class="comment">// Optimize here</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a> = <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) spectra[bin] = spectra[bin]*<a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// TODO if time : rename the spectra based on the multiplicative factor</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// if (m_factor!=1)// If the spectra has already been multiplied by another factor :</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// {</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="comment">//   auto begin_factor_it = spectra.name().find_last_of(&quot;_(x&quot;);</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">//   auto factor_name = spectra.name().substr(begin_factor_it, );</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// spectra.name(concatenate(spectra.name(), &quot;_(x&quot;, factor, &quot;)&quot;));</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// spectra.title(concatenate(spectra.title(), &quot; (x&quot;, factor, &quot;)&quot;));</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">return</span> spectra;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9c5ae4fa536ee968b112bdab670fa2d8">  537</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a> &amp; <a class="code" href="class_spectra_co.html#a9c5ae4fa536ee968b112bdab670fa2d8">SpectraCo::operator*=</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; factor)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin] *= <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa4225392a595ff8a0950ef67610096d0">  546</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a> <a class="code" href="class_spectra_co.html#aa4225392a595ff8a0950ef67610096d0">SpectraCo::operator/</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; factor)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;{</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <a class="code" href="class_spectra_co.html">SpectraCo</a> spectra(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a> == 0) {<a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>(<span class="stringliteral">&quot;In SpectraCo::operator/(factor) : factor is equal to zero !!&quot;</span>); <span class="keywordflow">return</span> spectra;}</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a> = <a class="code" href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">factor</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) spectra[bin] = spectra[bin]/<a class="code" href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">m_factor</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// TODO if time : </span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// if (m_factor!=1)// If the spectra has already been multiplied by another factor :</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// {</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">//   auto begin_factor_it = spectra.name().find_last_of(&quot;_(x&quot;);</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">//   auto factor_name = spectra.name().substr(begin_factor_it, );</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// spectra.name(concatenate(spectra.name(), &quot;_(x&quot;, factor, &quot;)&quot;));</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// spectra.title(concatenate(spectra.title(), &quot; (x&quot;, factor, &quot;)&quot;));</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">return</span> spectra;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">  563</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">SpectraCo::recalibrate</a>(<a class="code" href="class_recalibration.html">Recalibration</a> <span class="keyword">const</span> &amp; recal)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  std::vector&lt;double&gt; newSpectra(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> &amp; new_bin = recal.<a class="code" href="class_recalibration.html#a6ce90b10d69409fdbc385ba6f990e073">calculate</a>(bin);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    newSpectra[bin] = <a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(new_bin);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a> = newSpectra;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">recalibrate</a>(recal);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">  576</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">SpectraCo::calibrate</a>(<a class="code" href="class_calibration.html">Calibration</a> <span class="keyword">const</span> &amp; calib, <a class="code" href="_hit_8hpp.html#ab5dd24876acad09ec52c250c1668466c">Label</a> <span class="keyword">const</span> &amp; label)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">if</span> (calib.<a class="code" href="class_calibration.html#a91d512d3bcbc3a3439a7902326965b48">order</a>(label)&lt;2)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a> = calib.<a class="code" href="class_calibration.html#a6044ac4a0a17e177af66138f75aca6b6">apply</a>(<a class="code" href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">m_min_x</a>, label);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = calib.<a class="code" href="class_calibration.html#a6044ac4a0a17e177af66138f75aca6b6">apply</a>(<a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a>, label);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    std::vector&lt;double&gt; newSpectra(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> &amp; new_bin = calib.<a class="code" href="class_calibration.html#a6044ac4a0a17e177af66138f75aca6b6">apply</a>(bin, label);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      newSpectra[bin] = this-&gt;<a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(new_bin);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a> = newSpectra;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// Replaces &quot;adc&quot; with &quot;Energy&quot; if found in the name and/or title :</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="string__functions_8hpp.html#a3a78dc61d5d352a6559b927ae3167a21">replace</a>(<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>, <span class="stringliteral">&quot;adc&quot;</span>, <span class="stringliteral">&quot;Energy&quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <a class="code" href="string__functions_8hpp.html#a3a78dc61d5d352a6559b927ae3167a21">replace</a>(<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>, <span class="stringliteral">&quot;adc&quot;</span>, <span class="stringliteral">&quot;Energy&quot;</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(calib, label);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="class_spectra_co.html#af580e2c735a90aff03e6c1c159ed9b17">  602</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">SpectraCo::calibrate</a>(std::vector&lt;double&gt; <span class="keyword">const</span> &amp; coeffs)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;{</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordtype">int</span> order = <a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(coeffs.size()) - 1; <span class="comment">// int_cast to avoid underflow issue do to size_t being unsigned</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;       <span class="keywordflow">if</span> (order&lt;0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order == 0) {this-&gt;<a class="code" href="class_spectra_co.html#afdfa3e10eda4e3513674dddcd32ae7e6">calibrateX</a>(coeffs[0]);} <span class="comment">// calibrateX(slope, intercept(default = 0))</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order == 1) {this-&gt;<a class="code" href="class_spectra_co.html#afdfa3e10eda4e3513674dddcd32ae7e6">calibrateX</a>(coeffs[0], coeffs[1]);}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    std::vector&lt;double&gt; newSpectra(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">switch</span>(order)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">case</span> 2 : newSpectra[bin] = this-&gt;<a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(coeffs[0] + bin*coeffs[1] + bin*bin*coeffs[2]); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">case</span> 3 : newSpectra[bin] = this-&gt;<a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(coeffs[0] + bin*coeffs[1] + bin*bin*coeffs[2] + bin*bin*bin*coeffs[3]); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">case</span> 4 : newSpectra[bin] = this-&gt;<a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">interpolate</a>(coeffs[0] + bin*coeffs[1] + bin*bin*coeffs[2] + bin*bin*bin*coeffs[3] + bin*bin*bin*bin*coeffs[4]); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">default</span>: <a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>(<span class="stringliteral">&quot;SpectraCo::calibrate(vector&lt;double&gt; coeffs) : can&#39;t handle&quot;</span>, order+1, <span class="stringliteral">&quot;coefficients&quot;</span>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a> = newSpectra;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// Estetics : Replaces &quot;adc&quot; with &quot;Energy&quot; if found in the name and/or title :</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="string__functions_8hpp.html#a3a78dc61d5d352a6559b927ae3167a21">replace</a>(<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>, <span class="stringliteral">&quot;adc&quot;</span>, <span class="stringliteral">&quot;Energy&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <a class="code" href="string__functions_8hpp.html#a3a78dc61d5d352a6559b927ae3167a21">replace</a>(<a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>, <span class="stringliteral">&quot;adc&quot;</span>, <span class="stringliteral">&quot;Energy&quot;</span>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// Calibrate the derivative spectra if it exists as well</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(coeffs);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;}</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="class_spectra_co.html#af74c78334a7be1cc421779f9e4b30a0b">  637</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#af74c78334a7be1cc421779f9e4b30a0b">SpectraCo::calibrateAndScale</a>(std::vector&lt;double&gt; <span class="keyword">const</span> &amp; coeffs)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;{</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordflow">if</span> (coeffs.size() &lt; 2) <a class="code" href="lib_co_8hpp.html#a6df2dcd4b1f61c75dc292942bc5ca74d">throw_error</a>(<span class="stringliteral">&quot;in SpectraCo::calibrateAndScale(coeffs) : coeffs size needs to be at least 2 (first coeff is offset and second is scaling)&quot;</span>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  this-&gt;<a class="code" href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">calibrate</a>(<a class="code" href="vector__functions_8hpp.html#a629f2e4117a0bb1dada5aa3a4fad4765">sub_vec</a>(coeffs, 0, coeffs.size()-1));</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  (*this)*=coeffs.back();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">  644</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">SpectraCo::interpolate</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; _bin) <span class="keyword">const</span> noexcept</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;{</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordtype">int</span> bin_i = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(_bin); <span class="comment">//bin_i</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> (bin_i&lt;0 || bin_i &gt; (m_size-2)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; a = m_spectra[bin_i+1] - m_spectra[bin_i];<span class="comment">// a  =  y_i+1 - y_i</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; b = m_spectra[bin_i]   - a*bin_i;         <span class="comment">// b  =  y_i - a*bin_i</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">return</span> a*_bin+b;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;} </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="class_spectra_co.html#adbdfafcc8b0a95d520e491b0062b2e0b">  659</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#adbdfafcc8b0a95d520e491b0062b2e0b">SpectraCo::removeBackground</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; smooth, std::string <span class="keyword">const</span> &amp; fit_options) noexcept</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">auto</span> file = gROOT -&gt; GetFile();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">if</span> (file) gROOT-&gt;cd();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keyword">auto</span> root_histo = this-&gt;createTH1F();</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="code" href="namespace_co_analyse.html#afa2d6e36c43655ace45e8aa55a53d4da">CoAnalyse::removeBackground</a>(root_histo, smooth, fit_options);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  this-&gt;load(root_histo);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keyword">delete</span> root_histo;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">if</span> (file) file-&gt;cd();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;}</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno"><a class="line" href="class_spectra_co.html#abf17675f290cad6e53ad51e59430a63c">  670</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#abf17675f290cad6e53ad51e59430a63c">SpectraCo::integralInRangeBin</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin_min, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin_max) noexcept</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;{</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordtype">double</span> ret = 0.0;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_it = bin_min; bin_it&lt;bin_max; bin_it++) ret+=m_spectra[bin_it];</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a7986a8f7ea5491f7a69ad810e857894f">  677</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a7986a8f7ea5491f7a69ad810e857894f">SpectraCo::integralInRange</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; value_min, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; value_max) noexcept</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordtype">double</span> ret = 0.0; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordtype">int</span> bin_min = getBin(value_min);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordtype">int</span> bin_max = getBin(value_max);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_it = bin_min; bin_it&lt;bin_max; bin_it++) ret+=m_spectra[bin_it];</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a6c50f289318ed3a37218be1b2485a0aa">  687</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a6c50f289318ed3a37218be1b2485a0aa">SpectraCo::meanInRangeBin</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin_min, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin_max) noexcept</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;{</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a> = 0.0; <span class="keywordtype">double</span> integral = 0.0;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_it = bin_min; bin_it&lt;bin_max; bin_it++) </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a>+=bin_it*abs(m_spectra[bin_it]);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    integral+=abs(m_spectra[bin_it]);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a>/=integralInRangeBin(bin_min, bin_max);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">return</span> this-&gt;getX(<a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a4e9df1dfede067a7a241e1209a01f4bc">  699</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_spectra_co.html#a4e9df1dfede067a7a241e1209a01f4bc">SpectraCo::meanInRange</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; value_min, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; value_max) noexcept</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;{</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a> = 0.0; <span class="keywordtype">double</span> integral = 0.0;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">int</span> bin_min = getBin(value_min);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordtype">int</span> bin_max = getBin(value_max);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_it = bin_min; bin_it&lt;bin_max; bin_it++) </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a>+=bin_it*abs(m_spectra[bin_it]);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    integral+=abs(m_spectra[bin_it]);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a>/=integral;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">return</span> this-&gt;getX(<a class="code" href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">mean</a>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a7b935499bbdce4b84a0f640b6518765c">  714</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a7b935499bbdce4b84a0f640b6518765c">SpectraCo::derivate</a>(<span class="keywordtype">int</span> smooth) noexcept</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;{</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  m_derivative = <span class="keyword">new</span> <a class="code" href="class_spectra_co.html">SpectraCo</a>(*<span class="keyword">this</span>); <span class="comment">// Can optimize here</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  m_derivative-&gt;name() = m_name+<span class="stringliteral">&quot;_der&quot;</span>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; smooth_range = 2*smooth;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordtype">int</span> lower_bin = 0;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordtype">int</span> upper_bin = 0;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">double</span> low_sum = 0.0;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordtype">double</span> up_sum = 0.0;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 0; bin&lt;m_size; bin++)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    lower_bin = bin-smooth;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    upper_bin = bin+smooth;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// Before all, handle side effects : </span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// At the beginning and the end of the spectra, there are not enough bins on both sides to smooth correctly</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// Therefore, we have to set a correct number of bins</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> (lower_bin&lt;0)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    {<span class="comment">// For the first bins of the histogram</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      lower_bin = 0;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      upper_bin = 2*bin;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (upper_bin &gt; m_size-1)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    {<span class="comment">// For the last bins of the histogram</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      lower_bin = 2*bin-m_size;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      upper_bin = m_size;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    low_sum = 0.0;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    up_sum = 0.0;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// First, sum the content of all the bins on the left :</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_low = lower_bin; bin_low&lt;bin; bin_low++) {low_sum+=m_spectra[bin_low];}</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">// Second, sum the content of all the bins on the right :</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_up = bin+1; bin_up&lt;upper_bin; bin_up++) {up_sum+=m_spectra[bin_up];}</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">// Calculate the derivative : (sum_right - sum_left) / (x_right - x_left)</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    (*m_derivative)[bin] = (up_sum-low_sum)/(smooth_range);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">return</span> m_derivative;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;}</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a9be3e04ddc73df4d11336ec806313094">  759</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a9be3e04ddc73df4d11336ec806313094">SpectraCo::derivate2</a>(<span class="keywordtype">int</span> smooth)noexcept</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;{</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  derivate(smooth);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  m_derivative2 = m_derivative-&gt;derivate(smooth);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">return</span> m_derivative2;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a2d1839156a996f255b74024e12257bdb">  767</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#aa9af077c307bb5e33e271bf8cbaa1741">SpectraCo::derivative</a>(std::string <span class="keyword">const</span> &amp; name)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;{</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>(<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>, <span class="stringliteral">&quot;has no derivative spectra !!&quot;</span>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>() = <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>+<span class="stringliteral">&quot;_der&quot;</span>; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a213a9aea476c88a52c8c32a4eb775190">  781</a></span>&#160;<a class="code" href="class_spectra_co.html">SpectraCo</a>* <a class="code" href="class_spectra_co.html#a5db4e774152522eac0e1c58af984fc28">SpectraCo::derivative2</a>(std::string <span class="keyword">const</span> &amp; name)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;{</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>) </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>(<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>, <span class="stringliteral">&quot;has no second derivative spectra !!&quot;</span>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>-&gt;<a class="code" href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">name</a>() = <a class="code" href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">name</a>+<span class="stringliteral">&quot;_derder&quot;</span>; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ab733430ea1ac8bafd68b6709f19d1d0d">  798</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#ab733430ea1ac8bafd68b6709f19d1d0d">SpectraCo::resizeBin</a>(<span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; new_size)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;{</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> = <a class="code" href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">m_max_x</a> * (new_size/<a class="code" href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a>(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>));</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a> = new_size;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>.resize(<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>) <a class="code" href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">m_derivative</a>-&gt;<a class="code" href="class_spectra_co.html#ab733430ea1ac8bafd68b6709f19d1d0d">resizeBin</a>(new_size);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">m_integral</a> = <a class="code" href="vector__functions_8hpp.html#a2b29a4762dbbff2cabcb7e8a62cb0d39">sum</a>(<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">calculateCoeff</a>();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;}</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno"><a class="line" href="class_spectra_co.html#af27cbecc0fdfd5542e0186856bc4c4cf">  814</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a0ba318153d548c02c9ab4b39465ea1b4">SpectraCo::resizeX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; minX, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp; maxX)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;{</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="print_8hpp.html#a388f572c62279f839ee138a9afbdeeb5">print</a>(<a class="code" href="class_spectra_co.html#aed822c874938eb1f5953c6e1a412cf33">minX</a>, <a class="code" href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">maxX</a>);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a0ba318153d548c02c9ab4b39465ea1b4">  819</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_spectra_co.html#a0ba318153d548c02c9ab4b39465ea1b4">SpectraCo::resizeX</a>(<span class="keywordtype">double</span> <span class="keyword">const</span> &amp; maxX)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;{</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <a class="code" href="print_8hpp.html#a388f572c62279f839ee138a9afbdeeb5">print</a>(<a class="code" href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">maxX</a>);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="class_spectra_co.html#aa12a2fe0635e8b3e73eb47b09810f75e">  824</a></span>&#160;TH1D* <a class="code" href="class_spectra_co.html#aa12a2fe0635e8b3e73eb47b09810f75e">SpectraCo::createTH1D</a>(std::string newName, std::string newTitle)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;{</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (newName == <span class="stringliteral">&quot;&quot;</span>) newName = <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">if</span> (newTitle == <span class="stringliteral">&quot;&quot;</span>) newTitle = <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  TH1D* out = <span class="keyword">new</span> TH1D(<a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>.c_str(), <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>.c_str(), <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>, this-&gt;minX(), this-&gt;maxX());</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 1; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>+1; bin++) out-&gt;SetBinContent(bin, <a class="code" href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a>(<a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin-1]));</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <a class="code" href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">root_spectra_pointers</a>.push_back(out);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">  834</a></span>&#160;TH1F* <a class="code" href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">SpectraCo::createTH1F</a>(std::string newName, std::string newTitle)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;{</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">if</span> (newName == <span class="stringliteral">&quot;&quot;</span>) newName = <a class="code" href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">m_name</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">if</span> (newTitle == <span class="stringliteral">&quot;&quot;</span>) newTitle = <a class="code" href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">m_title</a>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  TH1F* out = <span class="keyword">new</span> TH1F(newName.c_str(), newTitle.c_str(), <a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>, this-&gt;minX(), this-&gt;maxX());</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin = 1; bin&lt;<a class="code" href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">m_size</a>; bin++) out-&gt;SetBinContent(bin, <a class="code" href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">m_spectra</a>[bin]);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <a class="code" href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">root_spectra_pointers</a>.push_back(out);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;}</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#a2db236fee001966b9a9a303b1096182b">  846</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_spectra_co_8hpp.html#a2db236fee001966b9a9a303b1096182b">goingBelow</a>(std::vector&lt;double&gt; &amp; m_spectra, <span class="keywordtype">int</span> &amp; bin, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; nb_below)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;{</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// auto const &amp; bin_max = bin+nb_below;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">for</span>(;bin&lt;<a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(m_spectra.size());bin++)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (m_spectra[bin]&lt;threshold)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="comment">// print(bin, m_spectra[bin]);</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordtype">bool</span> stay_below = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_j = bin+1; bin_j&lt;bin+nb_below; bin_j++)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">if</span> (bin_j==<a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(m_spectra.size())) <span class="keywordflow">return</span> <span class="keyword">false</span>;<span class="comment">// Bounds check</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment">// Going back to the main loop if spectra goes back above threshold :</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (m_spectra[bin_j]&gt;threshold) {bin = bin_j; stay_below = <span class="keyword">false</span>; <span class="keywordflow">break</span>;} </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">// print(stay_below);</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">if</span> (stay_below) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;}</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#ab40ef30166a4d0b3f315e6b365bb96c6">  870</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_spectra_co_8hpp.html#ab40ef30166a4d0b3f315e6b365bb96c6">goingAbove</a>(std::vector&lt;double&gt; &amp; m_spectra, <span class="keywordtype">int</span> &amp; bin, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; nb_above)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;{</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// auto const &amp; bin_max = bin+nb_above;</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">for</span>(;bin&lt;<a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(m_spectra.size());bin++)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">if</span> (m_spectra[bin]&gt;threshold)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="comment">// print(bin, m_spectra[bin]);</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordtype">bool</span> stay_above = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bin_j = bin+1; bin_j&lt;bin+nb_above; bin_j++)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">if</span> (bin_j==<a class="code" href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a>(m_spectra.size())) <span class="keywordflow">return</span> <span class="keyword">false</span>;<span class="comment">// Bounds check</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="comment">// Going back to the main loop if spectra goes back above threshold :</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">if</span> (m_spectra[bin_j]&lt;threshold) {bin = bin_j; stay_above = <span class="keyword">false</span>; <span class="keywordflow">break</span>;} </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">if</span> (stay_above) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;}</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#abdc3f87ff631c70010f12fd72339b8c8">  891</a></span>&#160;<a class="code" href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">SpectraPoint</a> <a class="code" href="_spectra_co_8hpp.html#abdc3f87ff631c70010f12fd72339b8c8">minimum_in_range</a>(std::vector&lt;double&gt; &amp; m_spectra, <span class="keywordtype">int</span> bin_min, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin_max)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;{</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <a class="code" href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">SpectraPoint</a> point;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">for</span> (;bin_min&lt;bin_max; bin_min++)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (point.second&gt;m_spectra[bin_min]) point = {bin_min, m_spectra[bin_min]};</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="_spectra_co_8hpp.html#a83ac1a487b3da916f985b967215f76a4">  901</a></span>&#160;<a class="code" href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">SpectraPoint</a> <a class="code" href="_spectra_co_8hpp.html#a83ac1a487b3da916f985b967215f76a4">maximum_in_range</a>(std::vector&lt;double&gt; &amp; m_spectra, <span class="keywordtype">int</span> bin_min, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; bin_max)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">SpectraPoint</a> point;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordflow">for</span> (;bin_min&lt;bin_max; bin_min++)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (point.second&lt;m_spectra[bin_min]) point = {bin_min, m_spectra[bin_min]};</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;}</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno"><a class="line" href="class_spectra_co.html#a3ba8c0e42ab3c3d3efa1f827b9465daf">  912</a></span>&#160;<a class="code" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">SpectraCo::findPeaks</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; nb_bins_below_threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; smooth)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;{</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  this-&gt;<a class="code" href="class_spectra_co.html#adbdfafcc8b0a95d520e491b0062b2e0b">removeBackground</a>(smooth);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  this-&gt;<a class="code" href="class_spectra_co.html#a9be3e04ddc73df4d11336ec806313094">derivate2</a>(smooth);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">findPeaks</a>(threshold, nb_bins_below_threshold);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">  926</a></span>&#160;<a class="code" href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a> <span class="keyword">const</span> &amp; <a class="code" href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">SpectraCo::findPeaks</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; threshold, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp; nb_bins_below_threshold)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;{</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>.clear();</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span> ((*m_derivative2).size()==0) {<a class="code" href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a>(<span class="stringliteral">&quot;in SpectraCo::findPeaks(int threshold, int nb_bins_below_threshold) : first use SpectraCo::derivate2&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>;}</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// Aliasing the parameters (only for the code to be more readable)</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; thres = -threshold; <span class="comment">// The second derivative spectra has peaks down</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp; nb_below = nb_bins_below_threshold;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  std::vector&lt;int&gt; bin_starts;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  std::vector&lt;int&gt; bin_stops ;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">// Iterator : starts at the left point of the spectra</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordtype">int</span> bin_it = 0;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">// If the spectra first bin is below the threshold, look for first bin above it</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">if</span> ((*<a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>)[0] &lt; thres) <a class="code" href="_spectra_co_8hpp.html#ab40ef30166a4d0b3f315e6b365bb96c6">goingAbove</a>(<a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>-&gt;<a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>(), bin_it, threshold, 1);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">// SpectraCo::goingBelow returns true when a new peak is found, and false at the end point of the spectra</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">// The function does the iterator increment (bin_it++) automatically</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">while</span>(<a class="code" href="_spectra_co_8hpp.html#a2db236fee001966b9a9a303b1096182b">goingBelow</a>(<a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>-&gt;<a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>(), bin_it, thres, nb_below))</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">// The bin iterator current value is the first bin whose value is below the threshold</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    bin_starts.push_back(bin_it);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">// SpectraCo::goingBelow returns true at the end of the peak (iterator increment (bin_it++) automatically)</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="_spectra_co_8hpp.html#ab40ef30166a4d0b3f315e6b365bb96c6">goingAbove</a>(<a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>-&gt;<a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>(), bin_it, thres, 1);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// The bin iterator current value is the first bin whose value is above the threshold</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    bin_stops.push_back(bin_it);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">// Finds the minimum point between the first bin to go below threshold and next bin to go above</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>.push_back(<a class="code" href="_spectra_co_8hpp.html#abdc3f87ff631c70010f12fd72339b8c8">minimum_in_range</a>(<a class="code" href="class_spectra_co.html#a332e26399e136100490dd879772fe797">m_derivative2</a>-&gt;<a class="code" href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">data</a>(), bin_starts.back(), bin_stops.back()));</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// Next call to SpectraCo::goingBelow will return true if the spectra goes below the threshold again</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">m_peaks</a>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;}</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">// class SpectraCo2D</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">// public:</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">//   SpectraCo2D() noexcept = default;</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">//   SpectraCo2D(std::vector&lt;SpectraCo&gt; const &amp; spectra) </span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">//     m_spectra.reserve(spectra.size());</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">//     int i = 0;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">//     for (auto const &amp; sprectrum : spectra) </span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">//       m_spectra.emplace(i, sprectrum);</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">//       m_indexes.push_back(i);</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">//     this-&gt;MAJ();</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">//   SpectraCo2D(std::map&lt;int, SpectraCo&gt; const &amp; spectra) </span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">//     m_spectra.reserve(spectra.size());</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">//     for (auto const &amp; it : spectra) </span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">//       m_spectra[it.first] = it.second;</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">//       m_indexes.push_back(it.first);</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">//     this-&gt;MAJ();</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">//   void MAJ()</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">//     for (auto const &amp; it : m_spectra)</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">//       auto const &amp; spectrum = it.second;</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">//       if (m_min_X&gt;spectrum.minX()) m_min_X = spectrum.minX();</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">//       if (m_max_X&lt;spectrum.maxX()) m_max_X = spectrum.maxX();</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">//       if (nb_bins&lt;spectrum.size()) nb_bins = spectrum.size();</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">//     // Resize all the spectra at the same size, and setup the same beginning and end</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">//     for (auto const &amp; spectrum : m_spectra)</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">//       print(spectrum);</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">//   TH2F* createTH2F(std::string const &amp; name = &quot;all_histo&quot;)</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">//     TH2F* ret (new TH2F(name.c_str(), </span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">//                 name.c_str(), m_spectra.size(), 0, m_spectra.size(), </span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">//                 nb_bins, m_min_X, m_max_X));</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">//     return ret;</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">// private:</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">//   std::vector&lt;int&gt; m_indexes;</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">//   std::unordered_map&lt;int, SpectraCo&gt; m_spectra;</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">//   double m_min_X=0;</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">//   double m_max_X=0;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">//   int nb_bins = 0;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">// };</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">// /**</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">//  * @brief TODO</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">//  * @todo this function is not working (issue at &#39;if (fine_left != 0) new_bin += fine_left * m_spectra[reader_it++];&#39;)</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">//  * @param factor </span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">//  */</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">// void SpectraCo::rebin(int const &amp; factor)</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">//   if (factor&lt;1) throw_error(&quot;in SpectraCo::rebin(int factor) : factor can&#39;t be &lt; 1&quot;);</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">//   auto const &amp; rest     = m_size % factor;</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">//   int  const &amp; new_size = m_size / factor;</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">//   std::vector&lt;double&gt; new_vector(new_size, 0); // Fills the new vector with 0</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">//   if(rest == 0) </span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">//     m_rebin*=factor; // Saves the rebin factor</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">//     for (int new_bin_it = 0; new_bin_it&lt;new_size; new_bin_it++){ </span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">//       // pauseCo(); print(new_bin_it);</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">//       for (int bin_j = 0; bin_j&lt;factor; bin_j ++){</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">//         // print(int_cast(new_bin_it * factor + bin_j), m_spectra[int_cast(new_bin_it * factor + bin_j)]);</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">//         new_vector[new_bin_it] += m_spectra[int_cast(new_bin_it * factor + bin_j)];</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">//     // print(new_vector[new_bin_it]);</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">//   else</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">//     print(&quot;Can&#39;t rebin if the factor isn&#39;t a diviser of the number of bins&quot;);</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">//     return;</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">//     m_rebin*=factor; // Saves the rebin factor</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">//     // If the rebin factor is not a divisor of the initial size,</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">//     // one has to extend a little bit each of the new bins. For instance, </span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">//     // if &#39;size = 20&#39; and &#39;factor = 3&#39; then &#39;rest = size%factor = 1&#39; and &#39;new_size = 6, </span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">//     // so there is one bin &quot;missing&quot;. To compensate, each bin will be extended </span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">//     // by &#39;extend = rest/new_size&#39;, so here &#39;1/6&#39;.</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">//     double extend = rest / new_size;</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">//     // Starts to loop over the histograms :</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">//     for (int old_bin_it = 0; old_bin_it&lt;m_size; old_bin_it++){</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">//       auto &amp; new_bin = new_vector[old_bin_it / factor]; // Create an alias</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">//       // First, calculate the actual shift for the current bin :</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">//       double const &amp; shift_left  =  old_bin_it    * extend;</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">//       double const &amp; shift_right = (old_bin_it+1) * extend;</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">//       // Then calculate the number of bins to shift :</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">//       int const &amp; bins_shift_left  = int_cast(std::trunc(shift_left));</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">//       int const &amp; bins_shift_right = int_cast(std::trunc(shift_right));</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">//       // And the &#39;fine shift&#39; (the rest of the trucation)</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">//       double const &amp; fine_left  = 1 - (shift_left  - double_cast(bins_shift_left ));</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">//       double const &amp; fine_right =      shift_right - double_cast(bins_shift_right );</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">//       // The first bin is shifted accordingly :</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">//       int reader_it = old_bin_it + bins_shift_left;</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">//       // Take the fine left shift into account, which means </span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">//       if (fine_left != 0) new_bin += fine_left * m_spectra[reader_it++];</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">//       // Calculate the stop bin :</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">//       auto const &amp; stop_bin = old_bin_it + factor + bins_shift_right;</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">//       // Read all the other bins :</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">//       for (; reader_it &lt; stop_bin; reader_it ++){</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">//         new_bin += m_spectra[reader_it];</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">//       // Take the fine right shift into account :</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">//       if (fine_right != 0) new_bin += fine_right * m_spectra[reader_it++];</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">//   }}</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">//   m_spectra = new_vector;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">//   m_size    = new_size;</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="preprocessor">#endif </span><span class="comment">//SPECTRACO_HPP</span></div>
<div class="ttc" id="a_hit_8hpp_html_ab5dd24876acad09ec52c250c1668466c"><div class="ttname"><a href="_hit_8hpp.html#ab5dd24876acad09ec52c250c1668466c">Label</a></div><div class="ttdeci">ushort Label</div><div class="ttdoc">Data types ///.</div><div class="ttdef"><b>Definition:</b> Hit.hpp:14</div></div>
<div class="ttc" id="a_recalibration_8hpp_html"><div class="ttname"><a href="_recalibration_8hpp.html">Recalibration.hpp</a></div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_a2db236fee001966b9a9a303b1096182b"><div class="ttname"><a href="_spectra_co_8hpp.html#a2db236fee001966b9a9a303b1096182b">goingBelow</a></div><div class="ttdeci">bool goingBelow(std::vector&lt; double &gt; &amp;m_spectra, int &amp;bin, int const &amp;threshold, int const &amp;nb_below)</div><div class="ttdoc">Returns the position where the histogram goes under the threshold.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:846</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_a3a08928d322f56dd109a6d6fdff241c7"><div class="ttname"><a href="_spectra_co_8hpp.html#a3a08928d322f56dd109a6d6fdff241c7">SpectraPoints</a></div><div class="ttdeci">std::vector&lt; SpectraPoint &gt; SpectraPoints</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:16</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_a43a18302ff8470bdf68a839c735e6c8e"><div class="ttname"><a href="_spectra_co_8hpp.html#a43a18302ff8470bdf68a839c735e6c8e">SpectraPoint</a></div><div class="ttdeci">std::pair&lt; int, double &gt; SpectraPoint</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:15</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_a83ac1a487b3da916f985b967215f76a4"><div class="ttname"><a href="_spectra_co_8hpp.html#a83ac1a487b3da916f985b967215f76a4">maximum_in_range</a></div><div class="ttdeci">SpectraPoint maximum_in_range(std::vector&lt; double &gt; &amp;m_spectra, int bin_min, int const &amp;bin_max)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:901</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_ab40ef30166a4d0b3f315e6b365bb96c6"><div class="ttname"><a href="_spectra_co_8hpp.html#ab40ef30166a4d0b3f315e6b365bb96c6">goingAbove</a></div><div class="ttdeci">bool goingAbove(std::vector&lt; double &gt; &amp;m_spectra, int &amp;bin, int const &amp;threshold, int const &amp;nb_above)</div><div class="ttdoc">Returns the position where the histogram goes under the threshold.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:870</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_abdc3f87ff631c70010f12fd72339b8c8"><div class="ttname"><a href="_spectra_co_8hpp.html#abdc3f87ff631c70010f12fd72339b8c8">minimum_in_range</a></div><div class="ttdeci">SpectraPoint minimum_in_range(std::vector&lt; double &gt; &amp;m_spectra, int bin_min, int const &amp;bin_max)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:891</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_aca2246688a20da3a38fe2a0f9cd74e90"><div class="ttname"><a href="_spectra_co_8hpp.html#aca2246688a20da3a38fe2a0f9cd74e90">operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;out, SpectraCo const &amp;spectra)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:421</div></div>
<div class="ttc" id="a_spectra_co_8hpp_html_ad3085c55da700fb2917875d8efe0b377"><div class="ttname"><a href="_spectra_co_8hpp.html#ad3085c55da700fb2917875d8efe0b377">type_of&lt; SpectraCo &gt;</a></div><div class="ttdeci">std::string type_of&lt; SpectraCo &gt;(SpectraCo const &amp;spectra)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:429</div></div>
<div class="ttc" id="aclass_calibration_html"><div class="ttname"><a href="class_calibration.html">Calibration</a></div><div class="ttdoc">A convenient class for handling coefficient calibration up to 3rd order.</div><div class="ttdef"><b>Definition:</b> Calibration.hpp:13</div></div>
<div class="ttc" id="aclass_calibration_html_a6044ac4a0a17e177af66138f75aca6b6"><div class="ttname"><a href="class_calibration.html#a6044ac4a0a17e177af66138f75aca6b6">Calibration::apply</a></div><div class="ttdeci">float apply(float const &amp;nrj, Label const &amp;label) const noexcept</div><div class="ttdoc">Applies the calibration coefficients of the given label to the given energy.</div><div class="ttdef"><b>Definition:</b> Calibration.hpp:178</div></div>
<div class="ttc" id="aclass_calibration_html_a91d512d3bcbc3a3439a7902326965b48"><div class="ttname"><a href="class_calibration.html#a91d512d3bcbc3a3439a7902326965b48">Calibration::order</a></div><div class="ttdeci">auto const  &amp; order(Label const &amp;label) const noexcept</div><div class="ttdoc">Get the order of the calibration (0 : linear, 1 : affine, 2 : quadratic, 3 : 3rd order)</div><div class="ttdef"><b>Definition:</b> Calibration.hpp:140</div></div>
<div class="ttc" id="aclass_my_error_html"><div class="ttname"><a href="class_my_error.html">MyError</a></div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:11</div></div>
<div class="ttc" id="aclass_my_error_html_a05198cf33bf051e16f6ec2647bf4b571"><div class="ttname"><a href="class_my_error.html#a05198cf33bf051e16f6ec2647bf4b571">MyError::MyError</a></div><div class="ttdeci">MyError(std::string const &amp;message=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:12</div></div>
<div class="ttc" id="aclass_recalibration_html"><div class="ttname"><a href="class_recalibration.html">Recalibration</a></div><div class="ttdef"><b>Definition:</b> Recalibration.hpp:6</div></div>
<div class="ttc" id="aclass_recalibration_html_a6ce90b10d69409fdbc385ba6f990e073"><div class="ttname"><a href="class_recalibration.html#a6ce90b10d69409fdbc385ba6f990e073">Recalibration::calculate</a></div><div class="ttdeci">double calculate(double const &amp;x) const</div><div class="ttdef"><b>Definition:</b> Recalibration.hpp:51</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_histo_null_html"><div class="ttname"><a href="class_spectra_co_1_1_histo_null.html">SpectraCo::HistoNull</a></div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:377</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_histo_null_html_a47f60c3e6fe497633fb72bed36224ea4"><div class="ttname"><a href="class_spectra_co_1_1_histo_null.html#a47f60c3e6fe497633fb72bed36224ea4">SpectraCo::HistoNull::HistoNull</a></div><div class="ttdeci">HistoNull()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:379</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_histo_zombie_html"><div class="ttname"><a href="class_spectra_co_1_1_histo_zombie.html">SpectraCo::HistoZombie</a></div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:383</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_histo_zombie_html_a6bec654226930402a49bf10619b2cdd6"><div class="ttname"><a href="class_spectra_co_1_1_histo_zombie.html#a6bec654226930402a49bf10619b2cdd6">SpectraCo::HistoZombie::HistoZombie</a></div><div class="ttdeci">HistoZombie()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:385</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_size_missmatch_html"><div class="ttname"><a href="class_spectra_co_1_1_size_missmatch.html">SpectraCo::SizeMissmatch</a></div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:389</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_size_missmatch_html_a42beba683555e28da7b2436ccfeb55e5"><div class="ttname"><a href="class_spectra_co_1_1_size_missmatch.html#a42beba683555e28da7b2436ccfeb55e5">SpectraCo::SizeMissmatch::SizeMissmatch</a></div><div class="ttdeci">SizeMissmatch(std::string const &amp;message)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:392</div></div>
<div class="ttc" id="aclass_spectra_co_1_1_size_missmatch_html_a94aae14f6932f29e357f42fd0132827f"><div class="ttname"><a href="class_spectra_co_1_1_size_missmatch.html#a94aae14f6932f29e357f42fd0132827f">SpectraCo::SizeMissmatch::SizeMissmatch</a></div><div class="ttdeci">SizeMissmatch()=default</div></div>
<div class="ttc" id="aclass_spectra_co_html"><div class="ttname"><a href="class_spectra_co.html">SpectraCo</a></div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:20</div></div>
<div class="ttc" id="aclass_spectra_co_html_a085a0452438dbffc3452aed6733a9103"><div class="ttname"><a href="class_spectra_co.html#a085a0452438dbffc3452aed6733a9103">SpectraCo::recalibrate</a></div><div class="ttdeci">void recalibrate(Recalibration const &amp;recal)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:563</div></div>
<div class="ttc" id="aclass_spectra_co_html_a0ba318153d548c02c9ab4b39465ea1b4"><div class="ttname"><a href="class_spectra_co.html#a0ba318153d548c02c9ab4b39465ea1b4">SpectraCo::resizeX</a></div><div class="ttdeci">void resizeX(double const &amp;maxX)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:819</div></div>
<div class="ttc" id="aclass_spectra_co_html_a136d4ce0b3d28344ef2b09bd59bd08ac"><div class="ttname"><a href="class_spectra_co.html#a136d4ce0b3d28344ef2b09bd59bd08ac">SpectraCo::m_factor</a></div><div class="ttdeci">double m_factor</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:411</div></div>
<div class="ttc" id="aclass_spectra_co_html_a1a2f7e1b1c45f16cb77d531c90c5212b"><div class="ttname"><a href="class_spectra_co.html#a1a2f7e1b1c45f16cb77d531c90c5212b">SpectraCo::firstBinWithValue</a></div><div class="ttdeci">int firstBinWithValue() const noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:267</div></div>
<div class="ttc" id="aclass_spectra_co_html_a1b66482bf4e3ff7903bda481d6d67a8d"><div class="ttname"><a href="class_spectra_co.html#a1b66482bf4e3ff7903bda481d6d67a8d">SpectraCo::lastBin</a></div><div class="ttdeci">auto const  &amp; lastBin() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:224</div></div>
<div class="ttc" id="aclass_spectra_co_html_a223f3a9be7c661c1ef700d8bfda1106f"><div class="ttname"><a href="class_spectra_co.html#a223f3a9be7c661c1ef700d8bfda1106f">SpectraCo::fill</a></div><div class="ttdeci">void fill(double const &amp;X) noexcept</div><div class="ttdoc">Fills a bin of the spectra based on the X value.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:447</div></div>
<div class="ttc" id="aclass_spectra_co_html_a244bef386237d633da441b377ca2a278"><div class="ttname"><a href="class_spectra_co.html#a244bef386237d633da441b377ca2a278">SpectraCo::maxX</a></div><div class="ttdeci">auto const  &amp; maxX() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:220</div></div>
<div class="ttc" id="aclass_spectra_co_html_a264644c4da160d7d7eed1cbaaae5a77c"><div class="ttname"><a href="class_spectra_co.html#a264644c4da160d7d7eed1cbaaae5a77c">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(SpectraCo *other, Calibration const &amp;cal, Label const &amp;label)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:140</div></div>
<div class="ttc" id="aclass_spectra_co_html_a2764c882d467992cc40a71c0e952363e"><div class="ttname"><a href="class_spectra_co.html#a2764c882d467992cc40a71c0e952363e">SpectraCo::title</a></div><div class="ttdeci">auto const  &amp; title() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:212</div></div>
<div class="ttc" id="aclass_spectra_co_html_a30feae642d436e24ff7397891030d859"><div class="ttname"><a href="class_spectra_co.html#a30feae642d436e24ff7397891030d859">SpectraCo::factor</a></div><div class="ttdeci">auto &amp; factor()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:223</div></div>
<div class="ttc" id="aclass_spectra_co_html_a332e26399e136100490dd879772fe797"><div class="ttname"><a href="class_spectra_co.html#a332e26399e136100490dd879772fe797">SpectraCo::m_derivative2</a></div><div class="ttdeci">SpectraCo * m_derivative2</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:401</div></div>
<div class="ttc" id="aclass_spectra_co_html_a34ea7496185caf2178c8ba1c10876dd3"><div class="ttname"><a href="class_spectra_co.html#a34ea7496185caf2178c8ba1c10876dd3">SpectraCo::operator*</a></div><div class="ttdeci">SpectraCo operator*(double const &amp;factor)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:521</div></div>
<div class="ttc" id="aclass_spectra_co_html_a35d8272a17e0f7bd8cb6dc7d0cd7a7e5"><div class="ttname"><a href="class_spectra_co.html#a35d8272a17e0f7bd8cb6dc7d0cd7a7e5">SpectraCo::m_max_x</a></div><div class="ttdeci">double m_max_x</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:410</div></div>
<div class="ttc" id="aclass_spectra_co_html_a3a8fdeb82862a8500d53634b5bd9acbc"><div class="ttname"><a href="class_spectra_co.html#a3a8fdeb82862a8500d53634b5bd9acbc">SpectraCo::writeTH1D</a></div><div class="ttdeci">void writeTH1D(TDirectory *directory)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:291</div></div>
<div class="ttc" id="aclass_spectra_co_html_a3e4d1435fa3a80662a8c4442464988e1"><div class="ttname"><a href="class_spectra_co.html#a3e4d1435fa3a80662a8c4442464988e1">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(SpectraCo const &amp;other, Recalibration const &amp;recal)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:98</div></div>
<div class="ttc" id="aclass_spectra_co_html_a46fdc41ee93d910d1e667c4715e8eb9e"><div class="ttname"><a href="class_spectra_co.html#a46fdc41ee93d910d1e667c4715e8eb9e">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(size_t const &amp;size)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:162</div></div>
<div class="ttc" id="aclass_spectra_co_html_a488369423915a272c24b561553cea913"><div class="ttname"><a href="class_spectra_co.html#a488369423915a272c24b561553cea913">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(SpectraCo const &amp;other, Calibration const &amp;cal, Label const &amp;label)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:126</div></div>
<div class="ttc" id="aclass_spectra_co_html_a4a6080fd25cec92c1a6295e4d8398a44"><div class="ttname"><a href="class_spectra_co.html#a4a6080fd25cec92c1a6295e4d8398a44">SpectraCo::integral</a></div><div class="ttdeci">auto &amp; integral()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:217</div></div>
<div class="ttc" id="aclass_spectra_co_html_a4bb4afaf9dd3881b73e8c6e740712a30"><div class="ttname"><a href="class_spectra_co.html#a4bb4afaf9dd3881b73e8c6e740712a30">SpectraCo::back</a></div><div class="ttdeci">auto &amp; back()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:227</div></div>
<div class="ttc" id="aclass_spectra_co_html_a4d14e86e9dd8d42c0ce5a72a2f3b7dfc"><div class="ttname"><a href="class_spectra_co.html#a4d14e86e9dd8d42c0ce5a72a2f3b7dfc">SpectraCo::get</a></div><div class="ttdeci">auto &amp; get()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:229</div></div>
<div class="ttc" id="aclass_spectra_co_html_a4e9df1dfede067a7a241e1209a01f4bc"><div class="ttname"><a href="class_spectra_co.html#a4e9df1dfede067a7a241e1209a01f4bc">SpectraCo::meanInRange</a></div><div class="ttdeci">double meanInRange(double const &amp;value_min, double const &amp;value_max) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:699</div></div>
<div class="ttc" id="aclass_spectra_co_html_a4edb2ef585474bb8c1f728d0dc7731e2"><div class="ttname"><a href="class_spectra_co.html#a4edb2ef585474bb8c1f728d0dc7731e2">SpectraCo::setActualRange</a></div><div class="ttdeci">void setActualRange()</div><div class="ttdoc">Remove the bins after the last bin with content (= detector's output max range)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:374</div></div>
<div class="ttc" id="aclass_spectra_co_html_a5219f7157190c99448c3b14ea37fbac2"><div class="ttname"><a href="class_spectra_co.html#a5219f7157190c99448c3b14ea37fbac2">SpectraCo::nb_histo_drawn</a></div><div class="ttdeci">int nb_histo_drawn</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:413</div></div>
<div class="ttc" id="aclass_spectra_co_html_a5347b79a6a914df04a1a99664fd5cc96"><div class="ttname"><a href="class_spectra_co.html#a5347b79a6a914df04a1a99664fd5cc96">SpectraCo::setMinX</a></div><div class="ttdeci">void setMinX(double const &amp;_min_x)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:202</div></div>
<div class="ttc" id="aclass_spectra_co_html_a56313f7f5ce661a5952d251e51ca3246"><div class="ttname"><a href="class_spectra_co.html#a56313f7f5ce661a5952d251e51ca3246">SpectraCo::writeTH1D</a></div><div class="ttdeci">void writeTH1D()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:290</div></div>
<div class="ttc" id="aclass_spectra_co_html_a571209e16332182019598b86d9a5e234"><div class="ttname"><a href="class_spectra_co.html#a571209e16332182019598b86d9a5e234">SpectraCo::name</a></div><div class="ttdeci">auto const  &amp; name() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:210</div></div>
<div class="ttc" id="aclass_spectra_co_html_a5c0d013692342e790580839787143f36"><div class="ttname"><a href="class_spectra_co.html#a5c0d013692342e790580839787143f36">SpectraCo::derivativeData</a></div><div class="ttdeci">std::vector&lt; double &gt; const  &amp; derivativeData()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:244</div></div>
<div class="ttc" id="aclass_spectra_co_html_a5db4e774152522eac0e1c58af984fc28"><div class="ttname"><a href="class_spectra_co.html#a5db4e774152522eac0e1c58af984fc28">SpectraCo::derivative2</a></div><div class="ttdeci">SpectraCo * derivative2()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:251</div></div>
<div class="ttc" id="aclass_spectra_co_html_a6106089e9e4295cc71f3d45f781ac2c8"><div class="ttname"><a href="class_spectra_co.html#a6106089e9e4295cc71f3d45f781ac2c8">SpectraCo::derivative2Data</a></div><div class="ttdeci">std::vector&lt; double &gt; const  &amp; derivative2Data()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:246</div></div>
<div class="ttc" id="aclass_spectra_co_html_a626908f0a27928d07d980cfcec3b8454"><div class="ttname"><a href="class_spectra_co.html#a626908f0a27928d07d980cfcec3b8454">SpectraCo::back</a></div><div class="ttdeci">auto const  &amp; back() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:226</div></div>
<div class="ttc" id="aclass_spectra_co_html_a63e44855e3e049f64759cff74aa15a52"><div class="ttname"><a href="class_spectra_co.html#a63e44855e3e049f64759cff74aa15a52">SpectraCo::name</a></div><div class="ttdeci">auto name(std::string const &amp;name)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:206</div></div>
<div class="ttc" id="aclass_spectra_co_html_a649cc895e9813d1a82c9057022228266"><div class="ttname"><a href="class_spectra_co.html#a649cc895e9813d1a82c9057022228266">SpectraCo::deleteDerivative</a></div><div class="ttdeci">void deleteDerivative()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:349</div></div>
<div class="ttc" id="aclass_spectra_co_html_a66d66744d2d12b088005a826158e2946"><div class="ttname"><a href="class_spectra_co.html#a66d66744d2d12b088005a826158e2946">SpectraCo::lastBinWithValue</a></div><div class="ttdeci">int lastBinWithValue() const noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:260</div></div>
<div class="ttc" id="aclass_spectra_co_html_a67a019827e1107bc1fc2f28eb6d854f7"><div class="ttname"><a href="class_spectra_co.html#a67a019827e1107bc1fc2f28eb6d854f7">SpectraCo::m_slope</a></div><div class="ttdeci">double m_slope</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:417</div></div>
<div class="ttc" id="aclass_spectra_co_html_a6c50f289318ed3a37218be1b2485a0aa"><div class="ttname"><a href="class_spectra_co.html#a6c50f289318ed3a37218be1b2485a0aa">SpectraCo::meanInRangeBin</a></div><div class="ttdeci">double meanInRangeBin(int const &amp;bin_min, int const &amp;bin_max) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:687</div></div>
<div class="ttc" id="aclass_spectra_co_html_a6dc41ae065225471fadc69382077ceb8"><div class="ttname"><a href="class_spectra_co.html#a6dc41ae065225471fadc69382077ceb8">SpectraCo::write</a></div><div class="ttdeci">void write()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:282</div></div>
<div class="ttc" id="aclass_spectra_co_html_a723f0ea2cd8230e4b5e94b8d07127268"><div class="ttname"><a href="class_spectra_co.html#a723f0ea2cd8230e4b5e94b8d07127268">SpectraCo::title</a></div><div class="ttdeci">auto title(std::string const &amp;title)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:207</div></div>
<div class="ttc" id="aclass_spectra_co_html_a7986a8f7ea5491f7a69ad810e857894f"><div class="ttname"><a href="class_spectra_co.html#a7986a8f7ea5491f7a69ad810e857894f">SpectraCo::integralInRange</a></div><div class="ttdeci">double integralInRange(double const &amp;value_min, double const &amp;value_max) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:677</div></div>
<div class="ttc" id="aclass_spectra_co_html_a79c602e0c90555c37098d070863134f3"><div class="ttname"><a href="class_spectra_co.html#a79c602e0c90555c37098d070863134f3">SpectraCo::rebin</a></div><div class="ttdeci">void rebin(int const &amp;factor, bool const &amp;rebin_derivatives=false)</div><div class="ttdoc">TODO.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:466</div></div>
<div class="ttc" id="aclass_spectra_co_html_a79deb54e5d5e3d36f9294482fea3d08c"><div class="ttname"><a href="class_spectra_co.html#a79deb54e5d5e3d36f9294482fea3d08c">SpectraCo::name</a></div><div class="ttdeci">auto &amp; name()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:211</div></div>
<div class="ttc" id="aclass_spectra_co_html_a7aa1ab216355e91774cbf364a7286043"><div class="ttname"><a href="class_spectra_co.html#a7aa1ab216355e91774cbf364a7286043">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(std::vector&lt; float &gt; const &amp;spectra, float const &amp;min_value=0, float const &amp;max_value=0, std::string name=&quot;&quot;, std::string title=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:43</div></div>
<div class="ttc" id="aclass_spectra_co_html_a7b935499bbdce4b84a0f640b6518765c"><div class="ttname"><a href="class_spectra_co.html#a7b935499bbdce4b84a0f640b6518765c">SpectraCo::derivate</a></div><div class="ttdeci">SpectraCo * derivate(int smooth=1) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:714</div></div>
<div class="ttc" id="aclass_spectra_co_html_a7bb27d1fe53fe342a218040f28d647ba"><div class="ttname"><a href="class_spectra_co.html#a7bb27d1fe53fe342a218040f28d647ba">SpectraCo::root_spectra_pointers</a></div><div class="ttdeci">std::vector&lt; TH1 * &gt; root_spectra_pointers</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:412</div></div>
<div class="ttc" id="aclass_spectra_co_html_a7cd88b33fa9b85c5bf2dcdd2e3d13dc2"><div class="ttname"><a href="class_spectra_co.html#a7cd88b33fa9b85c5bf2dcdd2e3d13dc2">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(TH1 *root_spectra, std::string name=&quot;&quot;, std::string title=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:170</div></div>
<div class="ttc" id="aclass_spectra_co_html_a7d0e3629ec73c41156b8c7ca71f3705e"><div class="ttname"><a href="class_spectra_co.html#a7d0e3629ec73c41156b8c7ca71f3705e">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(std::vector&lt; double &gt; const &amp;spectra, float const &amp;min_value=0, float const &amp;max_value=0, std::string name=&quot;&quot;, std::string title=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:56</div></div>
<div class="ttc" id="aclass_spectra_co_html_a80e56f3b23d5a7092dd3152f47bf3c47"><div class="ttname"><a href="class_spectra_co.html#a80e56f3b23d5a7092dd3152f47bf3c47">SpectraCo::m_intercept</a></div><div class="ttdeci">double m_intercept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:418</div></div>
<div class="ttc" id="aclass_spectra_co_html_a85342e1258a9d8877fb60fa2dca6275f"><div class="ttname"><a href="class_spectra_co.html#a85342e1258a9d8877fb60fa2dca6275f">SpectraCo::getX</a></div><div class="ttdeci">double getX(double const &amp;bin)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:309</div></div>
<div class="ttc" id="aclass_spectra_co_html_a85cee2f57fbae02a28329584da5df1b5"><div class="ttname"><a href="class_spectra_co.html#a85cee2f57fbae02a28329584da5df1b5">SpectraCo::data</a></div><div class="ttdeci">auto &amp; data()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:199</div></div>
<div class="ttc" id="aclass_spectra_co_html_a889fd42392232f574b687970fda7e311"><div class="ttname"><a href="class_spectra_co.html#a889fd42392232f574b687970fda7e311">SpectraCo::peaks</a></div><div class="ttdeci">auto &amp; peaks()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:231</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9515b65f7b587af82030316811c1c0aa"><div class="ttname"><a href="class_spectra_co.html#a9515b65f7b587af82030316811c1c0aa">SpectraCo::m_rebin</a></div><div class="ttdeci">double m_rebin</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:414</div></div>
<div class="ttc" id="aclass_spectra_co_html_a992b73363532d45debd7fd7befd21765"><div class="ttname"><a href="class_spectra_co.html#a992b73363532d45debd7fd7befd21765">SpectraCo::operator-</a></div><div class="ttdeci">SpectraCo operator-(SpectraCo const &amp;other) const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:508</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9bdfab83e4f6ad7749b69ecd0bc2a606"><div class="ttname"><a href="class_spectra_co.html#a9bdfab83e4f6ad7749b69ecd0bc2a606">SpectraCo::m_peaks</a></div><div class="ttdeci">SpectraPoints m_peaks</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:402</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9be3e04ddc73df4d11336ec806313094"><div class="ttname"><a href="class_spectra_co.html#a9be3e04ddc73df4d11336ec806313094">SpectraCo::derivate2</a></div><div class="ttdeci">SpectraCo * derivate2(int smooth=1) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:759</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9c5ae4fa536ee968b112bdab670fa2d8"><div class="ttname"><a href="class_spectra_co.html#a9c5ae4fa536ee968b112bdab670fa2d8">SpectraCo::operator*=</a></div><div class="ttdeci">SpectraCo &amp; operator*=(double const &amp;factor)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:537</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9cbf03e7634f8a80d65aec65d3d9119c"><div class="ttname"><a href="class_spectra_co.html#a9cbf03e7634f8a80d65aec65d3d9119c">SpectraCo::get</a></div><div class="ttdeci">auto const  &amp; get() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:228</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9e31bbca1885c3a48c66e7f8e2622f9a"><div class="ttname"><a href="class_spectra_co.html#a9e31bbca1885c3a48c66e7f8e2622f9a">SpectraCo::get</a></div><div class="ttdeci">auto const  &amp; get(int const &amp;bin) const noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:299</div></div>
<div class="ttc" id="aclass_spectra_co_html_a9f6fa49281669395c0e10f833f8e914e"><div class="ttname"><a href="class_spectra_co.html#a9f6fa49281669395c0e10f833f8e914e">SpectraCo::draw</a></div><div class="ttdeci">void draw(const char *param=&quot;&quot;)</div><div class="ttdoc">Creates a new TH1F to be drawn.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:454</div></div>
<div class="ttc" id="aclass_spectra_co_html_aa12a2fe0635e8b3e73eb47b09810f75e"><div class="ttname"><a href="class_spectra_co.html#aa12a2fe0635e8b3e73eb47b09810f75e">SpectraCo::createTH1D</a></div><div class="ttdeci">TH1D * createTH1D(std::string newName=&quot;&quot;, std::string newTitle=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:824</div></div>
<div class="ttc" id="aclass_spectra_co_html_aa2508fe72a91029cd85d9f6dbce5cd93"><div class="ttname"><a href="class_spectra_co.html#aa2508fe72a91029cd85d9f6dbce5cd93">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(std::vector&lt; double &gt; const &amp;_data)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:153</div></div>
<div class="ttc" id="aclass_spectra_co_html_aa2db7539ef66b96a3a4ad94fe4e0ce19"><div class="ttname"><a href="class_spectra_co.html#aa2db7539ef66b96a3a4ad94fe4e0ce19">SpectraCo::data</a></div><div class="ttdeci">auto const  &amp; data() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:198</div></div>
<div class="ttc" id="aclass_spectra_co_html_aa4225392a595ff8a0950ef67610096d0"><div class="ttname"><a href="class_spectra_co.html#aa4225392a595ff8a0950ef67610096d0">SpectraCo::operator/</a></div><div class="ttdeci">SpectraCo operator/(double const &amp;factor)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:546</div></div>
<div class="ttc" id="aclass_spectra_co_html_aa7114661992e4ae88e87cb1ccb82d6ed"><div class="ttname"><a href="class_spectra_co.html#aa7114661992e4ae88e87cb1ccb82d6ed">SpectraCo::operator+</a></div><div class="ttdeci">SpectraCo operator+(SpectraCo const &amp;other) const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:498</div></div>
<div class="ttc" id="aclass_spectra_co_html_aa9af077c307bb5e33e271bf8cbaa1741"><div class="ttname"><a href="class_spectra_co.html#aa9af077c307bb5e33e271bf8cbaa1741">SpectraCo::derivative</a></div><div class="ttdeci">SpectraCo * derivative()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:248</div></div>
<div class="ttc" id="aclass_spectra_co_html_aad2d7fb657b00304906a0c5e3c9a3aed"><div class="ttname"><a href="class_spectra_co.html#aad2d7fb657b00304906a0c5e3c9a3aed">SpectraCo::integral</a></div><div class="ttdeci">auto const  &amp; integral() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:216</div></div>
<div class="ttc" id="aclass_spectra_co_html_aae276b412dd31fc06933db96b65298fd"><div class="ttname"><a href="class_spectra_co.html#aae276b412dd31fc06933db96b65298fd">SpectraCo::operator=</a></div><div class="ttdeci">SpectraCo &amp; operator=(SpectraCo const &amp;other)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:177</div></div>
<div class="ttc" id="aclass_spectra_co_html_aaeaea4ebc4fd51825acf90e66eb89ae4"><div class="ttname"><a href="class_spectra_co.html#aaeaea4ebc4fd51825acf90e66eb89ae4">SpectraCo::maxX</a></div><div class="ttdeci">auto &amp; maxX()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:221</div></div>
<div class="ttc" id="aclass_spectra_co_html_aaee0e2be91f5b3e3958892b8389a5003"><div class="ttname"><a href="class_spectra_co.html#aaee0e2be91f5b3e3958892b8389a5003">SpectraCo::setMaxX</a></div><div class="ttdeci">void setMaxX(double const &amp;_max_x)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:203</div></div>
<div class="ttc" id="aclass_spectra_co_html_ab09637ebd15e54488eb34b5d7470e83f"><div class="ttname"><a href="class_spectra_co.html#ab09637ebd15e54488eb34b5d7470e83f">SpectraCo::createTH1F</a></div><div class="ttdeci">TH1F * createTH1F(std::string newName=&quot;&quot;, std::string newTitle=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:834</div></div>
<div class="ttc" id="aclass_spectra_co_html_ab50cbac4f854c7bf6d807fe476b1e92a"><div class="ttname"><a href="class_spectra_co.html#ab50cbac4f854c7bf6d807fe476b1e92a">SpectraCo::interpolate</a></div><div class="ttdeci">double interpolate(double const &amp;bin) const noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:644</div></div>
<div class="ttc" id="aclass_spectra_co_html_ab733430ea1ac8bafd68b6709f19d1d0d"><div class="ttname"><a href="class_spectra_co.html#ab733430ea1ac8bafd68b6709f19d1d0d">SpectraCo::resizeBin</a></div><div class="ttdeci">void resizeBin(size_t const &amp;new_size)</div><div class="ttdoc">Resize allows one to select the number of bins. Affects only the maximum bin.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:798</div></div>
<div class="ttc" id="aclass_spectra_co_html_ab75ab520b8b67a200bacd3a492179b1b"><div class="ttname"><a href="class_spectra_co.html#ab75ab520b8b67a200bacd3a492179b1b">SpectraCo::m_title</a></div><div class="ttdeci">std::string m_title</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:405</div></div>
<div class="ttc" id="aclass_spectra_co_html_aba424b38fe96dbeb3b7d69d3b10d1a21"><div class="ttname"><a href="class_spectra_co.html#aba424b38fe96dbeb3b7d69d3b10d1a21">SpectraCo::title</a></div><div class="ttdeci">auto &amp; title()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:213</div></div>
<div class="ttc" id="aclass_spectra_co_html_abb70561652a097439bbaa71fbebd70c4"><div class="ttname"><a href="class_spectra_co.html#abb70561652a097439bbaa71fbebd70c4">SpectraCo::size</a></div><div class="ttdeci">auto &amp; size()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:215</div></div>
<div class="ttc" id="aclass_spectra_co_html_abb97aec97436b5d4171015db6b47e6b4"><div class="ttname"><a href="class_spectra_co.html#abb97aec97436b5d4171015db6b47e6b4">SpectraCo::minX</a></div><div class="ttdeci">auto &amp; minX()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:219</div></div>
<div class="ttc" id="aclass_spectra_co_html_abf17675f290cad6e53ad51e59430a63c"><div class="ttname"><a href="class_spectra_co.html#abf17675f290cad6e53ad51e59430a63c">SpectraCo::integralInRangeBin</a></div><div class="ttdeci">double integralInRangeBin(int const &amp;bin_min, int const &amp;bin_max) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:670</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac010001d3601d366b0573119a5d2be2a"><div class="ttname"><a href="class_spectra_co.html#ac010001d3601d366b0573119a5d2be2a">SpectraCo::calculateCoeff</a></div><div class="ttdeci">void calculateCoeff()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:438</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac2141fbefadce3d8f82e5c7db09998ab"><div class="ttname"><a href="class_spectra_co.html#ac2141fbefadce3d8f82e5c7db09998ab">SpectraCo::setRangeX</a></div><div class="ttdeci">void setRangeX(double const &amp;_min_x, double const &amp;_max_x)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:204</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac2f903ccb1ff1079f7667e3c9f25b154"><div class="ttname"><a href="class_spectra_co.html#ac2f903ccb1ff1079f7667e3c9f25b154">SpectraCo::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:404</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac40ff3692cc98ac889886bbe16d0c337"><div class="ttname"><a href="class_spectra_co.html#ac40ff3692cc98ac889886bbe16d0c337">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(SpectraCo *other, Recalibration const &amp;recal)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:112</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac5f6afc77e5fddc79afe224dc0a1dfec"><div class="ttname"><a href="class_spectra_co.html#ac5f6afc77e5fddc79afe224dc0a1dfec">SpectraCo::getBin</a></div><div class="ttdeci">double getBin(double const &amp;x) const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:311</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac7bfa00174710c92a077113a202ba2dd"><div class="ttname"><a href="class_spectra_co.html#ac7bfa00174710c92a077113a202ba2dd">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(std::nullptr_t) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:33</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac8127b3f1b1eaf9292400cf2efa7bbde"><div class="ttname"><a href="class_spectra_co.html#ac8127b3f1b1eaf9292400cf2efa7bbde">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(SpectraCo const &amp;other, std::string name=&quot;&quot;, std::string title=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:68</div></div>
<div class="ttc" id="aclass_spectra_co_html_ac96882f321f72ffe8757493da9b5b2fa"><div class="ttname"><a href="class_spectra_co.html#ac96882f321f72ffe8757493da9b5b2fa">SpectraCo::peaks</a></div><div class="ttdeci">auto const  &amp; peaks() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:230</div></div>
<div class="ttc" id="aclass_spectra_co_html_acbe779815b224c8102ec62af4403a7d9"><div class="ttname"><a href="class_spectra_co.html#acbe779815b224c8102ec62af4403a7d9">SpectraCo::inverse</a></div><div class="ttdeci">void inverse()</div><div class="ttdoc">Inverses the spectra : negative values become positive and positive values become negative.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:258</div></div>
<div class="ttc" id="aclass_spectra_co_html_acc6765bf7da4178c376b46d8e5e6393d"><div class="ttname"><a href="class_spectra_co.html#acc6765bf7da4178c376b46d8e5e6393d">SpectraCo::factor</a></div><div class="ttdeci">auto const  &amp; factor() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:222</div></div>
<div class="ttc" id="aclass_spectra_co_html_acc6c691f3d2e5f0769d00b9d6e1ffe24"><div class="ttname"><a href="class_spectra_co.html#acc6c691f3d2e5f0769d00b9d6e1ffe24">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo() noexcept=default</div></div>
<div class="ttc" id="aclass_spectra_co_html_acdaa8ad0f11fa4c3fd7aa6eae2dacbd7"><div class="ttname"><a href="class_spectra_co.html#acdaa8ad0f11fa4c3fd7aa6eae2dacbd7">SpectraCo::m_integral</a></div><div class="ttdeci">int m_integral</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:408</div></div>
<div class="ttc" id="aclass_spectra_co_html_ad094b13ab3d8e445b04edc68a5c12ec0"><div class="ttname"><a href="class_spectra_co.html#ad094b13ab3d8e445b04edc68a5c12ec0">SpectraCo::operator=</a></div><div class="ttdeci">SpectraCo &amp; operator=(TH1 *root_spectra)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:191</div></div>
<div class="ttc" id="aclass_spectra_co_html_ad357dfc02fbb9ad6fc308ecf07f07fea"><div class="ttname"><a href="class_spectra_co.html#ad357dfc02fbb9ad6fc308ecf07f07fea">SpectraCo::load</a></div><div class="ttdeci">void load(TH1 *root_spectra)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:475</div></div>
<div class="ttc" id="aclass_spectra_co_html_ad6c387515e792a22195054cd6c174db5"><div class="ttname"><a href="class_spectra_co.html#ad6c387515e792a22195054cd6c174db5">SpectraCo::lastBin</a></div><div class="ttdeci">auto &amp; lastBin()</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:225</div></div>
<div class="ttc" id="aclass_spectra_co_html_ad6e359042f2fb5ed788c7a805ac75f77"><div class="ttname"><a href="class_spectra_co.html#ad6e359042f2fb5ed788c7a805ac75f77">SpectraCo::m_loaded_TH1</a></div><div class="ttdeci">TH1 * m_loaded_TH1</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:398</div></div>
<div class="ttc" id="aclass_spectra_co_html_ad896a521e57469c1c02c47a4e7d7349b"><div class="ttname"><a href="class_spectra_co.html#ad896a521e57469c1c02c47a4e7d7349b">SpectraCo::SpectraCo</a></div><div class="ttdeci">SpectraCo(SpectraCo *other, std::string name=&quot;&quot;, std::string title=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:83</div></div>
<div class="ttc" id="aclass_spectra_co_html_adbdfafcc8b0a95d520e491b0062b2e0b"><div class="ttname"><a href="class_spectra_co.html#adbdfafcc8b0a95d520e491b0062b2e0b">SpectraCo::removeBackground</a></div><div class="ttdeci">void removeBackground(int const &amp;smooth, std::string const &amp;fit_options=&quot;&quot;) noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:659</div></div>
<div class="ttc" id="aclass_spectra_co_html_adfe0baad93402b4ae44a6c8ea14bc137"><div class="ttname"><a href="class_spectra_co.html#adfe0baad93402b4ae44a6c8ea14bc137">SpectraCo::findPeaks</a></div><div class="ttdeci">SpectraPoints const  &amp; findPeaks(int const &amp;threshold, int const &amp;nb_bins_below_threshold)</div><div class="ttdoc">Uses the second derivative spectra to get the peaks.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:926</div></div>
<div class="ttc" id="aclass_spectra_co_html_ae05d953f1aa96c7d7077ff6dda044afd"><div class="ttname"><a href="class_spectra_co.html#ae05d953f1aa96c7d7077ff6dda044afd">SpectraCo::operator[]</a></div><div class="ttdeci">auto const  &amp; operator[](int const &amp;bin) const noexcept</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:300</div></div>
<div class="ttc" id="aclass_spectra_co_html_ae2c5c9fbc723e392cade5aabfb2d3991"><div class="ttname"><a href="class_spectra_co.html#ae2c5c9fbc723e392cade5aabfb2d3991">SpectraCo::m_size</a></div><div class="ttdeci">int m_size</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:407</div></div>
<div class="ttc" id="aclass_spectra_co_html_aecb46bfbd2968e90d0ffd6d5848ca8b4"><div class="ttname"><a href="class_spectra_co.html#aecb46bfbd2968e90d0ffd6d5848ca8b4">SpectraCo::chi2</a></div><div class="ttdeci">double chi2(SpectraCo &amp;other)</div><div class="ttdoc">Calculates the chi2 between this spectra and another one.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:354</div></div>
<div class="ttc" id="aclass_spectra_co_html_aecdb9a51ee8bab5e5fbe0563161664f9"><div class="ttname"><a href="class_spectra_co.html#aecdb9a51ee8bab5e5fbe0563161664f9">SpectraCo::write</a></div><div class="ttdeci">void write(TDirectory *directory)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:283</div></div>
<div class="ttc" id="aclass_spectra_co_html_aed822c874938eb1f5953c6e1a412cf33"><div class="ttname"><a href="class_spectra_co.html#aed822c874938eb1f5953c6e1a412cf33">SpectraCo::minX</a></div><div class="ttdeci">auto const  &amp; minX() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:218</div></div>
<div class="ttc" id="aclass_spectra_co_html_aeed13def0eec2c40ddbadbb70084e222"><div class="ttname"><a href="class_spectra_co.html#aeed13def0eec2c40ddbadbb70084e222">SpectraCo::m_min_x</a></div><div class="ttdeci">double m_min_x</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:409</div></div>
<div class="ttc" id="aclass_spectra_co_html_af202a60db2de7b7a723f9863c9616dca"><div class="ttname"><a href="class_spectra_co.html#af202a60db2de7b7a723f9863c9616dca">SpectraCo::calibrate</a></div><div class="ttdeci">void calibrate(Calibration const &amp;calib, Label const &amp;label)</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:576</div></div>
<div class="ttc" id="aclass_spectra_co_html_af40d337ee204d0ae43cc50e81c2262ef"><div class="ttname"><a href="class_spectra_co.html#af40d337ee204d0ae43cc50e81c2262ef">SpectraCo::m_derivative</a></div><div class="ttdeci">SpectraCo * m_derivative</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:400</div></div>
<div class="ttc" id="aclass_spectra_co_html_af74c78334a7be1cc421779f9e4b30a0b"><div class="ttname"><a href="class_spectra_co.html#af74c78334a7be1cc421779f9e4b30a0b">SpectraCo::calibrateAndScale</a></div><div class="ttdeci">void calibrateAndScale(std::vector&lt; double &gt; const &amp;coeffs)</div><div class="ttdoc">Calibrates using the coeffs[0:n-1] coefficient then scale it using the coeffs.back() coefficient (spe...</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:637</div></div>
<div class="ttc" id="aclass_spectra_co_html_af819f84c4dfd2a2bf9ee87809dec1159"><div class="ttname"><a href="class_spectra_co.html#af819f84c4dfd2a2bf9ee87809dec1159">SpectraCo::size</a></div><div class="ttdeci">auto const  &amp; size() const</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:214</div></div>
<div class="ttc" id="aclass_spectra_co_html_afaf3a8b0918de26d2c37392c0bc853a4"><div class="ttname"><a href="class_spectra_co.html#afaf3a8b0918de26d2c37392c0bc853a4">SpectraCo::m_spectra</a></div><div class="ttdeci">std::vector&lt; double &gt; m_spectra</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:399</div></div>
<div class="ttc" id="aclass_spectra_co_html_afdfa3e10eda4e3513674dddcd32ae7e6"><div class="ttname"><a href="class_spectra_co.html#afdfa3e10eda4e3513674dddcd32ae7e6">SpectraCo::calibrateX</a></div><div class="ttdeci">void calibrateX(double const &amp;intercept, double const &amp;slope=1)</div><div class="ttdoc">First order calibration.</div><div class="ttdef"><b>Definition:</b> SpectraCo.hpp:318</div></div>
<div class="ttc" id="alib_co_8hpp_html_a2052317e56aa118e7ffcdb2e398f551c"><div class="ttname"><a href="lib_co_8hpp.html#a2052317e56aa118e7ffcdb2e398f551c">double_cast</a></div><div class="ttdeci">double double_cast(T const &amp;t)</div><div class="ttdoc">Casts a number into an double.</div><div class="ttdef"><b>Definition:</b> libCo.hpp:221</div></div>
<div class="ttc" id="alib_co_8hpp_html_a48e80fbfd11f9fb219b92ba1c29c1b2a"><div class="ttname"><a href="lib_co_8hpp.html#a48e80fbfd11f9fb219b92ba1c29c1b2a">int_cast</a></div><div class="ttdeci">int int_cast(T const &amp;t)</div><div class="ttdoc">Casts a number into an int.</div><div class="ttdef"><b>Definition:</b> libCo.hpp:209</div></div>
<div class="ttc" id="alib_co_8hpp_html_a6df2dcd4b1f61c75dc292942bc5ca74d"><div class="ttname"><a href="lib_co_8hpp.html#a6df2dcd4b1f61c75dc292942bc5ca74d">throw_error</a></div><div class="ttdeci">void throw_error(std::string const &amp;message)</div><div class="ttdef"><b>Definition:</b> libCo.hpp:156</div></div>
<div class="ttc" id="anamespace_co_analyse_html_afa2d6e36c43655ace45e8aa55a53d4da"><div class="ttname"><a href="namespace_co_analyse.html#afa2d6e36c43655ace45e8aa55a53d4da">CoAnalyse::removeBackground</a></div><div class="ttdeci">void removeBackground(TH1 *histo, int const &amp;niter=10, std::string const &amp;fit_options=&quot;&quot;, std::string const &amp;bidim_options=&quot;X&quot;) noexcept</div><div class="ttdoc">Remove the background in the given histo.</div><div class="ttdef"><b>Definition:</b> libRoot.hpp:1015</div></div>
<div class="ttc" id="anamespace_co_bazar_html_a030309d1b093093b5fd48a5f7734018e"><div class="ttname"><a href="namespace_co_bazar.html#a030309d1b093093b5fd48a5f7734018e">CoBazar::mean</a></div><div class="ttdeci">double mean(ARGS... args)</div><div class="ttdef"><b>Definition:</b> libCo.hpp:470</div></div>
<div class="ttc" id="aprint_8hpp_html_a388f572c62279f839ee138a9afbdeeb5"><div class="ttname"><a href="print_8hpp.html#a388f572c62279f839ee138a9afbdeeb5">print</a></div><div class="ttdeci">void print()</div><div class="ttdoc">New line.</div><div class="ttdef"><b>Definition:</b> print.hpp:44</div></div>
<div class="ttc" id="aprint_8hpp_html_a553a9a331cc4556c2d9bb3aaa8533528"><div class="ttname"><a href="print_8hpp.html#a553a9a331cc4556c2d9bb3aaa8533528">error</a></div><div class="ttdeci">void error(T const &amp;... t)</div><div class="ttdoc">Print in red.</div><div class="ttdef"><b>Definition:</b> print.hpp:176</div></div>
<div class="ttc" id="aprint_8hpp_html_a8d23feea868a983c8c2b661e1e16972f"><div class="ttname"><a href="print_8hpp.html#a8d23feea868a983c8c2b661e1e16972f">RED</a></div><div class="ttdeci">#define RED</div><div class="ttdef"><b>Definition:</b> print.hpp:22</div></div>
<div class="ttc" id="aprint_8hpp_html_a90460287027986fbf0c9a1ef8e5a1bce"><div class="ttname"><a href="print_8hpp.html#a90460287027986fbf0c9a1ef8e5a1bce">type_of</a></div><div class="ttdeci">std::string type_of(T const &amp;t)</div><div class="ttdef"><b>Definition:</b> print.hpp:159</div></div>
<div class="ttc" id="aprint_8hpp_html_ab702106cf3b3e96750b6845ded4e0299"><div class="ttname"><a href="print_8hpp.html#ab702106cf3b3e96750b6845ded4e0299">RESET</a></div><div class="ttdeci">#define RESET</div><div class="ttdef"><b>Definition:</b> print.hpp:19</div></div>
<div class="ttc" id="aprint_8hpp_html_ad9e2dd512a5915af4751a40fefbfbc94"><div class="ttname"><a href="print_8hpp.html#ad9e2dd512a5915af4751a40fefbfbc94">warning</a></div><div class="ttdeci">void warning(T const &amp;... t)</div><div class="ttdoc">Print in bright black.</div><div class="ttdef"><b>Definition:</b> print.hpp:167</div></div>
<div class="ttc" id="aprint_8hpp_html_adce122f566c88a1eceeb79a635afa964"><div class="ttname"><a href="print_8hpp.html#adce122f566c88a1eceeb79a635afa964">GREY</a></div><div class="ttdeci">#define GREY</div><div class="ttdef"><b>Definition:</b> print.hpp:39</div></div>
<div class="ttc" id="aprint_8hpp_html_afded2b178f1cba7246c86beaab6d4e6c"><div class="ttname"><a href="print_8hpp.html#afded2b178f1cba7246c86beaab6d4e6c">printC</a></div><div class="ttdeci">void printC(T const &amp;t)</div><div class="ttdoc">Generic print concatenated.</div><div class="ttdef"><b>Definition:</b> print.hpp:60</div></div>
<div class="ttc" id="astring__functions_8hpp_html_a3a78dc61d5d352a6559b927ae3167a21"><div class="ttname"><a href="string__functions_8hpp.html#a3a78dc61d5d352a6559b927ae3167a21">replace</a></div><div class="ttdeci">bool replace(std::string &amp;string, std::string const &amp;substr_init, std::string const &amp;substr_substitue)</div><div class="ttdoc">Replace substr to the string if it exists.</div><div class="ttdef"><b>Definition:</b> string_functions.hpp:169</div></div>
<div class="ttc" id="astring__functions_8hpp_html_ae058d07fbc702d0b0f79e3650e7804a2"><div class="ttname"><a href="string__functions_8hpp.html#ae058d07fbc702d0b0f79e3650e7804a2">concatenate</a></div><div class="ttdeci">std::string concatenate(ARGS &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> string_functions.hpp:240</div></div>
<div class="ttc" id="avector__functions_8hpp_html_a2b29a4762dbbff2cabcb7e8a62cb0d39"><div class="ttname"><a href="vector__functions_8hpp.html#a2b29a4762dbbff2cabcb7e8a62cb0d39">sum</a></div><div class="ttdeci">T sum(std::vector&lt; T &gt; const &amp;source)</div><div class="ttdef"><b>Definition:</b> vector_functions.hpp:14</div></div>
<div class="ttc" id="avector__functions_8hpp_html_a629f2e4117a0bb1dada5aa3a4fad4765"><div class="ttname"><a href="vector__functions_8hpp.html#a629f2e4117a0bb1dada5aa3a4fad4765">sub_vec</a></div><div class="ttdeci">auto sub_vec(std::vector&lt; T &gt; const &amp;vec, int const &amp;start, int const &amp;length)</div><div class="ttdoc">Returns the vector in the range [start, start+length[.</div><div class="ttdef"><b>Definition:</b> vector_functions.hpp:246</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_7c4907a2a5f1a0aabf4fb26dde5b883c.html">Analyse</a></li><li class="navelem"><a class="el" href="_spectra_co_8hpp.html">SpectraCo.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
