<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="_clovers_8hpp" kind="file" language="C++">
    <compoundname>Clovers.hpp</compoundname>
    <includes refid="lib_root_8hpp" local="yes">../libRoot.hpp</includes>
    <includes refid="_event_8hpp" local="yes">../Classes/Event.hpp</includes>
    <includes refid="_gate_8hpp" local="yes">../Classes/Gate.hpp</includes>
    <includes refid="_m_t_object_8hpp" local="yes">../MTObjects/MTObject.hpp</includes>
    <includes refid="_clover_module_8hpp" local="yes">CloverModule.hpp</includes>
    <includedby refid="_event_analyse_8hpp" local="yes">lib/Analyse/EventAnalyse.hpp</includedby>
    <includedby refid="_sorted___event_8hpp" local="no">lib/Analyse/Sorted_Event.hpp</includedby>
    <includedby refid="_clover_spectra_8hpp" local="yes">lib/Modules/CloverSpectra.hpp</includedby>
    <includedby refid="_run_matrixator_8hpp" local="yes">lib/Modules/RunMatrixator.hpp</includedby>
    <incdepgraph>
      <node id="20">
        <label>glob.h</label>
      </node>
      <node id="52">
        <label>TH1S.h</label>
      </node>
      <node id="25">
        <label>functional</label>
      </node>
      <node id="6">
        <label>iomanip</label>
      </node>
      <node id="29">
        <label>queue</label>
      </node>
      <node id="70">
        <label>TTreeIndex.h</label>
      </node>
      <node id="2">
        <label>../libRoot.hpp</label>
        <link refid="lib_root_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="60" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="65" relation="include">
        </childnode>
        <childnode refid="66" relation="include">
        </childnode>
        <childnode refid="67" relation="include">
        </childnode>
        <childnode refid="68" relation="include">
        </childnode>
        <childnode refid="69" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>filesystem</label>
      </node>
      <node id="39">
        <label>TAxis.h</label>
      </node>
      <node id="68">
        <label>TThread.h</label>
      </node>
      <node id="22">
        <label>errors.hpp</label>
        <link refid="errors_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="73">
        <label>../Classes/Gate.hpp</label>
        <link refid="_gate_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="76">
        <label>CloverModule.hpp</label>
        <link refid="_clover_module_8hpp"/>
      </node>
      <node id="51">
        <label>TH1D.h</label>
      </node>
      <node id="64">
        <label>TStopwatch.h</label>
      </node>
      <node id="30">
        <label>stdexcept</label>
      </node>
      <node id="28">
        <label>numeric</label>
      </node>
      <node id="15">
        <label>string</label>
      </node>
      <node id="8">
        <label>map</label>
      </node>
      <node id="72">
        <label>Hit.hpp</label>
        <link refid="_hit_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>libCo.hpp</label>
        <link refid="lib_co_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
      </node>
      <node id="43">
        <label>TF1.h</label>
      </node>
      <node id="4">
        <label>print.hpp</label>
        <link refid="print_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>fstream</label>
      </node>
      <node id="1">
        <label>lib/Analyse/Clovers.hpp</label>
        <link refid="_clovers_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="71" relation="include">
        </childnode>
        <childnode refid="73" relation="include">
        </childnode>
        <childnode refid="74" relation="include">
        </childnode>
        <childnode refid="76" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>TError.h</label>
      </node>
      <node id="66">
        <label>TStyle.h</label>
      </node>
      <node id="23">
        <label>any</label>
      </node>
      <node id="17">
        <label>files_functions.hpp</label>
        <link refid="files__functions_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>random</label>
      </node>
      <node id="62">
        <label>TROOT.h</label>
      </node>
      <node id="34">
        <label>typeinfo</label>
      </node>
      <node id="75">
        <label>future</label>
      </node>
      <node id="38">
        <label>ctime</label>
      </node>
      <node id="41">
        <label>TChain.h</label>
      </node>
      <node id="71">
        <label>../Classes/Event.hpp</label>
        <link refid="_event_8hpp"/>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="67">
        <label>TSystem.h</label>
      </node>
      <node id="31">
        <label>stack</label>
      </node>
      <node id="7">
        <label>vector</label>
      </node>
      <node id="44">
        <label>TF2.h</label>
      </node>
      <node id="45">
        <label>TFile.h</label>
      </node>
      <node id="40">
        <label>TCanvas.h</label>
      </node>
      <node id="55">
        <label>TH3I.h</label>
      </node>
      <node id="56">
        <label>TKey.h</label>
      </node>
      <node id="9">
        <label>vector_functions.hpp</label>
        <link refid="vector__functions_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="63">
        <label>TSpectrum.h</label>
      </node>
      <node id="24">
        <label>array</label>
      </node>
      <node id="47">
        <label>TFitResult.h</label>
      </node>
      <node id="16">
        <label>sstream</label>
      </node>
      <node id="11">
        <label>randomCo.hpp</label>
        <link refid="random_co_8hpp"/>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="59">
        <label>TMarker.h</label>
      </node>
      <node id="49">
        <label>TGraphErrors.h</label>
      </node>
      <node id="53">
        <label>TH2.h</label>
      </node>
      <node id="37">
        <label>cstdlib</label>
      </node>
      <node id="50">
        <label>TH1F.h</label>
      </node>
      <node id="57">
        <label>TLeaf.h</label>
      </node>
      <node id="5">
        <label>iostream</label>
      </node>
      <node id="13">
        <label>string_functions.hpp</label>
        <link refid="string__functions_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>unordered_map</label>
      </node>
      <node id="58">
        <label>TLegend.h</label>
      </node>
      <node id="65">
        <label>TString.h</label>
      </node>
      <node id="60">
        <label>TMath.h</label>
      </node>
      <node id="54">
        <label>TH2F.h</label>
      </node>
      <node id="27">
        <label>mutex</label>
      </node>
      <node id="36">
        <label>csignal</label>
      </node>
      <node id="74">
        <label>../MTObjects/MTObject.hpp</label>
        <link refid="_m_t_object_8hpp"/>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="75" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
        <childnode refid="68" relation="include">
        </childnode>
      </node>
      <node id="32">
        <label>thread</label>
      </node>
      <node id="61">
        <label>TRandom.h</label>
      </node>
      <node id="69">
        <label>TTree.h</label>
      </node>
      <node id="10">
        <label>algorithm</label>
      </node>
      <node id="46">
        <label>TFitResultPtr.h</label>
      </node>
      <node id="14">
        <label>cstring</label>
      </node>
      <node id="48">
        <label>TGraph.h</label>
      </node>
      <node id="26">
        <label>memory</label>
      </node>
      <node id="33">
        <label>typeindex</label>
      </node>
      <node id="18">
        <label>dirent.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="2">
        <label>lib/Analyse/EventAnalyse.hpp</label>
        <link refid="_event_analyse_8hpp"/>
      </node>
      <node id="1">
        <label>lib/Analyse/Clovers.hpp</label>
        <link refid="_clovers_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>lib/Modules/CloverSpectra.hpp</label>
        <link refid="_clover_spectra_8hpp"/>
      </node>
      <node id="3">
        <label>lib/Analyse/Sorted_Event.hpp</label>
        <link refid="_sorted___event_8hpp"/>
      </node>
      <node id="5">
        <label>lib/Modules/RunMatrixator.hpp</label>
        <link refid="_run_matrixator_8hpp"/>
      </node>
    </invincdepgraph>
    <innerclass refid="class_clovers" prot="public">Clovers</innerclass>
    <innerclass refid="class_clovers_1_1_delayed_gate" prot="public">Clovers::DelayedGate</innerclass>
    <innerclass refid="class_clovers_1_1_prompt_gate" prot="public">Clovers::PromptGate</innerclass>
      <sectiondef kind="func">
      <memberdef kind="function" id="_clovers_8hpp_1a25cc9a6adf9227586fe9e4ef23928011" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>std::ostream &amp;</type>
        <definition>std::ostream&amp; operator&lt;&lt;</definition>
        <argsstring>(std::ostream &amp;cout, Clovers const &amp;clovers)</argsstring>
        <name>operator&lt;&lt;</name>
        <param>
          <type>std::ostream &amp;</type>
          <declname>cout</declname>
        </param>
        <param>
          <type><ref refid="class_clovers" kindref="compound">Clovers</ref> const &amp;</type>
          <declname>clovers</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="lib/Analyse/Clovers.hpp" line="691" column="1" bodyfile="lib/Analyse/Clovers.hpp" bodystart="691" bodyend="699"/>
        <references refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" compoundref="_clovers_8hpp" startline="203">Clovers::Hits</references>
        <references refid="print_8hpp_1a388f572c62279f839ee138a9afbdeeb5" compoundref="print_8hpp" startline="44" endline="44">print</references>
        <references refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" compoundref="vector__functions_8hpp" startline="441" endline="441">StaticVector&lt; T &gt;::size</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>CLOVERS_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CLOVERS_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../libRoot.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/>#include<sp/>&quot;../Classes/Detectors.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Classes/Event.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Classes/Gate.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../MTObjects/MTObject.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_clover_module_8hpp" kindref="compound">CloverModule.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//<sp/>std::array&lt;float,<sp/>48&gt;<sp/>BGO_coeff<sp/>=<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.1747f,<sp/>1.2617f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.2617f,<sp/>1.2342f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="comment">//<sp/>0.1729f,<sp/>0.51f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.0199f,<sp/>0.9358f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.f,<sp/><sp/><sp/><sp/><sp/>1.f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.1181f,<sp/>1.1801f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.3342f,<sp/>1.3590f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.3482f,<sp/>1.3885f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.3102f,<sp/>1.f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.1967f,<sp/>1.1640f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.02f,<sp/><sp/><sp/>1.0179f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.0471f,<sp/>1.0690f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.4394f,<sp/>1.3663f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.0078f,<sp/>0.9845f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.3204f,<sp/>1.0872f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.0849f,<sp/>1.02f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.4811f,<sp/>1.3626f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.2433f,<sp/>1.2283f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.1132f,<sp/>1.1355f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.1157f,<sp/>1.1280f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.3810f,<sp/>1.3002f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.f,1.f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.f,1.f,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.f,1.f</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="comment">//<sp/>};</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="70" refid="class_clovers" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_clovers" kindref="compound">Clovers</ref></highlight></codeline>
<codeline lineno="71"><highlight class="normal">{</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>________________________________________________________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>------------------<sp/><sp/>Setting<sp/>the<sp/>lookup<sp/>tables<sp/>------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>There<sp/>are<sp/>different<sp/>sets<sp/>of<sp/>labels<sp/>and<sp/>index.<sp/>In<sp/>the<sp/>following<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>label<sp/>is<sp/>the<sp/>raw<sp/>detector<sp/>label<sp/>as<sp/>declared<sp/>in<sp/>faster<sp/>and<sp/>index_1**.0at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>Ge<sp/><sp/>crystal<sp/>index<sp/>ranges<sp/>from<sp/>0<sp/>to<sp/>95<sp/>and<sp/>is<sp/>then<sp/>used<sp/>for<sp/>angles<sp/>and<sp/>visualisation<sp/>purposes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>BGO<sp/>crystal<sp/>index<sp/>ranges<sp/>from<sp/>0<sp/>to<sp/>47<sp/>and<sp/>&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="80" refid="class_clovers_1a4ff3a807d72cc3c8e51e10d96184f0a6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>constexpr<sp/><ref refid="class_clovers_1a4ff3a807d72cc3c8e51e10d96184f0a6" kindref="member">nb_det</ref><sp/>=<sp/>1000;<sp/></highlight><highlight class="comment">//<sp/>This<sp/>refers<sp/>to<sp/>the<sp/>total<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82" refid="class_clovers_1a9c28e72706c325a4fe3b0aab61c0bfe0" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a9c28e72706c325a4fe3b0aab61c0bfe0" kindref="member">is_clover</ref>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>l)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/>(l&gt;22<sp/>&amp;&amp;<sp/>l&lt;167);}</highlight></codeline>
<codeline lineno="83" refid="class_clovers_1a434508059d1a1f8e1c31dc793505cdc7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a434508059d1a1f8e1c31dc793505cdc7" kindref="member">is_clover_Ge</ref><sp/><sp/>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>l)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="class_clovers_1a9c28e72706c325a4fe3b0aab61c0bfe0" kindref="member">is_clover</ref>(l))<sp/>?<sp/>((l-23)%6<sp/>&gt;<sp/>2)<sp/>:<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);}</highlight></codeline>
<codeline lineno="84" refid="class_clovers_1a4940a14c796f0825697af29156644e9c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a4940a14c796f0825697af29156644e9c" kindref="member">is_clover_BGO</ref><sp/>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>l)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="class_clovers_1a9c28e72706c325a4fe3b0aab61c0bfe0" kindref="member">is_clover</ref>(l))<sp/>?<sp/>((l-23)%6<sp/>&lt;<sp/>3)<sp/>:<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Correspondance<sp/>between<sp/>detector<sp/>label<sp/>and<sp/>crystal<sp/>index<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="class_clovers_1a9b2bcd83b6884936745b06346b121b73" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1a9b2bcd83b6884936745b06346b121b73" kindref="member">label_to_clover</ref><sp/><sp/><sp/>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>l)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal"><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref></highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">((l-23)/6);}<sp/></highlight><highlight class="comment">//<sp/>Ranges<sp/>from<sp/>0<sp/>to<sp/>23</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1ad047177f1403bb65359a6ad07ba4473a" kindref="member">label_to_cristal</ref><sp/><sp/>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>l);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::array&lt;bool,<sp/>nb_det&gt;<sp/><ref refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" kindref="member">isClover</ref>;<sp/></highlight><highlight class="comment">//<sp/>Array<sp/>used<sp/>to<sp/>know<sp/>if<sp/>a<sp/>given<sp/>detector<sp/>is<sp/>a<sp/>clover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::array&lt;bool,<sp/>nb_det&gt;<sp/><ref refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" kindref="member">isGe</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Array<sp/>used<sp/>to<sp/>know<sp/>if<sp/>a<sp/>given<sp/>detector<sp/>is<sp/>a<sp/>Germanium<sp/>clover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="class_clovers_1ab911b0e211d1222b38039f0d23018754" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::array&lt;bool,<sp/>nb_det&gt;<sp/><ref refid="class_clovers_1ab911b0e211d1222b38039f0d23018754" kindref="member">isBGO</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Array<sp/>used<sp/>to<sp/>know<sp/>if<sp/>a<sp/>given<sp/>detector<sp/>is<sp/>a<sp/>BGO<sp/>clover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>static<sp/>std::array&lt;bool,<sp/>nb_det&gt;<sp/>blacklist;//<sp/>Array<sp/>used<sp/>to<sp/>know<sp/>if<sp/>a<sp/>given<sp/>detector<sp/>is<sp/>in<sp/>the<sp/>blacklist</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="class_clovers_1a159566fba0cdaa0508d8049c12b7626c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::array&lt;uchar,<sp/>nb_det&gt;<sp/><ref refid="class_clovers_1a159566fba0cdaa0508d8049c12b7626c" kindref="member">labels</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>Array<sp/>used<sp/>to<sp/>make<sp/>correspondance<sp/>between<sp/>a<sp/>detector<sp/>label<sp/>and<sp/>its<sp/>clover<sp/>label</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="class_clovers_1aaf1a13c67031efd703a4001cdc6df402" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::array&lt;uchar,<sp/>nb_det&gt;<sp/><ref refid="class_clovers_1aaf1a13c67031efd703a4001cdc6df402" kindref="member">cristaux_index</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Array<sp/>used<sp/>to<sp/>make<sp/>correspondance<sp/>between<sp/>the<sp/>detector<sp/>label<sp/>and<sp/>the<sp/>Ge<sp/>or<sp/>BGO<sp/>index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98" refid="class_clovers_1abbd356b154fa2369acffc83cca9a6204" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::array&lt;uchar,<sp/>nb_det&gt;<sp/><ref refid="class_clovers_1abbd356b154fa2369acffc83cca9a6204" kindref="member">cristaux_index_BGO</ref>;<sp/></highlight><highlight class="comment">//<sp/>Array<sp/>used<sp/>to<sp/>make<sp/>correspondance<sp/>between<sp/>the<sp/>detector<sp/>label<sp/>and<sp/>the<sp/>BGO<sp/>index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>static<sp/>std::vector<sp/>&lt;uchar&gt;<sp/>cristaux_opposite;//<sp/>Array<sp/>used<sp/>to<sp/>make<sp/>correspondance<sp/>between<sp/>a<sp/>detector<sp/>and<sp/>the<sp/>label<sp/>of<sp/>the<sp/>detector<sp/>at<sp/>180Â°<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="class_clovers_1aaeeef6197466b4fb5e445e5742bdf6c7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1aaeeef6197466b4fb5e445e5742bdf6c7" kindref="member">InitialiseArrays</ref>()</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#ifdef<sp/>MULTITHREADING</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_m_t_object_8hpp_1a225f8aadf270f4a69ad323e64b7eaa33" kindref="member">lock_mutex</ref><sp/>lock(<ref refid="class_m_t_object_1a79d86fbc8837ba0f9a4cd1405fddef1c" kindref="member">MTObject::mutex</ref>);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#endif<sp/></highlight><highlight class="comment">//MULTITHREADING</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_clovers_1a8ab8ca513d60be7c305ca022e83c96b2" kindref="member">s_initialised</ref>)</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>debug(&quot;Initialising<sp/>clovers<sp/>arrays&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/>l<sp/>=<sp/>0;<sp/>l&lt;<ref refid="class_clovers_1a4ff3a807d72cc3c8e51e10d96184f0a6" kindref="member">nb_det</ref>;<sp/>l++)</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" kindref="member">isClover</ref>[l]<sp/>=<sp/><ref refid="class_clovers_1a9c28e72706c325a4fe3b0aab61c0bfe0" kindref="member">is_clover</ref>(l);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" kindref="member">isGe</ref>[l]<sp/>=<sp/><ref refid="class_clovers_1a434508059d1a1f8e1c31dc793505cdc7" kindref="member">is_clover_Ge</ref>(l);<sp/><sp/></highlight><highlight class="comment">//<sp/>Already<sp/>exist<sp/>in<sp/>libCo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ab911b0e211d1222b38039f0d23018754" kindref="member">isBGO</ref>[l]<sp/>=<sp/><ref refid="class_clovers_1a4940a14c796f0825697af29156644e9c" kindref="member">is_clover_BGO</ref>(l);</highlight><highlight class="comment">//<sp/>Already<sp/>exist<sp/>in<sp/>libCo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a159566fba0cdaa0508d8049c12b7626c" kindref="member">labels</ref>[l]<sp/>=<sp/>(<ref refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" kindref="member">isClover</ref>[l])<sp/>?<sp/><ref refid="class_clovers_1a9b2bcd83b6884936745b06346b121b73" kindref="member">label_to_clover</ref>(l)<sp/>:<sp/>-1;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1aaf1a13c67031efd703a4001cdc6df402" kindref="member">cristaux_index</ref>[l]<sp/>=<sp/>(<ref refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" kindref="member">isGe</ref>[l])<sp/>?<sp/><ref refid="class_clovers_1ad047177f1403bb65359a6ad07ba4473a" kindref="member">label_to_cristal</ref>(l)<sp/>:<sp/>-1;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1abbd356b154fa2369acffc83cca9a6204" kindref="member">cristaux_index_BGO</ref>[l]<sp/>=<sp/>(<ref refid="class_clovers_1ab911b0e211d1222b38039f0d23018754" kindref="member">isBGO</ref>[l])<sp/>?<sp/><ref refid="class_clovers_1ad047177f1403bb65359a6ad07ba4473a" kindref="member">label_to_cristal</ref>(l)<sp/>:<sp/>-1;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a8ab8ca513d60be7c305ca022e83c96b2" kindref="member">s_initialised</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>----------------------<sp/><sp/>End<sp/>lookup<sp/>tables<sp/>----------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>________________________________________________________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>_______________________________________________________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>-----------------------<sp/><sp/>Set<sp/>parameters<sp/>-----------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="class_clovers_1a2fd19fb7d2b6a38d651a179deda4c3c5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a2fd19fb7d2b6a38d651a179deda4c3c5" kindref="member">Emin</ref>;</highlight></codeline>
<codeline lineno="130" refid="class_clovers_1abe608be3faec9a16f7735dfcaabfe775" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1abe608be3faec9a16f7735dfcaabfe775" kindref="member">setEnergyThreshold</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>emin)<sp/>{<ref refid="class_clovers_1a2fd19fb7d2b6a38d651a179deda4c3c5" kindref="member">Emin</ref>=emin;}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>-----------------------<sp/><sp/>End<sp/>parameters<sp/>-----------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>_______________________________________________________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>_______________________________________________________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>-----------------------<sp/><sp/>Clovers<sp/>Class<sp/><sp/>-----------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="class_clovers_1addcd7785b41aec6be8988166a5b04fa0" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1addcd7785b41aec6be8988166a5b04fa0" kindref="member">Clovers</ref>()</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1aaeeef6197466b4fb5e445e5742bdf6c7" kindref="member">InitialiseArrays</ref>();<sp/></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>.resize(24);<sp/></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clover_module_1afbff08fa0ebf248267295197f33cbd4b" kindref="member">CloverModule::resetGlobalLabel</ref>();</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ac0eb8a13e2f9f4da36b976a6aa78a8ab" kindref="member">PromptClovers</ref>.resize(24);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clover_module_1afbff08fa0ebf248267295197f33cbd4b" kindref="member">CloverModule::resetGlobalLabel</ref>();</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1accd03b8ba441c066df69dfda4419d29e" kindref="member">DelayedClovers</ref>.resize(24);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a60b7747d54a60759b4eae02deac50f95" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a10afb56c3c4311007df55386dacba543" kindref="member">CleanFast</ref>();</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a264432ef7231d65b77e744858374b8e1" kindref="member">SetEvent</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a264432ef7231d65b77e744858374b8e1" kindref="member">SetEvent</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>analyse_mode);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ab1394e718791a5016aa3e0a19828465c" kindref="member">Fill</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a60b7747d54a60759b4eae02deac50f95" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//_______________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>------<sp/>Cristals<sp/>------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>the<sp/>following,<sp/>the<sp/>containers<sp/>are<sp/>by<sp/>default<sp/>for<sp/>Germaniums<sp/>crystals</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>To<sp/>get<sp/>the<sp/>BGO<sp/>containers,<sp/>_BGO<sp/>is<sp/>added<sp/>after</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Ge<sp/>Crystals<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160" refid="class_clovers_1a2cd5ef2adb5347f86d677a6ee78b0cf2" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a2cd5ef2adb5347f86d677a6ee78b0cf2" kindref="member">cristaux</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(96);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>indexes<sp/>of<sp/>Ge<sp/>crystals<sp/>in<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161" refid="class_clovers_1a75da7859463f1478187c7f3f13d5f5d7" refkind="member"><highlight class="normal"><sp/><sp/>std::array&lt;float,<sp/>96&gt;<sp/><sp/><sp/><ref refid="class_clovers_1a75da7859463f1478187c7f3f13d5f5d7" kindref="member">cristaux_nrj</ref><sp/>=<sp/>{0};<sp/></highlight><highlight class="comment">//<sp/>Array<sp/>containing<sp/>the<sp/>energy<sp/>of<sp/>each<sp/>Ge<sp/><sp/>cristal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162" refid="class_clovers_1a9b7473b93b1fd7b6330070f1611a42e1" refkind="member"><highlight class="normal"><sp/><sp/>std::array&lt;double,<sp/>96&gt;<sp/><sp/><ref refid="class_clovers_1a9b7473b93b1fd7b6330070f1611a42e1" kindref="member">cristaux_time</ref><sp/>=<sp/>{0};</highlight><highlight class="comment">//<sp/>Array<sp/>containing<sp/>the<sp/>time<sp/>of<sp/>each<sp/>Ge<sp/><sp/>cristal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164" refid="class_clovers_1a079d8274f7810d7ee0da013ccdfc759c" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1a079d8274f7810d7ee0da013ccdfc759c" kindref="member">CrystalMult</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">//<sp/>Ge<sp/>crystals<sp/>counter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>BGO<sp/>Crystals<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167" refid="class_clovers_1abf3ac879188806ad38a0ebe7c0946ce9" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1abf3ac879188806ad38a0ebe7c0946ce9" kindref="member">cristaux_BGO</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(48);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>indexes<sp/>of<sp/>BGO<sp/>crystals<sp/>in<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168" refid="class_clovers_1a3dff2c188e41b5a0efe78e52f4f94949" refkind="member"><highlight class="normal"><sp/><sp/>std::array&lt;float,<sp/>48&gt;<sp/><sp/><sp/><ref refid="class_clovers_1a3dff2c188e41b5a0efe78e52f4f94949" kindref="member">cristaux_nrj_BGO</ref><sp/>=<sp/>{0};<sp/></highlight><highlight class="comment">//<sp/>Array<sp/>containing<sp/>the<sp/>energy<sp/>of<sp/>each<sp/>BGO<sp/>cristal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169" refid="class_clovers_1afc0133ff088329bad822a129568edac3" refkind="member"><highlight class="normal"><sp/><sp/>std::array&lt;double,<sp/>48&gt;<sp/><sp/><ref refid="class_clovers_1afc0133ff088329bad822a129568edac3" kindref="member">cristaux_time_BGO</ref><sp/>=<sp/>{0};</highlight><highlight class="comment">//<sp/>Array<sp/>containing<sp/>the<sp/>absolute<sp/>time<sp/>of<sp/>each<sp/>BGO<sp/>cristal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171" refid="class_clovers_1ad586816c3e23df6dac4d648939f23579" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1ad586816c3e23df6dac4d648939f23579" kindref="member">CrystalMult_BGO</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">//<sp/>BGO<sp/>crystals<sp/>counter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//_______________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>------<sp/>Clovers<sp/>-------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>the<sp/>following<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>-<sp/>if<sp/>nothing<sp/>is<sp/>specified,<sp/>the<sp/>containers<sp/>are<sp/>for<sp/>both<sp/>BGO<sp/>and<sp/>Germanium<sp/>hits<sp/>in<sp/>a<sp/>clover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>-</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Specific<sp/>methods<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180" refid="class_clovers_1ae6002b2880afe9e523ef87a8aa78b368" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_clover_module" kindref="compound">CloverModule</ref><sp/><ref refid="class_clovers_1ae6002b2880afe9e523ef87a8aa78b368" kindref="member">operator[] </ref>(<ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>i)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>[i];}</highlight></codeline>
<codeline lineno="181" refid="class_clovers_1a6ba57807510fa592b8c57963c0d3c788" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_clover_module" kindref="compound">CloverModule</ref><sp/><ref refid="class_clovers_1ae6002b2880afe9e523ef87a8aa78b368" kindref="member">operator[] </ref>(<ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>i)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>[i];}</highlight></codeline>
<codeline lineno="182" refid="class_clovers_1ae236f2adb9b2c374babe63b3cef9c970" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ae236f2adb9b2c374babe63b3cef9c970" kindref="member">begin</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>.begin();}</highlight></codeline>
<codeline lineno="183" refid="class_clovers_1a5886faa3a7bce241b628e2c7859e7dfd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a5886faa3a7bce241b628e2c7859e7dfd" kindref="member">end</ref>()</highlight><highlight class="keyword"><sp/><sp/><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>.end<sp/><sp/>();}</highlight></codeline>
<codeline lineno="184" refid="class_clovers_1a6f9f1d7a131c9972ded9cf1b4291455d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/><ref refid="class_clovers_1a6f9f1d7a131c9972ded9cf1b4291455d" kindref="member">size</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" kindref="member">size</ref>();}</highlight></codeline>
<codeline lineno="185" refid="class_clovers_1a378e1b7fea24003b4b56eb855c8ae163" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a378e1b7fea24003b4b56eb855c8ae163" kindref="member">mult</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="lib_co_8hpp_1a48e80fbfd11f9fb219b92ba1c29c1b2a" kindref="member">int_cast</ref>(<ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" kindref="member">size</ref>());}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a523aad5d019f23144292c0e23067a43b" kindref="member">Analyse</ref>();</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1adaa12173cad2d804f6583001f174fd12" kindref="member">Analyse_more</ref>();</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a5f280f8b6d043a949b726c7ff2b1e019" kindref="member">FillFast</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>hit_index);</highlight></codeline>
<codeline lineno="189" refid="class_clovers_1acf7eee4006e708ff0b2f4a56433d5e38" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1acf7eee4006e708ff0b2f4a56433d5e38" kindref="member">isPrompt</ref><sp/>(<ref refid="class_clover_module" kindref="compound">CloverModule</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clover)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a82f555f87d8ed08c3266843e01073213" kindref="member">promptGate</ref>(clover.<ref refid="class_clover_module_1aa015368cdc852dd79598e8c4bac07a50" kindref="member">time</ref>,<sp/>clover.<ref refid="class_clover_module_1a5ffbecaa432da9e2c8c24b529610da80" kindref="member">nrj</ref>)<sp/>;}</highlight></codeline>
<codeline lineno="190" refid="class_clovers_1a42f43989153734778e0ba6ad1cb2b983" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a42f43989153734778e0ba6ad1cb2b983" kindref="member">isDelayed</ref>(<ref refid="class_clover_module" kindref="compound">CloverModule</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clover)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a61ba76ac7711422e8e3b19d02b1854e4" kindref="member">delayedGate</ref>(clover.<ref refid="class_clover_module_1aa015368cdc852dd79598e8c4bac07a50" kindref="member">time</ref>,<sp/>clover.<ref refid="class_clover_module_1a5ffbecaa432da9e2c8c24b529610da80" kindref="member">nrj</ref>);}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a0d853153f63a1b04ca62756615dfd741" kindref="member">PrintClean</ref>();</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Positions<sp/>in<sp/>the<sp/>raw<sp/>event<sp/>(the<sp/>Event<sp/>object)<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Example<sp/>:<sp/>event.labels[rawGe[1]]<sp/>gives<sp/>the<sp/>label<sp/>of<sp/>the<sp/>second<sp/>germanium<sp/>hit<sp/>of<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196" refid="class_clovers_1af84dd10eb878f4385ecd092e23a77e1c" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1af84dd10eb878f4385ecd092e23a77e1c" kindref="member">rawGe</ref><sp/><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(96);<sp/></highlight><highlight class="comment">//List<sp/>of<sp/>the<sp/>position<sp/>of<sp/>the<sp/>raw<sp/>Ge<sp/><sp/>inside<sp/>the<sp/>Event<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197" refid="class_clovers_1a1a2205eb2396ce5fd48b0f12a73f0196" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a1a2205eb2396ce5fd48b0f12a73f0196" kindref="member">rawBGO</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(48);<sp/></highlight><highlight class="comment">//List<sp/>of<sp/>the<sp/>position<sp/>of<sp/>the<sp/>raw<sp/>BGO<sp/>inside<sp/>the<sp/>Event<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Hits<sp/>lists<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Example<sp/>:<sp/>auto<sp/>const<sp/>&amp;<sp/>clover<sp/>=<sp/>clovers[clovers.Hits[1]]<sp/>gives<sp/>you<sp/>a<sp/>direct<sp/>access<sp/>to<sp/>the<sp/>second<sp/>CloverModule<sp/>to<sp/>fire<sp/>in<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>print(clover.time,<sp/>clover.nrj);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>See<sp/>documentation<sp/>of<sp/>CloverModule</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203" refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);<sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>clovers<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205" refid="class_clovers_1a716473abe5555285f62eaabc6466c847" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a716473abe5555285f62eaabc6466c847" kindref="member">Ge</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);<sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>Germanium<sp/>modules<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206" refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" kindref="member">CleanGe</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);<sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>clean<sp/>Germaniums<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>event,<sp/>that<sp/>is<sp/>&quot;Ge<sp/>only&quot;<sp/>modules</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207" refid="class_clovers_1ae853cd7142ff578d6876c38070ef482e" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1ae853cd7142ff578d6876c38070ef482e" kindref="member">RejectedGe</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);<sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>rejected<sp/>Germaniums<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>event,<sp/>the<sp/>&quot;garbage&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208" refid="class_clovers_1ad4c54b6baf892e12b7865dad6d109691" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1ad4c54b6baf892e12b7865dad6d109691" kindref="member">PromptGe</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);</highlight></codeline>
<codeline lineno="209" refid="class_clovers_1a8b095b47153a05f4ea048dfd1f27cc8a" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a8b095b47153a05f4ea048dfd1f27cc8a" kindref="member">DelayedGe</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211" refid="class_clovers_1a204d1d6808b2e2832dd16fbf5f6c45d9" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a204d1d6808b2e2832dd16fbf5f6c45d9" kindref="member">Bgo</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);<sp/><sp/></highlight><highlight class="comment">//<sp/>List<sp/>of<sp/>BGO<sp/>modules<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212" refid="class_clovers_1a94e58fcdccd9a9165933a4f494c93dcf" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a94e58fcdccd9a9165933a4f494c93dcf" kindref="member">BGOonly</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);</highlight></codeline>
<codeline lineno="213" refid="class_clovers_1aebe6be652c1225409f400b3961ea9582" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1aebe6be652c1225409f400b3961ea9582" kindref="member">PromptBGO</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);</highlight></codeline>
<codeline lineno="214" refid="class_clovers_1a49e8eabe53190954b8c7973b0ed39f85" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref><sp/><ref refid="class_clovers_1a49e8eabe53190954b8c7973b0ed39f85" kindref="member">DelayedBGO</ref><sp/>=<sp/><ref refid="class_static_vector" kindref="compound">StaticVector&lt;uchar&gt;</ref>(24);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Array<sp/>containing<sp/>the<sp/>24<sp/>CloverModules<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217" refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;CloverModule&gt;<sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>;<sp/></highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Counters<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220" refid="class_clovers_1a4366bd57c8e4716d5fd63639c5ed2967" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1a4366bd57c8e4716d5fd63639c5ed2967" kindref="member">TotalMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="221" refid="class_clovers_1ad305f49ba37a534ff2d55cfdadd21965" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1ad305f49ba37a534ff2d55cfdadd21965" kindref="member">PromptMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="222" refid="class_clovers_1a6f9fa8831c5a512223a979eb7d6e0ff4" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1a6f9fa8831c5a512223a979eb7d6e0ff4" kindref="member">DelayedMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="223" refid="class_clovers_1aa52c6ad2a19f1ccf562194a76b47de0c" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1aa52c6ad2a19f1ccf562194a76b47de0c" kindref="member">PromptCleanGeMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="224" refid="class_clovers_1af73ecf57ed32c4670ffe484a5c4c0114" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1af73ecf57ed32c4670ffe484a5c4c0114" kindref="member">DelayedCleanGeMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>AnalyseFast<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227" refid="class_clovers_1a7d84f69dd5d1504df9eb5761bea0b6fe" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;uchar&gt;<sp/><ref refid="class_clovers_1a7d84f69dd5d1504df9eb5761bea0b6fe" kindref="member">promptClovers</ref>;</highlight></codeline>
<codeline lineno="228" refid="class_clovers_1a2d5bacc7c99a739838cf999e9a70f7ca" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;uchar&gt;<sp/><ref refid="class_clovers_1a2d5bacc7c99a739838cf999e9a70f7ca" kindref="member">delayedClovers</ref>;</highlight></codeline>
<codeline lineno="229" refid="class_clovers_1ac0eb8a13e2f9f4da36b976a6aa78a8ab" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;CloverModule&gt;<sp/><ref refid="class_clovers_1ac0eb8a13e2f9f4da36b976a6aa78a8ab" kindref="member">PromptClovers</ref>;</highlight></codeline>
<codeline lineno="230" refid="class_clovers_1accd03b8ba441c066df69dfda4419d29e" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;CloverModule&gt;<sp/><ref refid="class_clovers_1accd03b8ba441c066df69dfda4419d29e" kindref="member">DelayedClovers</ref>;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="232" refid="class_clovers_1a10afb56c3c4311007df55386dacba543" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a10afb56c3c4311007df55386dacba543" kindref="member">CleanFast</ref>()</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clover_i<sp/>:<sp/><ref refid="class_clovers_1a7d84f69dd5d1504df9eb5761bea0b6fe" kindref="member">promptClovers</ref><sp/>)<sp/><ref refid="class_clovers_1ac0eb8a13e2f9f4da36b976a6aa78a8ab" kindref="member">PromptClovers</ref><sp/>[clover_i].clear();</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clover_i<sp/>:<sp/><ref refid="class_clovers_1a2d5bacc7c99a739838cf999e9a70f7ca" kindref="member">delayedClovers</ref>)<sp/><ref refid="class_clovers_1accd03b8ba441c066df69dfda4419d29e" kindref="member">DelayedClovers</ref>[clover_i].clear();</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a7d84f69dd5d1504df9eb5761bea0b6fe" kindref="member">promptClovers</ref>.clear();</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a2d5bacc7c99a739838cf999e9a70f7ca" kindref="member">delayedClovers</ref>.clear();</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ad305f49ba37a534ff2d55cfdadd21965" kindref="member">PromptMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a6f9fa8831c5a512223a979eb7d6e0ff4" kindref="member">DelayedMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242" refid="class_clovers_1aa641968a47fb9db9363e89be9c29be4c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1aa641968a47fb9db9363e89be9c29be4c" kindref="member">timePs</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time_ps)<sp/>{<ref refid="class_clovers_1a52066e9d7cf040173f1790470bf9afff" kindref="member">s_time_ps</ref><sp/>=<sp/>time_ps;}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Parameters<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246" refid="class_clovers_1a8ab8ca513d60be7c305ca022e83c96b2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>thread_local<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a8ab8ca513d60be7c305ca022e83c96b2" kindref="member">s_initialised</ref>;</highlight></codeline>
<codeline lineno="247" refid="class_clovers_1a52066e9d7cf040173f1790470bf9afff" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a52066e9d7cf040173f1790470bf9afff" kindref="member">s_time_ps</ref>;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>-----------------------<sp/><sp/>Clovers<sp/>Class<sp/><sp/>-----------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>_______________________________________________________________<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>More<sp/>detailed<sp/>analysis<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:<sp/></highlight></codeline>
<codeline lineno="254" refid="class_clovers_1a0ad93f05644e9c600d6b3252ccfa019f" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a0ad93f05644e9c600d6b3252ccfa019f" kindref="member">has511</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Calorimetry<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257" refid="class_clovers_1a1bad91b9700a464895aacf89166961c5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a1bad91b9700a464895aacf89166961c5" kindref="member">totGe</ref><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="258" refid="class_clovers_1a3a258a7a457632666c0190b4fa04939b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a3a258a7a457632666c0190b4fa04939b" kindref="member">totBGO</ref><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="259" refid="class_clovers_1a94b65546b96444b31ff35570c2d45792" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a94b65546b96444b31ff35570c2d45792" kindref="member">totGe_prompt</ref><sp/>=<sp/>-0.1;</highlight></codeline>
<codeline lineno="260" refid="class_clovers_1a05a4d8b02a5d996da6a1205eb8bd6ca4" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a05a4d8b02a5d996da6a1205eb8bd6ca4" kindref="member">totBGO_prompt</ref><sp/>=<sp/>-0.1;</highlight></codeline>
<codeline lineno="261" refid="class_clovers_1abcd4354801aaef249f6a6332dca6c043" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1abcd4354801aaef249f6a6332dca6c043" kindref="member">totGe_delayed</ref><sp/>=<sp/>-0.1;</highlight></codeline>
<codeline lineno="262" refid="class_clovers_1a6e3b85032ab5190b5c2a360e6f0d2e4e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a6e3b85032ab5190b5c2a360e6f0d2e4e" kindref="member">totBGO_delayed</ref><sp/>=<sp/>-0.1;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Timing<sp/>:<sp/>//<sp/>TO<sp/>BE<sp/>IMPROVED<sp/>!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="266" refid="class_clovers_1a413ff8f90d6bcc0321e500633fd96bd5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1a413ff8f90d6bcc0321e500633fd96bd5" kindref="member">promptBGOgate</ref>;</highlight></codeline>
<codeline lineno="267" refid="class_clovers_1a3f5e44c3955123ec5535c585c7c295a2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="class_gates__t" kindref="compound">Gates</ref><sp/><ref refid="class_clovers_1a3f5e44c3955123ec5535c585c7c295a2" kindref="member">delayedBGOgate</ref>;</highlight></codeline>
<codeline lineno="268" refid="class_clovers_1a3189bfc58392c24d6a3dee2ce1a4c663" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1a3189bfc58392c24d6a3dee2ce1a4c663" kindref="member">promptGeGate</ref>;</highlight></codeline>
<codeline lineno="269" refid="class_clovers_1af1d3b98f82e408cf31671e72b9884169" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="class_gates__t" kindref="compound">Gates</ref><sp/><ref refid="class_clovers_1af1d3b98f82e408cf31671e72b9884169" kindref="member">delayedGeGate</ref>;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271" refid="class_clovers_1_1_prompt_gate" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_clovers_1_1_prompt_gate" kindref="compound">PromptGate</ref></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="274" refid="class_clovers_1_1_prompt_gate_1a35cb13d9f04935c2d43cc24a9773a406" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1_1_prompt_gate_1a35cb13d9f04935c2d43cc24a9773a406" kindref="member">PromptGate</ref>()</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight><highlight class="comment">//<sp/>Calculate<sp/>the<sp/>intermediate<sp/>region<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1_1_prompt_gate_1a8b8f752b98956440347786da814db71b" kindref="member">m_start_coeff</ref><sp/>=<sp/>(<ref refid="class_clovers_1_1_prompt_gate_1a8d445ecd07d7ceb91fca8f8e98f98ec6" kindref="member">m_high_E_gate</ref>.<ref refid="class_gate__t_1a1c49ae7aa44c27b9357e718432c2f93a" kindref="member">start</ref>-<ref refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" kindref="member">m_low_E_gate</ref>.<ref refid="class_gate__t_1a1c49ae7aa44c27b9357e718432c2f93a" kindref="member">start</ref>)<sp/>/<sp/>(<ref refid="class_clovers_1_1_prompt_gate_1ac3c7946fdddfaea3d944d3a53f77788c" kindref="member">m_high_E</ref>-<ref refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" kindref="member">m_low_E</ref>);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1_1_prompt_gate_1a5f72ef2730a18d95cbb44797802bdc0b" kindref="member">m_start_intercept</ref><sp/>=<sp/><ref refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" kindref="member">m_low_E_gate</ref>.<ref refid="class_gate__t_1a1c49ae7aa44c27b9357e718432c2f93a" kindref="member">start</ref>-<ref refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" kindref="member">m_low_E</ref>*<ref refid="class_clovers_1_1_prompt_gate_1a8b8f752b98956440347786da814db71b" kindref="member">m_start_coeff</ref>;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1_1_prompt_gate_1a2e853072f112b7a5d630b0672e19958d" kindref="member">m_stop_coeff</ref><sp/>=<sp/>(<ref refid="class_clovers_1_1_prompt_gate_1a8d445ecd07d7ceb91fca8f8e98f98ec6" kindref="member">m_high_E_gate</ref>.<ref refid="class_gate__t_1aa48ef2734b80f70fbbd37f2760e18724" kindref="member">stop</ref>-<ref refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" kindref="member">m_low_E_gate</ref>.<ref refid="class_gate__t_1aa48ef2734b80f70fbbd37f2760e18724" kindref="member">stop</ref>)<sp/>/<sp/>(<ref refid="class_clovers_1_1_prompt_gate_1ac3c7946fdddfaea3d944d3a53f77788c" kindref="member">m_high_E</ref>-<ref refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" kindref="member">m_low_E</ref>);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1_1_prompt_gate_1a9e5b930b3774e9f611444bf7a3c6714c" kindref="member">m_stop_intercept</ref><sp/>=<sp/><ref refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" kindref="member">m_low_E_gate</ref>.<ref refid="class_gate__t_1aa48ef2734b80f70fbbd37f2760e18724" kindref="member">stop</ref>-<ref refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" kindref="member">m_low_E</ref>*<ref refid="class_clovers_1_1_prompt_gate_1a2e853072f112b7a5d630b0672e19958d" kindref="member">m_stop_coeff</ref>;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="292" refid="class_clovers_1_1_prompt_gate_1a0361a1e0c672d0302e126e14c5dc59a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a0361a1e0c672d0302e126e14c5dc59a3" kindref="member">operator() </ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>energy)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>timef<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(time);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(energy<sp/>&gt;<sp/><ref refid="class_clovers_1_1_prompt_gate_1ac3c7946fdddfaea3d944d3a53f77788c" kindref="member">m_high_E</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a8d445ecd07d7ceb91fca8f8e98f98ec6" kindref="member">m_high_E_gate</ref>.<ref refid="class_gate__t_1a6ece805d91b1c54d4b84cc36e652bc0f" kindref="member">isIn</ref>(timef);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(energy<sp/>&gt;<sp/><ref refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" kindref="member">m_low_E</ref>)<sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(timef<sp/>&gt;<sp/><ref refid="class_clovers_1_1_prompt_gate_1a781245b0785affec4dc3acb3c40ed303" kindref="member">intermediate_start</ref>(energy)<sp/>&amp;&amp;<sp/>timef<sp/>&lt;<sp/><ref refid="class_clovers_1_1_prompt_gate_1a98e79d17cebda167160ad84138900110" kindref="member">intermediate_stop</ref>(energy));</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" kindref="member">m_low_E_gate</ref>.<ref refid="class_gate__t_1a6ece805d91b1c54d4b84cc36e652bc0f" kindref="member">isIn</ref>(timef);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300" refid="class_clovers_1_1_prompt_gate_1a7b9c6cb52b002391751b6f1de03062fe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a0361a1e0c672d0302e126e14c5dc59a3" kindref="member">operator() </ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time)<sp/></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a3189bfc58392c24d6a3dee2ce1a4c663" kindref="member">promptGeGate</ref>(time);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307" refid="class_clovers_1_1_prompt_gate_1a781245b0785affec4dc3acb3c40ed303" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a781245b0785affec4dc3acb3c40ed303" kindref="member">intermediate_start</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>energy)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1_1_prompt_gate_1a8b8f752b98956440347786da814db71b" kindref="member">m_start_coeff</ref>*energy+<ref refid="class_clovers_1_1_prompt_gate_1a5f72ef2730a18d95cbb44797802bdc0b" kindref="member">m_start_intercept</ref>);}</highlight></codeline>
<codeline lineno="308" refid="class_clovers_1_1_prompt_gate_1a98e79d17cebda167160ad84138900110" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a98e79d17cebda167160ad84138900110" kindref="member">intermediate_stop</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>energy)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1_1_prompt_gate_1a2e853072f112b7a5d630b0672e19958d" kindref="member">m_stop_coeff</ref>*energy+<ref refid="class_clovers_1_1_prompt_gate_1a9e5b930b3774e9f611444bf7a3c6714c" kindref="member">m_stop_intercept</ref><sp/>);}</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310" refid="class_clovers_1_1_prompt_gate_1ac3c7946fdddfaea3d944d3a53f77788c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1ac3c7946fdddfaea3d944d3a53f77788c" kindref="member">m_high_E</ref><sp/>=<sp/>200;</highlight></codeline>
<codeline lineno="311" refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1ab8d61188e744b02341381601a2b5fd5f" kindref="member">m_low_E</ref><sp/><sp/>=<sp/>50;</highlight></codeline>
<codeline lineno="312" refid="class_clovers_1_1_prompt_gate_1a8d445ecd07d7ceb91fca8f8e98f98ec6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1_1_prompt_gate_1a8d445ecd07d7ceb91fca8f8e98f98ec6" kindref="member">m_high_E_gate</ref><sp/>=<sp/>{-15.0,<sp/>7.0<sp/>};</highlight></codeline>
<codeline lineno="313" refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1_1_prompt_gate_1aa725929dbc349e34b8d696a2f0575540" kindref="member">m_low_E_gate</ref><sp/><sp/>=<sp/>{-20.0,<sp/>40.0};</highlight></codeline>
<codeline lineno="314" refid="class_clovers_1_1_prompt_gate_1a8b8f752b98956440347786da814db71b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a8b8f752b98956440347786da814db71b" kindref="member">m_start_coeff</ref><sp/>=<sp/>0.f;</highlight></codeline>
<codeline lineno="315" refid="class_clovers_1_1_prompt_gate_1a5f72ef2730a18d95cbb44797802bdc0b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a5f72ef2730a18d95cbb44797802bdc0b" kindref="member">m_start_intercept</ref><sp/>=<sp/>0.f;</highlight></codeline>
<codeline lineno="316" refid="class_clovers_1_1_prompt_gate_1a2e853072f112b7a5d630b0672e19958d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a2e853072f112b7a5d630b0672e19958d" kindref="member">m_stop_coeff</ref><sp/>=<sp/>0.f;</highlight></codeline>
<codeline lineno="317" refid="class_clovers_1_1_prompt_gate_1a9e5b930b3774e9f611444bf7a3c6714c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_prompt_gate_1a9e5b930b3774e9f611444bf7a3c6714c" kindref="member">m_stop_intercept</ref><sp/>=<sp/>0.f;</highlight></codeline>
<codeline lineno="318" refid="class_clovers_1a82f555f87d8ed08c3266843e01073213" refkind="member"><highlight class="normal"><sp/><sp/>}<sp/><ref refid="class_clovers_1a82f555f87d8ed08c3266843e01073213" kindref="member">promptGate</ref>;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320" refid="class_clovers_1_1_delayed_gate" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_clovers_1_1_delayed_gate" kindref="compound">DelayedGate</ref></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="323" refid="class_clovers_1_1_delayed_gate_1ad56e49d7480258ae67105b58e0624bac" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1_1_delayed_gate_1ad56e49d7480258ae67105b58e0624bac" kindref="member">DelayedGate</ref>(){}</highlight></codeline>
<codeline lineno="324" refid="class_clovers_1_1_delayed_gate_1a99b6bd95a46640581a2e8ed4db91336e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_delayed_gate_1a99b6bd95a46640581a2e8ed4db91336e" kindref="member">operator() </ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>energy)</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>timef<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(time);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(energy<sp/>&gt;<sp/><ref refid="class_clovers_1_1_delayed_gate_1abae41589bbf517cc6de956bf774f3cdb" kindref="member">m_low_E</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_delayed_gate_1a7d7104c6298961f558dbe86e45c8e9dc" kindref="member">m_high_E_gate</ref>.<ref refid="class_gate__t_1a6ece805d91b1c54d4b84cc36e652bc0f" kindref="member">isIn</ref>(timef);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_delayed_gate_1a2b8ade0055f592263dc7ce0c146a94c1" kindref="member">m_low_E_gate</ref>.<ref refid="class_gate__t_1a6ece805d91b1c54d4b84cc36e652bc0f" kindref="member">isIn</ref>(timef);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331" refid="class_clovers_1_1_delayed_gate_1a91c5e552a14d95e0801b8ac51944f6e1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_delayed_gate_1a99b6bd95a46640581a2e8ed4db91336e" kindref="member">operator() </ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time)</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(time&gt;60<sp/><sp/>&amp;&amp;<sp/>time&lt;165)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(time&gt;220<sp/>&amp;&amp;<sp/>time&lt;345)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(time&gt;420<sp/>&amp;&amp;<sp/>time&lt;545)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="340" refid="class_clovers_1_1_delayed_gate_1a730d8ada73e8b3337efcbf68c66b4a42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_delayed_gate_1a730d8ada73e8b3337efcbf68c66b4a42" kindref="member">m_high_E</ref><sp/>=<sp/>100;</highlight></codeline>
<codeline lineno="341" refid="class_clovers_1_1_delayed_gate_1abae41589bbf517cc6de956bf774f3cdb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1_1_delayed_gate_1abae41589bbf517cc6de956bf774f3cdb" kindref="member">m_low_E</ref><sp/>=<sp/>100;</highlight></codeline>
<codeline lineno="342" refid="class_clovers_1_1_delayed_gate_1a7d7104c6298961f558dbe86e45c8e9dc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1_1_delayed_gate_1a7d7104c6298961f558dbe86e45c8e9dc" kindref="member">m_high_E_gate</ref><sp/>=<sp/>{40.f,<sp/>145.f};</highlight></codeline>
<codeline lineno="343" refid="class_clovers_1_1_delayed_gate_1a2b8ade0055f592263dc7ce0c146a94c1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1_1_delayed_gate_1a2b8ade0055f592263dc7ce0c146a94c1" kindref="member">m_low_E_gate</ref><sp/><sp/>=<sp/>{60.f,<sp/>145.f};</highlight></codeline>
<codeline lineno="344" refid="class_clovers_1a61ba76ac7711422e8e3b19d02b1854e4" refkind="member"><highlight class="normal"><sp/><sp/>}<sp/><ref refid="class_clovers_1a61ba76ac7711422e8e3b19d02b1854e4" kindref="member">delayedGate</ref>;</highlight></codeline>
<codeline lineno="345"><highlight class="normal">};</highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----<sp/>InitialiseArrays<sp/>static<sp/>members<sp/>:<sp/>-----<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Lookup<sp/>tables<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal">std::array&lt;bool,<sp/>Clovers::nb_det&gt;<sp/><ref refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" kindref="member">Clovers::isClover</ref>;</highlight></codeline>
<codeline lineno="350"><highlight class="normal">std::array&lt;bool,<sp/>Clovers::nb_det&gt;<sp/><ref refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" kindref="member">Clovers::isGe</ref>;</highlight></codeline>
<codeline lineno="351"><highlight class="normal">std::array&lt;bool,<sp/>Clovers::nb_det&gt;<sp/><ref refid="class_clovers_1ab911b0e211d1222b38039f0d23018754" kindref="member">Clovers::isBGO</ref>;</highlight></codeline>
<codeline lineno="352"><highlight class="normal">std::array&lt;uchar,<sp/>Clovers::nb_det&gt;<sp/><ref refid="class_clovers_1a159566fba0cdaa0508d8049c12b7626c" kindref="member">Clovers::labels</ref>;</highlight></codeline>
<codeline lineno="353"><highlight class="normal">std::array&lt;uchar,<sp/>Clovers::nb_det&gt;<sp/><ref refid="class_clovers_1aaf1a13c67031efd703a4001cdc6df402" kindref="member">Clovers::cristaux_index</ref>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal">std::array&lt;uchar,<sp/>Clovers::nb_det&gt;<sp/><ref refid="class_clovers_1abbd356b154fa2369acffc83cca9a6204" kindref="member">Clovers::cristaux_index_BGO</ref>;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight><highlight class="comment">//<sp/>std::array&lt;bool,<sp/>Clovers::nb_det&gt;<sp/>Clovers::blacklist;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight><highlight class="comment">//<sp/>std::vector<sp/>&lt;uchar&gt;<sp/>Clovers::cristaux_opposite;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Parameters<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a2fd19fb7d2b6a38d651a179deda4c3c5" kindref="member">Clovers::Emin</ref><sp/>=<sp/>5.;<sp/></highlight><highlight class="comment">//<sp/>by<sp/>default<sp/>5<sp/>keV<sp/>threshold</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal">thread_local<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a8ab8ca513d60be7c305ca022e83c96b2" kindref="member">Clovers::s_initialised</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a52066e9d7cf040173f1790470bf9afff" kindref="member">Clovers::s_time_ps</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1a413ff8f90d6bcc0321e500633fd96bd5" kindref="member">Clovers::promptBGOgate</ref><sp/>=<sp/>{-20.f,<sp/>10.f<sp/>};</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><ref refid="class_gates__t" kindref="compound">Gates</ref><sp/><ref refid="class_clovers_1a3f5e44c3955123ec5535c585c7c295a2" kindref="member">Clovers::delayedBGOgate</ref><sp/>=<sp/>{{60.f,<sp/>145.f}};</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><ref refid="class_gate__t" kindref="compound">Gate</ref><sp/><ref refid="class_clovers_1a3189bfc58392c24d6a3dee2ce1a4c663" kindref="member">Clovers::promptGeGate</ref><sp/>=<sp/>{-20.f,<sp/>10.f<sp/>};</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><ref refid="class_gates__t" kindref="compound">Gates</ref><sp/><ref refid="class_clovers_1af1d3b98f82e408cf31671e72b9884169" kindref="member">Clovers::delayedGeGate</ref><sp/>=<sp/>{{60.f,<sp/>145.f}};</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight><highlight class="comment">//<sp/>----<sp/>Methods<sp/>:<sp/>---<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369" refid="class_clovers_1a60b7747d54a60759b4eae02deac50f95" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a60b7747d54a60759b4eae02deac50f95" kindref="member">Clovers::Reset</ref>()</highlight></codeline>
<codeline lineno="370"><highlight class="normal">{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index<sp/>:<sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>)</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>[index].Reset();</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index<sp/>:<sp/><ref refid="class_clovers_1a2cd5ef2adb5347f86d677a6ee78b0cf2" kindref="member">cristaux</ref>)</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a75da7859463f1478187c7f3f13d5f5d7" kindref="member">cristaux_nrj</ref><sp/><sp/>[index]<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a9b7473b93b1fd7b6330070f1611a42e1" kindref="member">cristaux_time</ref><sp/>[index]<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a2cd5ef2adb5347f86d677a6ee78b0cf2" kindref="member">cristaux</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index<sp/>:<sp/><ref refid="class_clovers_1abf3ac879188806ad38a0ebe7c0946ce9" kindref="member">cristaux_BGO</ref>)</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a3dff2c188e41b5a0efe78e52f4f94949" kindref="member">cristaux_nrj_BGO</ref><sp/><sp/>[index]<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1afc0133ff088329bad822a129568edac3" kindref="member">cristaux_time_BGO</ref><sp/>[index]<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1abf3ac879188806ad38a0ebe7c0946ce9" kindref="member">cristaux_BGO</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1af84dd10eb878f4385ecd092e23a77e1c" kindref="member">rawGe</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a1a2205eb2396ce5fd48b0f12a73f0196" kindref="member">rawBGO</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a716473abe5555285f62eaabc6466c847" kindref="member">Ge</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" kindref="member">CleanGe</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1ae853cd7142ff578d6876c38070ef482e" kindref="member">RejectedGe</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1ad4c54b6baf892e12b7865dad6d109691" kindref="member">PromptGe</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a8b095b47153a05f4ea048dfd1f27cc8a" kindref="member">DelayedGe</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a204d1d6808b2e2832dd16fbf5f6c45d9" kindref="member">Bgo</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a94e58fcdccd9a9165933a4f494c93dcf" kindref="member">BGOonly</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1aebe6be652c1225409f400b3961ea9582" kindref="member">PromptBGO</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a49e8eabe53190954b8c7973b0ed39f85" kindref="member">DelayedBGO</ref>.<ref refid="class_static_vector_1a9c5d814a81b352ebbb5d8a07cbdd2699" kindref="member">clear</ref>();</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a4366bd57c8e4716d5fd63639c5ed2967" kindref="member">TotalMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1ad305f49ba37a534ff2d55cfdadd21965" kindref="member">PromptMult</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">//<sp/>NOT<sp/>USED<sp/>in<sp/>normal<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a6f9fa8831c5a512223a979eb7d6e0ff4" kindref="member">DelayedMult</ref><sp/>=<sp/>0;</highlight><highlight class="comment">//<sp/>NOT<sp/>USED<sp/>in<sp/>normal<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1aa52c6ad2a19f1ccf562194a76b47de0c" kindref="member">PromptCleanGeMult</ref><sp/>=<sp/>0;</highlight><highlight class="comment">//<sp/>NOT<sp/>USED<sp/>in<sp/>normal<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1af73ecf57ed32c4670ffe484a5c4c0114" kindref="member">DelayedCleanGeMult</ref><sp/>=<sp/>0;</highlight><highlight class="comment">//<sp/>NOT<sp/>USED<sp/>in<sp/>normal<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a079d8274f7810d7ee0da013ccdfc759c" kindref="member">CrystalMult</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1ad586816c3e23df6dac4d648939f23579" kindref="member">CrystalMult_BGO</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a0ad93f05644e9c600d6b3252ccfa019f" kindref="member">has511</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a1bad91b9700a464895aacf89166961c5" kindref="member">totGe</ref><sp/>=<sp/>-1.E-12;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a3a258a7a457632666c0190b4fa04939b" kindref="member">totBGO</ref><sp/>=<sp/>-1.E-12;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a94b65546b96444b31ff35570c2d45792" kindref="member">totGe_prompt</ref><sp/>=<sp/>-1.E-12;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a05a4d8b02a5d996da6a1205eb8bd6ca4" kindref="member">totBGO_prompt</ref><sp/>=<sp/>-1.E-12;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1abcd4354801aaef249f6a6332dca6c043" kindref="member">totGe_delayed</ref><sp/>=<sp/>-1.E-12;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a6e3b85032ab5190b5c2a360e6f0d2e4e" kindref="member">totBGO_delayed</ref><sp/>=<sp/>-1.E-12;</highlight></codeline>
<codeline lineno="421"><highlight class="normal">}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="430" refid="class_clovers_1a264432ef7231d65b77e744858374b8e1" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a264432ef7231d65b77e744858374b8e1" kindref="member">Clovers::SetEvent</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event)</highlight></codeline>
<codeline lineno="431"><highlight class="normal">{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1a60b7747d54a60759b4eae02deac50f95" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;</highlight><highlight class="keyword">event</highlight><highlight class="normal">.size();<sp/>i++)<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1ab1394e718791a5016aa3e0a19828465c" kindref="member">Fill</ref>(event,<sp/>i);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1a523aad5d019f23144292c0e23067a43b" kindref="member">Analyse</ref>();</highlight></codeline>
<codeline lineno="435"><highlight class="normal">}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="444" refid="class_clovers_1a947342842702e2f91a86d0847b15ba3a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a264432ef7231d65b77e744858374b8e1" kindref="member">Clovers::SetEvent</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>analyse_mode)</highlight></codeline>
<codeline lineno="445"><highlight class="normal">{</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(analyse_mode<sp/>==<sp/>1)<sp/></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1a60b7747d54a60759b4eae02deac50f95" kindref="member">Reset</ref>();</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;</highlight><highlight class="keyword">event</highlight><highlight class="normal">.size();<sp/>i++)<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1ab1394e718791a5016aa3e0a19828465c" kindref="member">Fill</ref>(event,<sp/>i);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(analyse_mode<sp/>==<sp/>2)<sp/></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1a10afb56c3c4311007df55386dacba543" kindref="member">CleanFast</ref>();</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;</highlight><highlight class="keyword">event</highlight><highlight class="normal">.size();<sp/>i++)<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>-&gt;<sp/><ref refid="class_clovers_1a5f280f8b6d043a949b726c7ff2b1e019" kindref="member">FillFast</ref>(event,<sp/>i);</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ad305f49ba37a534ff2d55cfdadd21965" kindref="member">PromptMult</ref><sp/><sp/>=<sp/><ref refid="class_clovers_1a7d84f69dd5d1504df9eb5761bea0b6fe" kindref="member">promptClovers</ref><sp/>.size();</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a6f9fa8831c5a512223a979eb7d6e0ff4" kindref="member">DelayedMult</ref><sp/>=<sp/><ref refid="class_clovers_1a2d5bacc7c99a739838cf999e9a70f7ca" kindref="member">delayedClovers</ref>.size();</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="458"><highlight class="normal">}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460" refid="class_clovers_1a5f280f8b6d043a949b726c7ff2b1e019" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a5f280f8b6d043a949b726c7ff2b1e019" kindref="member">Clovers::FillFast</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>hit_index)</highlight></codeline>
<codeline lineno="461"><highlight class="normal">{</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>label<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">.labels[hit_index];</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" kindref="member">isClover</ref>[label])<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index_clover<sp/>=<sp/><ref refid="class_clovers_1a159566fba0cdaa0508d8049c12b7626c" kindref="member">labels</ref>[label];</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1ae9a13402fed613a29197e99ce20396f8" kindref="member">push_back_unique</ref>(index_clover);</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>nrj<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">.nrjs[hit_index];</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time<sp/>=<sp/>(<ref refid="class_clovers_1a52066e9d7cf040173f1790470bf9afff" kindref="member">s_time_ps</ref>)<sp/>?<sp/>event.<ref refid="class_event_1a433bcb1da05d7a6f477d4d1b9ee0f7b0" kindref="member">times</ref>[hit_index]/1000.0<sp/>:<sp/>event.<ref refid="class_event_1a24cba1790b71f725050f229c129e91d4" kindref="member">time2s</ref>[hit_index];</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/>if<sp/>(nrj&lt;<ref refid="class_clovers_1a2fd19fb7d2b6a38d651a179deda4c3c5" kindref="member">Emin</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" kindref="member">isGe</ref>[label])</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a82f555f87d8ed08c3266843e01073213" kindref="member">promptGate</ref><sp/>(time))<sp/></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="vector__functions_8hpp_1a0714a23fb316299fdee1e44d9f46343b" kindref="member">push_back_unique</ref>(<ref refid="class_clovers_1a7d84f69dd5d1504df9eb5761bea0b6fe" kindref="member">promptClovers</ref>,<sp/>index_clover);</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ac0eb8a13e2f9f4da36b976a6aa78a8ab" kindref="member">PromptClovers</ref>[index_clover].addGe(nrj,<sp/>time);</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a61ba76ac7711422e8e3b19d02b1854e4" kindref="member">delayedGate</ref>(time))</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="vector__functions_8hpp_1a0714a23fb316299fdee1e44d9f46343b" kindref="member">push_back_unique</ref>(<ref refid="class_clovers_1a2d5bacc7c99a739838cf999e9a70f7ca" kindref="member">delayedClovers</ref>,<sp/>index_clover);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1accd03b8ba441c066df69dfda4419d29e" kindref="member">DelayedClovers</ref>[index_clover].addGe(nrj,<sp/>time);</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">//<sp/>if<sp/>isBGO[label]<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a82f555f87d8ed08c3266843e01073213" kindref="member">promptGate</ref><sp/>(time))<sp/><ref refid="class_clovers_1ac0eb8a13e2f9f4da36b976a6aa78a8ab" kindref="member">PromptClovers</ref>[index_clover].addBGO(nrj,<sp/>time);</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a61ba76ac7711422e8e3b19d02b1854e4" kindref="member">delayedGate</ref>(time))<sp/><ref refid="class_clovers_1accd03b8ba441c066df69dfda4419d29e" kindref="member">DelayedClovers</ref>[index_clover].addBGO(nrj,<sp/>time);</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="493"><highlight class="normal">}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495" refid="class_clovers_1ab1394e718791a5016aa3e0a19828465c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ab1394e718791a5016aa3e0a19828465c" kindref="member">Clovers::Fill</ref>(<ref refid="class_event" kindref="compound">Event</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>event,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>hit_index)</highlight></codeline>
<codeline lineno="496"><highlight class="normal">{</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>label<sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">.labels[hit_index];</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a687d74db6672d500ea654b1829b793ed" kindref="member">isClover</ref>[label])</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index_clover<sp/>=<sp/><ref refid="class_clovers_1a159566fba0cdaa0508d8049c12b7626c" kindref="member">labels</ref>[label];<sp/></highlight><highlight class="comment">//<sp/>The<sp/>clovers<sp/>are<sp/>indexed<sp/>between<sp/>0<sp/>and<sp/>23</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>nrj<sp/><sp/>=<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">.nrjs[hit_index];</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>time<sp/>=<sp/>(<ref refid="class_clovers_1a52066e9d7cf040173f1790470bf9afff" kindref="member">s_time_ps</ref>)<sp/>?<sp/>event.<ref refid="class_event_1a433bcb1da05d7a6f477d4d1b9ee0f7b0" kindref="member">times</ref>[hit_index]/1000.0<sp/>:<sp/>event.<ref refid="class_event_1a24cba1790b71f725050f229c129e91d4" kindref="member">time2s</ref>[hit_index];</highlight></codeline>
<codeline lineno="507"><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;<sp/>clover<sp/>=<sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>[index_clover];</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>the<sp/>vector<sp/>containing<sp/>the<sp/>list<sp/>of<sp/>all<sp/>the<sp/>clovers<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>event<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1ae9a13402fed613a29197e99ce20396f8" kindref="member">push_back_unique</ref>(index_clover);</highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_clovers_1a1ec1095c6c79a2b350a8b97faf93c454" kindref="member">isGe</ref>[label])</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--------------------------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Individual<sp/>crystals<sp/>managing<sp/>:<sp/>---<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ge<sp/>crystal<sp/>index<sp/>(ranges<sp/>from<sp/>0<sp/>to<sp/>96):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index_cristal<sp/>=<sp/><ref refid="class_clovers_1aaf1a13c67031efd703a4001cdc6df402" kindref="member">cristaux_index</ref>[label];</highlight></codeline>
<codeline lineno="520"><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a079d8274f7810d7ee0da013ccdfc759c" kindref="member">CrystalMult</ref>++;</highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Position<sp/>of<sp/>the<sp/>hit<sp/>in<sp/>the<sp/>event<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1af84dd10eb878f4385ecd092e23a77e1c" kindref="member">rawGe</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(hit_index);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>the<sp/>vector<sp/>containing<sp/>the<sp/>list<sp/>of<sp/>all<sp/>the<sp/>Ge<sp/>crystals<sp/>that<sp/>fired<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>(label<sp/>==<sp/>26)<sp/>print(index_cristal);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a2cd5ef2adb5347f86d677a6ee78b0cf2" kindref="member">cristaux</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index_cristal);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Filling<sp/>the<sp/>germanium<sp/>crystals<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a75da7859463f1478187c7f3f13d5f5d7" kindref="member">cristaux_nrj</ref><sp/>[index_cristal]<sp/>=<sp/>nrj;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a9b7473b93b1fd7b6330070f1611a42e1" kindref="member">cristaux_time</ref>[index_cristal]<sp/>=<sp/>time;</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>-------------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Clovers<sp/>managing:<sp/>---<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Counts<sp/>the<sp/>number<sp/>of<sp/>Ge<sp/>crystals<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>clover<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>clover.nb++;</highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>a<sp/>raw<sp/>add-back<sp/>:<sp/>sum<sp/>the<sp/>energy<sp/>of<sp/>all<sp/>the<sp/>crystals<sp/>in<sp/>a<sp/>clover</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>clover.nrj<sp/>+=<sp/>nrj;</highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>the<sp/>Ge<sp/>cristal<sp/>that<sp/>received<sp/>the<sp/>most<sp/>energy<sp/>and<sp/>use<sp/>its<sp/>time<sp/>for<sp/>the<sp/>clover<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nrj<sp/>&gt;=<sp/><ref refid="class_clovers_1a75da7859463f1478187c7f3f13d5f5d7" kindref="member">cristaux_nrj</ref>[clover.maxE_Ge_cristal])</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clover.maxE_Ge_cristal<sp/>=<sp/>index_cristal;</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clover.time<sp/>=<sp/>time;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight><highlight class="comment">//<sp/>if<sp/>isBGO[label]<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--------------------------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Individual<sp/>crystals<sp/>managing<sp/>:<sp/>---<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1ad586816c3e23df6dac4d648939f23579" kindref="member">CrystalMult_BGO</ref>++;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Position<sp/>of<sp/>the<sp/>hit<sp/>in<sp/>the<sp/>event<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a1a2205eb2396ce5fd48b0f12a73f0196" kindref="member">rawBGO</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(hit_index);</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>BGO<sp/>crystal<sp/>index<sp/>(ranges<sp/>from<sp/>0<sp/>tp<sp/>48):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index_cristal<sp/>=<sp/><ref refid="class_clovers_1aaf1a13c67031efd703a4001cdc6df402" kindref="member">cristaux_index</ref>[label];</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>the<sp/>vector<sp/>containing<sp/>the<sp/>list<sp/>of<sp/>all<sp/>the<sp/>BGO<sp/>crystals<sp/>that<sp/>fired<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1abf3ac879188806ad38a0ebe7c0946ce9" kindref="member">cristaux_BGO</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index_cristal);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Filling<sp/>the<sp/>germanium<sp/>crystals<sp/>informations<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>cristaux_nrj_BGO<sp/>[index_cristal]<sp/>=<sp/>nrj*BGO_coeff[index_cristal];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a3dff2c188e41b5a0efe78e52f4f94949" kindref="member">cristaux_nrj_BGO</ref><sp/>[index_cristal]<sp/>=<sp/>nrj;</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1afc0133ff088329bad822a129568edac3" kindref="member">cristaux_time_BGO</ref>[index_cristal]<sp/>=<sp/>time;</highlight></codeline>
<codeline lineno="572"><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>-------------------------<sp/>//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Clovers<sp/>managing:<sp/>---//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Counts<sp/>the<sp/>number<sp/>of<sp/>BGO<sp/>crystals<sp/>that<sp/>fired<sp/>in<sp/>the<sp/>clover<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>clover.nb_BGO++;</highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>the<sp/>vector<sp/>containing<sp/>the<sp/>list<sp/>of<sp/>BGO<sp/>clovers<sp/>that<sp/>fired<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>the<sp/>cell<sp/>containing<sp/>the<sp/>total<sp/>energy<sp/>deposit<sp/>in<sp/>the<sp/>module&apos;s<sp/>BGOs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>clover.nrj_BGO<sp/>+=<sp/>nrj*BGO_coeff[index_cristal];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>clover.nrj_BGO<sp/>+=<sp/>nrj;</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Manage<sp/>the<sp/>time<sp/>of<sp/>the<sp/>BGOs.<sp/>To<sp/>be<sp/>improved<sp/>if<sp/>necessary<sp/>:<sp/>if<sp/>2<sp/>BGOs,<sp/>only<sp/>the<sp/>latest<sp/>is<sp/>stored</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>clover.time_BGO<sp/>=<sp/>time;</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="591"><highlight class="normal">}</highlight></codeline>
<codeline lineno="592"><highlight class="normal"></highlight></codeline>
<codeline lineno="593" refid="class_clovers_1a523aad5d019f23144292c0e23067a43b" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a523aad5d019f23144292c0e23067a43b" kindref="member">Clovers::Analyse</ref>()</highlight></codeline>
<codeline lineno="594"><highlight class="normal">{</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>index<sp/>:<sp/><ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;<sp/>clover<sp/>=<sp/><ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>[index];</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Analysing<sp/>Germaniums</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clover.nb<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>the<sp/>vector<sp/>containing<sp/>the<sp/>list<sp/>of<sp/>Ge<sp/>clovers<sp/>that<sp/>fired<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a716473abe5555285f62eaabc6466c847" kindref="member">Ge</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a1bad91b9700a464895aacf89166961c5" kindref="member">totGe</ref>+=clover.nrj;</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clover.nb_BGO==0)<sp/><ref refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" kindref="member">CleanGe</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index);</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1ae853cd7142ff578d6876c38070ef482e" kindref="member">RejectedGe</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index);</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Analysing<sp/>BGOs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clover.nb_BGO<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a204d1d6808b2e2832dd16fbf5f6c45d9" kindref="member">Bgo</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index);</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_clovers_1a3a258a7a457632666c0190b4fa04939b" kindref="member">totBGO</ref>+=clover.nrj_BGO;</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clover.nb<sp/>==<sp/>0)<sp/><ref refid="class_clovers_1a94e58fcdccd9a9165933a4f494c93dcf" kindref="member">BGOonly</ref>.<ref refid="class_static_vector_1a8f604b0f4165d95a6b6653907c92ceb3" kindref="member">push_back</ref>(index);</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="617"><highlight class="normal">}</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619" refid="class_clovers_1adaa12173cad2d804f6583001f174fd12" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1adaa12173cad2d804f6583001f174fd12" kindref="member">Clovers::Analyse_more</ref>()</highlight></codeline>
<codeline lineno="620"><highlight class="normal">{</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal">}</highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight><highlight class="comment">//<sp/>template&lt;class<sp/>T&gt;<sp/>T<sp/>positive_modulo(T<sp/>const<sp/>&amp;<sp/>dividend,<sp/>T<sp/>const<sp/>&amp;<sp/>divisor)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight><highlight class="comment">//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>auto<sp/>ret<sp/>=<sp/>dividend<sp/>%<sp/>divisor;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>if<sp/>(ret&lt;0)<sp/>ret+=divisor;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>return<sp/>ret;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight><highlight class="comment">//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631" refid="class_clovers_1ad047177f1403bb65359a6ad07ba4473a" refkind="member"><highlight class="normal"><ref refid="lib_co_8hpp_1ae48ac2456c5ad6c956fef86e7bef3a21" kindref="member">uchar</ref><sp/><ref refid="class_clovers_1ad047177f1403bb65359a6ad07ba4473a" kindref="member">Clovers::label_to_cristal</ref>(<ref refid="_hit_8hpp_1ab5dd24876acad09ec52c250c1668466c" kindref="member">Label</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>l)</highlight></codeline>
<codeline lineno="632"><highlight class="normal">{</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>cristal<sp/>=<sp/><ref refid="lib_co_8hpp_1ade77d1f37b1311b3f80ce429a33fd226" kindref="member">uchar_cast</ref>(l-23);</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>clover_cristal<sp/>=<sp/><ref refid="lib_co_8hpp_1ade77d1f37b1311b3f80ce429a33fd226" kindref="member">uchar_cast</ref>(cristal%6);</highlight></codeline>
<codeline lineno="635"><highlight class="normal"></highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>BGO<sp/>:<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(clover_cristal&lt;2)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="lib_co_8hpp_1ade77d1f37b1311b3f80ce429a33fd226" kindref="member">uchar_cast</ref>(clover_cristal+2*(cristal/6));</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Ge<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>clover<sp/>=<sp/>cristal/6;<sp/></highlight><highlight class="comment">//<sp/>Clover<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>Ge_cristal<sp/>=<sp/><ref refid="lib_co_8hpp_1ade77d1f37b1311b3f80ce429a33fd226" kindref="member">uchar_cast</ref>(clover_cristal-2);<sp/></highlight><highlight class="comment">//<sp/>Cristal<sp/>number<sp/>inside<sp/>the<sp/>clover<sp/>[0,3]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>cristal_index<sp/>=<sp/><ref refid="lib_co_8hpp_1ade77d1f37b1311b3f80ce429a33fd226" kindref="member">uchar_cast</ref>(Ge_cristal+4*clover);</highlight></codeline>
<codeline lineno="645"><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>normally<sp/>rotated<sp/>clovers,<sp/>the<sp/>following<sp/>disposition<sp/>is<sp/>taken<sp/>:<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>With<sp/>sub_index<sp/>beeing<sp/>ranging<sp/>from<sp/>0<sp/>to<sp/>3<sp/>for<sp/>Ge<sp/>crystal,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>With<sp/>beam<sp/>from<sp/>right<sp/>to<sp/>left,<sp/>and<sp/>the<sp/>gamma<sp/>rays<sp/>going<sp/>out<sp/>of<sp/>the<sp/>sheet<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>color<sp/>green<sp/>is<sp/>top<sp/>right,<sp/>black<sp/>top<sp/>left,<sp/>red<sp/>bottom<sp/>right<sp/>and<sp/>blue<sp/>bottom<sp/>left<sp/>for<sp/>normally<sp/>rotated<sp/>clovers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>sub_index<sp/>0<sp/>is<sp/>top<sp/>left,<sp/>1<sp/>top<sp/>right,<sp/>2<sp/>bottom<sp/>right,<sp/>3<sp/>bottom_left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>That<sp/>is,<sp/>the<sp/>angle<sp/>phi<sp/>increases<sp/>with<sp/>the<sp/>sub_index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(Ge_cristal)</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>0:<sp/>Ge_cristal<sp/>=<sp/>2;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>Red</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>1:<sp/>Ge_cristal<sp/>=<sp/>1;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>Green</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>2:<sp/>Ge_cristal<sp/>=<sp/>0;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>Black</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>3:<sp/>Ge_cristal<sp/>=<sp/>3;<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>Blue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Should<sp/>never<sp/>happen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Correctly<sp/>rotate<sp/>the<sp/>wrongly<sp/>rotated<sp/>clovers<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(clover)<sp/></highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">//<sp/>Rotation<sp/>is<sp/>trigowise<sp/>direction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>pi/2<sp/>rotated<sp/>(-&gt;<sp/>-pi/2<sp/>rotation)<sp/>:<sp/>R2A6</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>17:</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ge_cristal<sp/>=<sp/><ref refid="lib_co_8hpp_1acffb7404540d3e0a654fd7929081bb70" kindref="member">positive_modulo</ref>((Ge_cristal-1),<sp/>4);<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>-pi/2<sp/>rotated<sp/>(-&gt;<sp/>pi/2<sp/>rotation)<sp/>:<sp/>R3A3,<sp/>R3A4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>2:<sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>3:</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Ge_cristal<sp/>=<sp/><ref refid="lib_co_8hpp_1acffb7404540d3e0a654fd7929081bb70" kindref="member">positive_modulo</ref>((Ge_cristal+1),<sp/>4);<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>pi<sp/>rotation<sp/>:<sp/>R3A5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>4:</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Ge_cristal<sp/>=<sp/><ref refid="lib_co_8hpp_1acffb7404540d3e0a654fd7929081bb70" kindref="member">positive_modulo</ref>((Ge_cristal+2),<sp/>4);<sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>clover+Ge_cristal;</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="680"><highlight class="normal">}</highlight></codeline>
<codeline lineno="681"><highlight class="normal"></highlight></codeline>
<codeline lineno="682" refid="class_clovers_1a0d853153f63a1b04ca62756615dfd741" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_clovers_1a0d853153f63a1b04ca62756615dfd741" kindref="member">Clovers::PrintClean</ref>()</highlight></codeline>
<codeline lineno="683"><highlight class="normal">{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><ref refid="print_8hpp_1a388f572c62279f839ee138a9afbdeeb5" kindref="member">print</ref>(<ref refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" kindref="member">CleanGe</ref>.<ref refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" kindref="member">size</ref>(),<sp/>std::string(</highlight><highlight class="stringliteral">&quot;clean<sp/>clover<sp/>hit&quot;</highlight><highlight class="normal">)+((<ref refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" kindref="member">CleanGe</ref>.<ref refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" kindref="member">size</ref>()&gt;1)?</highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clover_index<sp/>:<sp/><ref refid="class_clovers_1a3b6fa093b84451b7ebe304838530997b" kindref="member">CleanGe</ref>)</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="print_8hpp_1a388f572c62279f839ee138a9afbdeeb5" kindref="member">print</ref>(<ref refid="class_clovers_1ad07746b708cc9bea3ef6ed4370d928b9" kindref="member">m_clovers</ref>[clover_index]);</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="689"><highlight class="normal">}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"></highlight></codeline>
<codeline lineno="691" refid="_clovers_8hpp_1a25cc9a6adf9227586fe9e4ef23928011" refkind="member"><highlight class="normal">std::ostream&amp;<sp/><ref refid="_clovers_8hpp_1a25cc9a6adf9227586fe9e4ef23928011" kindref="member">operator&lt;&lt;</ref>(std::ostream&amp;<sp/>cout,<sp/><ref refid="class_clovers" kindref="compound">Clovers</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clovers)</highlight></codeline>
<codeline lineno="692"><highlight class="normal">{</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><ref refid="print_8hpp_1a388f572c62279f839ee138a9afbdeeb5" kindref="member">print</ref>(clovers.<ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" kindref="member">size</ref>(),<sp/>std::string(</highlight><highlight class="stringliteral">&quot;clover<sp/>hit&quot;</highlight><highlight class="normal">)+((clovers.<ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>.<ref refid="class_static_vector_1a44b964207cfd132dda347e246a3640c8" kindref="member">size</ref>()&gt;1)?</highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;<sp/>clover_index<sp/>:<sp/>clovers.<ref refid="class_clovers_1a4c02a37642baad4cff767619dd48b76b" kindref="member">Hits</ref>)</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="print_8hpp_1a388f572c62279f839ee138a9afbdeeb5" kindref="member">print</ref>(clovers[clover_index]);</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cout;</highlight></codeline>
<codeline lineno="699"><highlight class="normal">}</highlight></codeline>
<codeline lineno="700"><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">//CLOVERS_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="702"><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight><highlight class="comment">//<sp/>inline<sp/>void<sp/>Clovers::Analyse()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight><highlight class="comment">//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>for<sp/>(auto<sp/>const<sp/>&amp;<sp/>index<sp/>:<sp/>Hits)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>auto<sp/>&amp;<sp/>clover<sp/>=<sp/>m_clovers[index];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>TotalMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>Analysing<sp/>Germaniums</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>if<sp/>(clover.nb<sp/>&gt;<sp/>0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Fill<sp/>the<sp/>vector<sp/>containing<sp/>the<sp/>list<sp/>of<sp/>Ge<sp/>clovers<sp/>that<sp/>fired<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="714"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ge.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>totGe+=clover.nrj;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>clover.isGePrompt<sp/><sp/>=<sp/>promptGate<sp/>(clover.time);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>clover.isGeDelayed<sp/>=<sp/>delayedGate(clover.time);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>if<sp/>(clover.isGePrompt)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>PromptMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>PromptGe.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>totGe_prompt+=clover.nrj;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>else<sp/>if<sp/>(clover.isGeDelayed)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>DelayedMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>DelayedGe.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>totGe_delayed+=clover.nrj;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(clover.nb_BGO==0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="734"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CleanGe.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(clover.isGePrompt<sp/>)<sp/>PromptCleanGeMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>else<sp/>if<sp/>(clover.isGeDelayed)<sp/>DelayedCleanGeMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>RejectedGe.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="740"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>Analysing<sp/>BGOs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="743"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>if<sp/>(clover.nb_BGO<sp/>&gt;<sp/>0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Bgo.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>totBGO+=clover.nrj_BGO;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>clover.isBGOPrompt<sp/><sp/>=<sp/>promptGate<sp/>(clover.time_BGO,<sp/>clover.nrj_BGO);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>clover.isBGODelayed<sp/>=<sp/>delayedGate(clover.time_BGO,<sp/>clover.nrj_BGO);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>if<sp/>(clover.isBGOPrompt)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>PromptBGO.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>totBGO_prompt+=clover.nrj_BGO;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>else<sp/>if<sp/>(clover.isBGODelayed)<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>DelayedBGO.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="759"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/>totBGO_delayed+=clover.nrj_BGO;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="760"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>To<sp/>avoid<sp/>double<sp/>counting<sp/>with<sp/>the<sp/>clovers<sp/>containing<sp/>both<sp/>bgo<sp/>and<sp/>ge<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(clover.nb<sp/>==<sp/>0)<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>if<sp/>(clover.isBGOPrompt)<sp/>PromptMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>if<sp/>(clover.isBGODelayed)DelayedMult++;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BGOonly.push_back(index);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="768"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight><highlight class="comment">//<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight><highlight class="comment">//<sp/>uchar<sp/>Clovers::label_to_cristal(Label<sp/>const<sp/>&amp;<sp/>l)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"></highlight><highlight class="comment">//<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>auto<sp/>const<sp/>cristal<sp/>=<sp/>static_cast&lt;uchar&gt;(l-23);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>auto<sp/>const<sp/>clover_cristal<sp/>=<sp/>static_cast&lt;uchar&gt;(cristal%6);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="778"><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>//<sp/>BGO<sp/>:<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>if<sp/>(clover_cristal&lt;2)<sp/>return<sp/>static_cast&lt;uchar&gt;(clover_cristal+2*(cristal/6));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="782"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>//<sp/>Ge<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="783"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>auto<sp/>const<sp/>clover<sp/>=<sp/>cristal/6;<sp/>//<sp/>Clover<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>auto<sp/>const<sp/>Ge_cristal<sp/>=<sp/>clover_cristal-2;<sp/>//<sp/>Cristal<sp/>number<sp/>inside<sp/>the<sp/>clover<sp/>[0,3]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>auto<sp/>cristal_index<sp/>=<sp/>Ge_cristal+4*clover;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>For<sp/>normally<sp/>rotated<sp/>clovers,<sp/>the<sp/>following<sp/>disposition<sp/>is<sp/>taken<sp/>:<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>With<sp/>sub_index<sp/>beeing<sp/>ranging<sp/>from<sp/>0<sp/>to<sp/>3<sp/>for<sp/>Ge<sp/>crystal,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>With<sp/>beam<sp/>from<sp/>right<sp/>to<sp/>left,<sp/>and<sp/>the<sp/>gamma<sp/>rays<sp/>going<sp/>out<sp/>of<sp/>the<sp/>sheet<sp/>:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>The<sp/>color<sp/>green<sp/>is<sp/>top<sp/>right,<sp/>black<sp/>top<sp/>left,<sp/>red<sp/>bottom<sp/>right<sp/>and<sp/>blue<sp/>bottom<sp/>left<sp/>for<sp/>normally<sp/>rotated<sp/>clovers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>The<sp/>sub_index<sp/>0<sp/>is<sp/>top<sp/>right,<sp/>1<sp/>top<sp/>left,<sp/>2<sp/>bottom<sp/>right,<sp/>3<sp/>bottom_left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/>That<sp/>is,<sp/>the<sp/>angle<sp/>phi<sp/>increases<sp/>with<sp/>the<sp/>sub_index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>even<sp/>labels<sp/>are<sp/>on<sp/>the<sp/>right<sp/>side</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>odd<sp/><sp/>labels<sp/>are<sp/>on<sp/>the<sp/>left<sp/><sp/>side</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>switch<sp/>(clover)<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>{<sp/>//<sp/>Rotation<sp/>is<sp/>trigowise<sp/>direction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>pi/2<sp/>rotation<sp/>:<sp/>R2A6</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>case<sp/>17:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="803"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>switch(Ge_cristal)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>0:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+0);<sp/>//<sp/>Red</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="806"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>1:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+0);<sp/>//<sp/>Green</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>2:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+1);<sp/>//<sp/>Black</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>3:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index-1);<sp/>//<sp/>Blue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="809"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>:<sp/>return<sp/>-1;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>-pi/2<sp/>rotation<sp/>:<sp/>R3A3,<sp/>R3A4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>case<sp/>2:<sp/>case<sp/>3:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>switch(Ge_cristal)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>0:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+3);<sp/>//<sp/>Red</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>1:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+1);<sp/>//<sp/>Green</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>2:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index-2);<sp/>//<sp/>Black</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>3:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+0);<sp/>//<sp/>Blue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>:<sp/>return<sp/>-1;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>pi<sp/>rotation<sp/>:<sp/>R3A5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>case<sp/>4:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="825"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>switch(Ge_cristal)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>0:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+1);<sp/>//<sp/>Red</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>1:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+2);<sp/>//<sp/>Green</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>2:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+0);<sp/>//<sp/>Black</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>3:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index-3);<sp/>//<sp/>Blue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>:<sp/>return<sp/>-1;<sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="833"><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>default:<sp/>//<sp/>All<sp/>the<sp/>correctly<sp/>turned<sp/>clovers:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>switch(Ge_cristal)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="837"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>0:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+2);<sp/>//<sp/>Red</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>1:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index-1);<sp/>//<sp/>Green</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>2:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index-1);<sp/>//<sp/>Black</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case<sp/>3:<sp/>return<sp/>static_cast&lt;uchar&gt;(cristal_index+0);<sp/>//<sp/>Blue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>:<sp/>return<sp/>-1;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>return<sp/>255u;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="846"><highlight class="normal"></highlight><highlight class="comment">//<sp/>}</highlight></codeline>
    </programlisting>
    <location file="lib/Analyse/Clovers.hpp"/>
  </compounddef>
</doxygen>
