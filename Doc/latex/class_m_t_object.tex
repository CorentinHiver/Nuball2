\doxysection{MTObject Class Reference}
\label{class_m_t_object}\index{MTObject@{MTObject}}


Class handeling an easy multi threading.  




{\ttfamily \#include $<$MTObject.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ MTObject} ()
\item 
\textbf{ MTObject} (\textbf{ size\+\_\+t} \&\+\_\+nb\+\_\+threads)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \textbf{ adjust\+Threads\+Number} (\textbf{ size\+\_\+t} const \&limiting\+\_\+number, std\+::string const \&print\+\_\+if\+\_\+limit\+\_\+reached=\char`\"{}\char`\"{})
\item 
static auto const  \& \textbf{ get\+Thread\+Index} ()
\item 
static auto const  \& \textbf{ get\+Threads\+Nb} ()
\item 
static auto const  \& \textbf{ get\+Threads\+Number} ()
\item 
static auto const  \& \textbf{ index} ()
\item 
static void \textbf{ Initialise} ()
\item 
static void \textbf{ Initialise} (\textbf{ size\+\_\+t} const \&\+\_\+nb\+\_\+threads, bool force=false)
\item 
static bool \textbf{ is\+Master\+Thread} ()
\item 
{\footnotesize template$<$class Func , class... ARGS$>$ }\\static void \textbf{ parallelise\+\_\+function} (Func \&\&func, ARGS \&\&... args)
\item 
static void \textbf{ set\+Threads\+Nb} (int const \&n, bool force=false) noexcept
\begin{DoxyCompactList}\small\item\em Sets the number of threads. \end{DoxyCompactList}\item 
static void \textbf{ set\+Threads\+Nb} (\textbf{ size\+\_\+t} const \&n, bool force=false) noexcept
\begin{DoxyCompactList}\small\item\em Sets the number of threads. \end{DoxyCompactList}\item 
static void \textbf{ signal\+Handler} (int signal)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static bool \textbf{ activated} = false
\item 
static bool \textbf{ kill} = false
\item 
static std\+::mutex \textbf{ mutex}
\item 
static \textbf{ size\+\_\+t} \textbf{ nb\+\_\+threads} = 1
\item 
static bool \textbf{ ON} = false
\end{DoxyCompactItemize}
\doxysubsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static bool \textbf{ m\+\_\+\+Initialised} = false
\item 
static thread\+\_\+local \textbf{ size\+\_\+t} \textbf{ m\+\_\+thread\+\_\+index} = 0
\item 
static std\+::vector$<$ std\+::thread $>$ \textbf{ m\+\_\+threads}
\item 
static std\+::thread\+::id \textbf{ master\+\_\+thread\+\_\+id}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class handeling an easy multi threading. 

\begin{DoxyAttention}{Attention}
Include this class before any other in order to activate multithreading additions
\end{DoxyAttention}
POSIX-\/based multithreading. If you want to use the power of multithreading, this class can be convenient. Please include this class before any other in order to activate multithreading additions in the rest of the library.

First thing to do is to setup the number of threads then to Initialise them \+: \begin{DoxyVerb}   MTObject::setThreadsNb(nb_threads);
   MTObject::Initialise();
\end{DoxyVerb}
 Or more consisley \+: \begin{DoxyVerb}   MTObject::Initialise(nb_threads);
\end{DoxyVerb}
 Then you can multithread any function or static method \+: \begin{DoxyVerb}   MTObject::parallelise_function(function, param1, param2, ....);
\end{DoxyVerb}
 If you want to multithread a non-\/static method (regular methods in an object), you need to pass through a static function first.

Example 1 \+: simplest example \+: parallelise a lambda. \begin{DoxyVerb}   main()
   {
     MTObject::Initialise(2); // Using two concurrent threads
     int a = 0;
     int b = 0;
     // Here, the [&] allows the lambda to have access at everything that has been declared above. 
     // Therefore, in this case the lambda don't need any argument and the '()' is empty
     MTObject::parallelise_function([&](){
       if (random_uniform(0, 1)>0.5) ++a; // the random_uniform() is thread safe if '#include<MTObject>' is included first
       else                          ++b;
     });
     print(a, b);
\end{DoxyVerb}
 Example 2 \+: parallelise a lambda and fill a histogram using \doxyref{MTTHist}{p.}{class_m_t_t_hist} \begin{DoxyVerb}   main()
   {
     MTObject::Initialise(2); // Using two concurrent threads
     MTTHist<TH1F> test("test", "test", 1000,0,1000); // MTTHist holds a vector of TH1F to be filled using its own Fill method

     MTObject::parallelise_function([&]()
     { // Here starts the parallelised portion of code
       print("thread id :", MTObject::getThreadIndex()); // You can access the current thread index (0 or 1 in this case)
       // This method automatically fills the copy of the histogram that corresponds to its thread index :
       for(int i = 0; i<10000000; i++) test.Fill(random_gaussian(500, 100)); 
     });
     // Now, you may want to perform some operations on the MTTHist. 
     // But before, you need to merge the copies into one single spectra using MTTHist::Merge
     test.Merge();
     // Now, you can access the fused histogram using '->' operator.
     // It calls the TH1F itself, so you have access at all the 
     print(test->GetMean());
     auto outfile(TFile::Open("test.root", "RECREATE"));
     outfile->cd();
     // Note : you can use the MTTHist::Write method without already merged it
     test.Write();
     outfile->Write();
     outfile->Close();
     return 0;
   }
\end{DoxyVerb}
 Example 3 \+: paralellise a non-\/static method of a class \+: \begin{DoxyVerb}   class MyClass
   {
   public:
     MyClass() {}
     void function_to_multithread(argument_1, argument_2, ...){....}

     static void helper_function(MyClass & myclass, argument_1, argument_2, ...) {return myclass.function_to_multithread(argument_1, argument_2, ...);}
   };

   int main()
   {
    ...
     MTObject::parallelise_function(myclass.helper_function, argument_1, argument_2, ....);
    ...
   }
\end{DoxyVerb}
 \begin{DoxyRefDesc}{Todo}
\item[\textbf{ Todo}]Trying to make this work \+: template$<$class... ARGS$>$ static ret\+\_\+type helper\+\_\+function(\+My\+Class \& myclass, ARGS... args) \{return myclass.\+function\+\_\+to\+\_\+multithread(std\+::forward$<$\+ARGS$>$(args)...);\} \end{DoxyRefDesc}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\label{class_m_t_object_a12856506adc231bafc0983c881c3fe36}} 
\index{MTObject@{MTObject}!MTObject@{MTObject}}
\index{MTObject@{MTObject}!MTObject@{MTObject}}
\doxysubsubsection{MTObject()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily MTObject\+::\+MTObject (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\mbox{\label{class_m_t_object_a813cbf27a03a3b334ebc9faec99a5158}} 
\index{MTObject@{MTObject}!MTObject@{MTObject}}
\index{MTObject@{MTObject}!MTObject@{MTObject}}
\doxysubsubsection{MTObject()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily MTObject\+::\+MTObject (\begin{DoxyParamCaption}\item[{\textbf{ size\+\_\+t} \&}]{\+\_\+nb\+\_\+threads }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a813cbf27a03a3b334ebc9faec99a5158_cgraph}
\end{center}
\end{figure}


\doxysubsection{Member Function Documentation}
\mbox{\label{class_m_t_object_ac76ab61815b5c3a471e6c210b7ba1913}} 
\index{MTObject@{MTObject}!adjustThreadsNumber@{adjustThreadsNumber}}
\index{adjustThreadsNumber@{adjustThreadsNumber}!MTObject@{MTObject}}
\doxysubsubsection{adjustThreadsNumber()}
{\footnotesize\ttfamily static void MTObject\+::adjust\+Threads\+Number (\begin{DoxyParamCaption}\item[{\textbf{ size\+\_\+t} const \&}]{limiting\+\_\+number,  }\item[{std\+::string const \&}]{print\+\_\+if\+\_\+limit\+\_\+reached = {\ttfamily \char`\"{}\char`\"{}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_ac76ab61815b5c3a471e6c210b7ba1913_cgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_a9c9a57a49a12e1d408a5354e8520b3fe}} 
\index{MTObject@{MTObject}!getThreadIndex@{getThreadIndex}}
\index{getThreadIndex@{getThreadIndex}!MTObject@{MTObject}}
\doxysubsubsection{getThreadIndex()}
{\footnotesize\ttfamily static auto const\& MTObject\+::get\+Thread\+Index (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a9c9a57a49a12e1d408a5354e8520b3fe_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_ac97399bb34f766e41e7f9a1cd1b7eb7a}} 
\index{MTObject@{MTObject}!getThreadsNb@{getThreadsNb}}
\index{getThreadsNb@{getThreadsNb}!MTObject@{MTObject}}
\doxysubsubsection{getThreadsNb()}
{\footnotesize\ttfamily static auto const\& MTObject\+::get\+Threads\+Nb (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_ac97399bb34f766e41e7f9a1cd1b7eb7a_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_ad156f9b1c68f0e2713abb16890b1fa15}} 
\index{MTObject@{MTObject}!getThreadsNumber@{getThreadsNumber}}
\index{getThreadsNumber@{getThreadsNumber}!MTObject@{MTObject}}
\doxysubsubsection{getThreadsNumber()}
{\footnotesize\ttfamily static auto const\& MTObject\+::get\+Threads\+Number (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_ad156f9b1c68f0e2713abb16890b1fa15_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_af752e86ec494c50d1af7e6442c09733b}} 
\index{MTObject@{MTObject}!index@{index}}
\index{index@{index}!MTObject@{MTObject}}
\doxysubsubsection{index()}
{\footnotesize\ttfamily static auto const\& MTObject\+::index (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

\mbox{\label{class_m_t_object_a14b970709f027b42787a5a0471a93dd1}} 
\index{MTObject@{MTObject}!Initialise@{Initialise}}
\index{Initialise@{Initialise}!MTObject@{MTObject}}
\doxysubsubsection{Initialise()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily static void MTObject\+::\+Initialise (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a14b970709f027b42787a5a0471a93dd1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a14b970709f027b42787a5a0471a93dd1_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_a47f15f1545383d3476ae6614984d3e07}} 
\index{MTObject@{MTObject}!Initialise@{Initialise}}
\index{Initialise@{Initialise}!MTObject@{MTObject}}
\doxysubsubsection{Initialise()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily static void MTObject\+::\+Initialise (\begin{DoxyParamCaption}\item[{\textbf{ size\+\_\+t} const \&}]{\+\_\+nb\+\_\+threads,  }\item[{bool}]{force = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a47f15f1545383d3476ae6614984d3e07_cgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_a3350577ca839e2abdcd4d6f6449a1408}} 
\index{MTObject@{MTObject}!isMasterThread@{isMasterThread}}
\index{isMasterThread@{isMasterThread}!MTObject@{MTObject}}
\doxysubsubsection{isMasterThread()}
{\footnotesize\ttfamily static bool MTObject\+::is\+Master\+Thread (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a3350577ca839e2abdcd4d6f6449a1408_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_a35c02650eb403bd54e867f93bb26fc47}} 
\index{MTObject@{MTObject}!parallelise\_function@{parallelise\_function}}
\index{parallelise\_function@{parallelise\_function}!MTObject@{MTObject}}
\doxysubsubsection{parallelise\_function()}
{\footnotesize\ttfamily template$<$class Func , class... ARGS$>$ \\
static void MTObject\+::parallelise\+\_\+function (\begin{DoxyParamCaption}\item[{Func \&\&}]{func,  }\item[{ARGS \&\&...}]{args }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

\begin{DoxyRefDesc}{Todo}
\item[\textbf{ Todo}]check if I can replace Func by std\+::function \end{DoxyRefDesc}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a35c02650eb403bd54e867f93bb26fc47_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_aaf17bd02ca52dbe0702ee0d9d0f51d58}} 
\index{MTObject@{MTObject}!setThreadsNb@{setThreadsNb}}
\index{setThreadsNb@{setThreadsNb}!MTObject@{MTObject}}
\doxysubsubsection{setThreadsNb()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily static void MTObject\+::set\+Threads\+Nb (\begin{DoxyParamCaption}\item[{int const \&}]{n,  }\item[{bool}]{force = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [noexcept]}}



Sets the number of threads. 

Check the number of threads. Usually, over 75\% of cores is the optimal. Set force parameter to true if you want to use all the cores Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=217pt]{class_m_t_object_aaf17bd02ca52dbe0702ee0d9d0f51d58_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_aaf17bd02ca52dbe0702ee0d9d0f51d58_icgraph}
\end{center}
\end{figure}
\mbox{\label{class_m_t_object_aef24cd9329ac7f05228cfb26418f8f47}} 
\index{MTObject@{MTObject}!setThreadsNb@{setThreadsNb}}
\index{setThreadsNb@{setThreadsNb}!MTObject@{MTObject}}
\doxysubsubsection{setThreadsNb()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily static void MTObject\+::set\+Threads\+Nb (\begin{DoxyParamCaption}\item[{\textbf{ size\+\_\+t} const \&}]{n,  }\item[{bool}]{force = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [noexcept]}}



Sets the number of threads. 

Check the number of threads. Usually, over 75\% of cores is the optimal. Set force parameter to true if you want to use all the cores \mbox{\label{class_m_t_object_a76b267be14d83c4c257f8451058f8099}} 
\index{MTObject@{MTObject}!signalHandler@{signalHandler}}
\index{signalHandler@{signalHandler}!MTObject@{MTObject}}
\doxysubsubsection{signalHandler()}
{\footnotesize\ttfamily static void MTObject\+::signal\+Handler (\begin{DoxyParamCaption}\item[{int}]{signal }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_m_t_object_a76b267be14d83c4c257f8451058f8099_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\label{class_m_t_object_aa76149992bd58e1e5918b418db04a7ca}} 
\index{MTObject@{MTObject}!activated@{activated}}
\index{activated@{activated}!MTObject@{MTObject}}
\doxysubsubsection{activated}
{\footnotesize\ttfamily bool MTObject\+::activated = false\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\label{class_m_t_object_a67041891e1cebcb79af3180e55e702d6}} 
\index{MTObject@{MTObject}!kill@{kill}}
\index{kill@{kill}!MTObject@{MTObject}}
\doxysubsubsection{kill}
{\footnotesize\ttfamily bool MTObject\+::kill = false\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\label{class_m_t_object_a36ab81d1d7e7bee29a08bfb8f0e3ac49}} 
\index{MTObject@{MTObject}!m\_Initialised@{m\_Initialised}}
\index{m\_Initialised@{m\_Initialised}!MTObject@{MTObject}}
\doxysubsubsection{m\_Initialised}
{\footnotesize\ttfamily bool MTObject\+::m\+\_\+\+Initialised = false\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}

\mbox{\label{class_m_t_object_ac9efab6b9d255529611a250e91779a48}} 
\index{MTObject@{MTObject}!m\_thread\_index@{m\_thread\_index}}
\index{m\_thread\_index@{m\_thread\_index}!MTObject@{MTObject}}
\doxysubsubsection{m\_thread\_index}
{\footnotesize\ttfamily thread\+\_\+local \textbf{ size\+\_\+t} MTObject\+::m\+\_\+thread\+\_\+index = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}

\mbox{\label{class_m_t_object_abf0f47fe00f785c060ba2ec35df9819d}} 
\index{MTObject@{MTObject}!m\_threads@{m\_threads}}
\index{m\_threads@{m\_threads}!MTObject@{MTObject}}
\doxysubsubsection{m\_threads}
{\footnotesize\ttfamily std\+::vector$<$ std\+::thread $>$ MTObject\+::m\+\_\+threads\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}

\mbox{\label{class_m_t_object_a16983b3e7be4853da5f32145342fc6b0}} 
\index{MTObject@{MTObject}!master\_thread\_id@{master\_thread\_id}}
\index{master\_thread\_id@{master\_thread\_id}!MTObject@{MTObject}}
\doxysubsubsection{master\_thread\_id}
{\footnotesize\ttfamily std\+::thread\+::id MTObject\+::master\+\_\+thread\+\_\+id\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}

\mbox{\label{class_m_t_object_a79d86fbc8837ba0f9a4cd1405fddef1c}} 
\index{MTObject@{MTObject}!mutex@{mutex}}
\index{mutex@{mutex}!MTObject@{MTObject}}
\doxysubsubsection{mutex}
{\footnotesize\ttfamily std\+::mutex MTObject\+::mutex\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\label{class_m_t_object_a1c2b3cb0cdccca46c8ebba009503ac88}} 
\index{MTObject@{MTObject}!nb\_threads@{nb\_threads}}
\index{nb\_threads@{nb\_threads}!MTObject@{MTObject}}
\doxysubsubsection{nb\_threads}
{\footnotesize\ttfamily \textbf{ size\+\_\+t} MTObject\+::nb\+\_\+threads = 1\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\label{class_m_t_object_a6fe86ce1ea64ede7e695490bceb264a3}} 
\index{MTObject@{MTObject}!ON@{ON}}
\index{ON@{ON}!MTObject@{MTObject}}
\doxysubsubsection{ON}
{\footnotesize\ttfamily bool MTObject\+::\+ON = false\hspace{0.3cm}{\ttfamily [static]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
lib/\+MTObjects/\textbf{ MTObject.\+hpp}\end{DoxyCompactItemize}
